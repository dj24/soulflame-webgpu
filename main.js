/*! For license information please see main.js.LICENSE.txt */
(()=>{var t={543:function(t,e,n){var r;t=n.nmd(t),function(){var i,o="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",u=32,c=128,l=1/0,f=9007199254740991,h=NaN,p=4294967295,d=[["ary",c],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",u],["partialRight",64],["rearg",256]],_="[object Arguments]",m="[object Array]",g="[object Boolean]",v="[object Date]",y="[object Error]",w="[object Function]",x="[object GeneratorFunction]",b="[object Map]",k="[object Number]",A="[object Object]",M="[object Promise]",T="[object RegExp]",S="[object Set]",E="[object String]",I="[object Symbol]",P="[object WeakMap]",O="[object ArrayBuffer]",U="[object DataView]",z="[object Float32Array]",B="[object Float64Array]",j="[object Int8Array]",R="[object Int16Array]",N="[object Int32Array]",C="[object Uint8Array]",q="[object Uint8ClampedArray]",D="[object Uint16Array]",V="[object Uint32Array]",L=/\b__p \+= '';/g,F=/\b(__p \+=) '' \+/g,G=/(__e\(.*?\)|\b__t\)) \+\n'';/g,$=/&(?:amp|lt|gt|quot|#39);/g,Y=/[&<>"']/g,W=RegExp($.source),X=RegExp(Y.source),H=/<%-([\s\S]+?)%>/g,Z=/<%([\s\S]+?)%>/g,K=/<%=([\s\S]+?)%>/g,Q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,J=/^\w*$/,tt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/[\\^$.*+?()[\]{}|]/g,nt=RegExp(et.source),rt=/^\s+/,it=/\s/,ot=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,st=/\{\n\/\* \[wrapped with (.+)\] \*/,at=/,? & /,ut=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ct=/[()=,{}\[\]\/\s]/,lt=/\\(\\)?/g,ft=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,ht=/\w*$/,pt=/^[-+]0x[0-9a-f]+$/i,dt=/^0b[01]+$/i,_t=/^\[object .+?Constructor\]$/,mt=/^0o[0-7]+$/i,gt=/^(?:0|[1-9]\d*)$/,vt=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,yt=/($^)/,wt=/['\n\r\u2028\u2029\\]/g,xt="\\ud800-\\udfff",bt="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",kt="\\u2700-\\u27bf",At="a-z\\xdf-\\xf6\\xf8-\\xff",Mt="A-Z\\xc0-\\xd6\\xd8-\\xde",Tt="\\ufe0e\\ufe0f",St="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Et="["+xt+"]",It="["+St+"]",Pt="["+bt+"]",Ot="\\d+",Ut="["+kt+"]",zt="["+At+"]",Bt="[^"+xt+St+Ot+kt+At+Mt+"]",jt="\\ud83c[\\udffb-\\udfff]",Rt="[^"+xt+"]",Nt="(?:\\ud83c[\\udde6-\\uddff]){2}",Ct="[\\ud800-\\udbff][\\udc00-\\udfff]",qt="["+Mt+"]",Dt="\\u200d",Vt="(?:"+zt+"|"+Bt+")",Lt="(?:"+qt+"|"+Bt+")",Ft="(?:['’](?:d|ll|m|re|s|t|ve))?",Gt="(?:['’](?:D|LL|M|RE|S|T|VE))?",$t="(?:"+Pt+"|"+jt+")?",Yt="["+Tt+"]?",Wt=Yt+$t+"(?:"+Dt+"(?:"+[Rt,Nt,Ct].join("|")+")"+Yt+$t+")*",Xt="(?:"+[Ut,Nt,Ct].join("|")+")"+Wt,Ht="(?:"+[Rt+Pt+"?",Pt,Nt,Ct,Et].join("|")+")",Zt=RegExp("['’]","g"),Kt=RegExp(Pt,"g"),Qt=RegExp(jt+"(?="+jt+")|"+Ht+Wt,"g"),Jt=RegExp([qt+"?"+zt+"+"+Ft+"(?="+[It,qt,"$"].join("|")+")",Lt+"+"+Gt+"(?="+[It,qt+Vt,"$"].join("|")+")",qt+"?"+Vt+"+"+Ft,qt+"+"+Gt,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ot,Xt].join("|"),"g"),te=RegExp("["+Dt+xt+bt+Tt+"]"),ee=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,ne=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],re=-1,ie={};ie[z]=ie[B]=ie[j]=ie[R]=ie[N]=ie[C]=ie[q]=ie[D]=ie[V]=!0,ie[_]=ie[m]=ie[O]=ie[g]=ie[U]=ie[v]=ie[y]=ie[w]=ie[b]=ie[k]=ie[A]=ie[T]=ie[S]=ie[E]=ie[P]=!1;var oe={};oe[_]=oe[m]=oe[O]=oe[U]=oe[g]=oe[v]=oe[z]=oe[B]=oe[j]=oe[R]=oe[N]=oe[b]=oe[k]=oe[A]=oe[T]=oe[S]=oe[E]=oe[I]=oe[C]=oe[q]=oe[D]=oe[V]=!0,oe[y]=oe[w]=oe[P]=!1;var se={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ae=parseFloat,ue=parseInt,ce="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,le="object"==typeof self&&self&&self.Object===Object&&self,fe=ce||le||Function("return this")(),he=e&&!e.nodeType&&e,pe=he&&t&&!t.nodeType&&t,de=pe&&pe.exports===he,_e=de&&ce.process,me=function(){try{return pe&&pe.require&&pe.require("util").types||_e&&_e.binding&&_e.binding("util")}catch(t){}}(),ge=me&&me.isArrayBuffer,ve=me&&me.isDate,ye=me&&me.isMap,we=me&&me.isRegExp,xe=me&&me.isSet,be=me&&me.isTypedArray;function ke(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ae(t,e,n,r){for(var i=-1,o=null==t?0:t.length;++i<o;){var s=t[i];e(r,s,n(s),t)}return r}function Me(t,e){for(var n=-1,r=null==t?0:t.length;++n<r&&!1!==e(t[n],n,t););return t}function Te(t,e){for(var n=null==t?0:t.length;n--&&!1!==e(t[n],n,t););return t}function Se(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}function Ee(t,e){for(var n=-1,r=null==t?0:t.length,i=0,o=[];++n<r;){var s=t[n];e(s,n,t)&&(o[i++]=s)}return o}function Ie(t,e){return!(null==t||!t.length)&&qe(t,e,0)>-1}function Pe(t,e,n){for(var r=-1,i=null==t?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}function Oe(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}function Ue(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}function ze(t,e,n,r){var i=-1,o=null==t?0:t.length;for(r&&o&&(n=t[++i]);++i<o;)n=e(n,t[i],i,t);return n}function Be(t,e,n,r){var i=null==t?0:t.length;for(r&&i&&(n=t[--i]);i--;)n=e(n,t[i],i,t);return n}function je(t,e){for(var n=-1,r=null==t?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Re=Fe("length");function Ne(t,e,n){var r;return n(t,(function(t,n,i){if(e(t,n,i))return r=n,!1})),r}function Ce(t,e,n,r){for(var i=t.length,o=n+(r?1:-1);r?o--:++o<i;)if(e(t[o],o,t))return o;return-1}function qe(t,e,n){return e==e?function(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}(t,e,n):Ce(t,Ve,n)}function De(t,e,n,r){for(var i=n-1,o=t.length;++i<o;)if(r(t[i],e))return i;return-1}function Ve(t){return t!=t}function Le(t,e){var n=null==t?0:t.length;return n?Ye(t,e)/n:h}function Fe(t){return function(e){return null==e?i:e[t]}}function Ge(t){return function(e){return null==t?i:t[e]}}function $e(t,e,n,r,i){return i(t,(function(t,i,o){n=r?(r=!1,t):e(n,t,i,o)})),n}function Ye(t,e){for(var n,r=-1,o=t.length;++r<o;){var s=e(t[r]);s!==i&&(n=n===i?s:n+s)}return n}function We(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}function Xe(t){return t?t.slice(0,hn(t)+1).replace(rt,""):t}function He(t){return function(e){return t(e)}}function Ze(t,e){return Oe(e,(function(e){return t[e]}))}function Ke(t,e){return t.has(e)}function Qe(t,e){for(var n=-1,r=t.length;++n<r&&qe(e,t[n],0)>-1;);return n}function Je(t,e){for(var n=t.length;n--&&qe(e,t[n],0)>-1;);return n}var tn=Ge({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),en=Ge({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function nn(t){return"\\"+se[t]}function rn(t){return te.test(t)}function on(t){var e=-1,n=Array(t.size);return t.forEach((function(t,r){n[++e]=[r,t]})),n}function sn(t,e){return function(n){return t(e(n))}}function an(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n];s!==e&&s!==a||(t[n]=a,o[i++]=n)}return o}function un(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=t})),n}function cn(t){var e=-1,n=Array(t.size);return t.forEach((function(t){n[++e]=[t,t]})),n}function ln(t){return rn(t)?function(t){for(var e=Qt.lastIndex=0;Qt.test(t);)++e;return e}(t):Re(t)}function fn(t){return rn(t)?function(t){return t.match(Qt)||[]}(t):function(t){return t.split("")}(t)}function hn(t){for(var e=t.length;e--&&it.test(t.charAt(e)););return e}var pn=Ge({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),dn=function t(e){var n,r=(e=null==e?fe:dn.defaults(fe.Object(),e,dn.pick(fe,ne))).Array,it=e.Date,xt=e.Error,bt=e.Function,kt=e.Math,At=e.Object,Mt=e.RegExp,Tt=e.String,St=e.TypeError,Et=r.prototype,It=bt.prototype,Pt=At.prototype,Ot=e["__core-js_shared__"],Ut=It.toString,zt=Pt.hasOwnProperty,Bt=0,jt=(n=/[^.]+$/.exec(Ot&&Ot.keys&&Ot.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"",Rt=Pt.toString,Nt=Ut.call(At),Ct=fe._,qt=Mt("^"+Ut.call(zt).replace(et,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Dt=de?e.Buffer:i,Vt=e.Symbol,Lt=e.Uint8Array,Ft=Dt?Dt.allocUnsafe:i,Gt=sn(At.getPrototypeOf,At),$t=At.create,Yt=Pt.propertyIsEnumerable,Wt=Et.splice,Xt=Vt?Vt.isConcatSpreadable:i,Ht=Vt?Vt.iterator:i,Qt=Vt?Vt.toStringTag:i,te=function(){try{var t=uo(At,"defineProperty");return t({},"",{}),t}catch(t){}}(),se=e.clearTimeout!==fe.clearTimeout&&e.clearTimeout,ce=it&&it.now!==fe.Date.now&&it.now,le=e.setTimeout!==fe.setTimeout&&e.setTimeout,he=kt.ceil,pe=kt.floor,_e=At.getOwnPropertySymbols,me=Dt?Dt.isBuffer:i,Re=e.isFinite,Ge=Et.join,_n=sn(At.keys,At),mn=kt.max,gn=kt.min,vn=it.now,yn=e.parseInt,wn=kt.random,xn=Et.reverse,bn=uo(e,"DataView"),kn=uo(e,"Map"),An=uo(e,"Promise"),Mn=uo(e,"Set"),Tn=uo(e,"WeakMap"),Sn=uo(At,"create"),En=Tn&&new Tn,In={},Pn=No(bn),On=No(kn),Un=No(An),zn=No(Mn),Bn=No(Tn),jn=Vt?Vt.prototype:i,Rn=jn?jn.valueOf:i,Nn=jn?jn.toString:i;function Cn(t){if(ta(t)&&!Fs(t)&&!(t instanceof Ln)){if(t instanceof Vn)return t;if(zt.call(t,"__wrapped__"))return Co(t)}return new Vn(t)}var qn=function(){function t(){}return function(e){if(!Js(e))return{};if($t)return $t(e);t.prototype=e;var n=new t;return t.prototype=i,n}}();function Dn(){}function Vn(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=i}function Ln(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=p,this.__views__=[]}function Fn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Gn(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function $n(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function Yn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new $n;++e<n;)this.add(t[e])}function Wn(t){var e=this.__data__=new Gn(t);this.size=e.size}function Xn(t,e){var n=Fs(t),r=!n&&Ls(t),i=!n&&!r&&Ws(t),o=!n&&!r&&!i&&ua(t),s=n||r||i||o,a=s?We(t.length,Tt):[],u=a.length;for(var c in t)!e&&!zt.call(t,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||mo(c,u))||a.push(c);return a}function Hn(t){var e=t.length;return e?t[$r(0,e-1)]:i}function Zn(t,e){return Uo(Ti(t),or(e,0,t.length))}function Kn(t){return Uo(Ti(t))}function Qn(t,e,n){(n!==i&&!qs(t[e],n)||n===i&&!(e in t))&&rr(t,e,n)}function Jn(t,e,n){var r=t[e];zt.call(t,e)&&qs(r,n)&&(n!==i||e in t)||rr(t,e,n)}function tr(t,e){for(var n=t.length;n--;)if(qs(t[n][0],e))return n;return-1}function er(t,e,n,r){return lr(t,(function(t,i,o){e(r,t,n(t),o)})),r}function nr(t,e){return t&&Si(e,Pa(e),t)}function rr(t,e,n){"__proto__"==e&&te?te(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function ir(t,e){for(var n=-1,o=e.length,s=r(o),a=null==t;++n<o;)s[n]=a?i:Ma(t,e[n]);return s}function or(t,e,n){return t==t&&(n!==i&&(t=t<=n?t:n),e!==i&&(t=t>=e?t:e)),t}function sr(t,e,n,r,o,s){var a,u=1&e,c=2&e,l=4&e;if(n&&(a=o?n(t,r,o,s):n(t)),a!==i)return a;if(!Js(t))return t;var f=Fs(t);if(f){if(a=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&zt.call(t,"index")&&(n.index=t.index,n.input=t.input),n}(t),!u)return Ti(t,a)}else{var h=fo(t),p=h==w||h==x;if(Ws(t))return wi(t,u);if(h==A||h==_||p&&!o){if(a=c||p?{}:po(t),!u)return c?function(t,e){return Si(t,lo(t),e)}(t,function(t,e){return t&&Si(e,Oa(e),t)}(a,t)):function(t,e){return Si(t,co(t),e)}(t,nr(a,t))}else{if(!oe[h])return o?t:{};a=function(t,e,n){var r,i=t.constructor;switch(e){case O:return xi(t);case g:case v:return new i(+t);case U:return function(t,e){var n=e?xi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}(t,n);case z:case B:case j:case R:case N:case C:case q:case D:case V:return bi(t,n);case b:return new i;case k:case E:return new i(t);case T:return function(t){var e=new t.constructor(t.source,ht.exec(t));return e.lastIndex=t.lastIndex,e}(t);case S:return new i;case I:return r=t,Rn?At(Rn.call(r)):{}}}(t,h,u)}}s||(s=new Wn);var d=s.get(t);if(d)return d;s.set(t,a),oa(t)?t.forEach((function(r){a.add(sr(r,e,n,r,t,s))})):ea(t)&&t.forEach((function(r,i){a.set(i,sr(r,e,n,i,t,s))}));var m=f?i:(l?c?eo:to:c?Oa:Pa)(t);return Me(m||t,(function(r,i){m&&(r=t[i=r]),Jn(a,i,sr(r,e,n,i,t,s))})),a}function ar(t,e,n){var r=n.length;if(null==t)return!r;for(t=At(t);r--;){var o=n[r],s=e[o],a=t[o];if(a===i&&!(o in t)||!s(a))return!1}return!0}function ur(t,e,n){if("function"!=typeof t)throw new St(o);return Eo((function(){t.apply(i,n)}),e)}function cr(t,e,n,r){var i=-1,o=Ie,s=!0,a=t.length,u=[],c=e.length;if(!a)return u;n&&(e=Oe(e,He(n))),r?(o=Pe,s=!1):e.length>=200&&(o=Ke,s=!1,e=new Yn(e));t:for(;++i<a;){var l=t[i],f=null==n?l:n(l);if(l=r||0!==l?l:0,s&&f==f){for(var h=c;h--;)if(e[h]===f)continue t;u.push(l)}else o(e,f,r)||u.push(l)}return u}Cn.templateSettings={escape:H,evaluate:Z,interpolate:K,variable:"",imports:{_:Cn}},Cn.prototype=Dn.prototype,Cn.prototype.constructor=Cn,Vn.prototype=qn(Dn.prototype),Vn.prototype.constructor=Vn,Ln.prototype=qn(Dn.prototype),Ln.prototype.constructor=Ln,Fn.prototype.clear=function(){this.__data__=Sn?Sn(null):{},this.size=0},Fn.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},Fn.prototype.get=function(t){var e=this.__data__;if(Sn){var n=e[t];return n===s?i:n}return zt.call(e,t)?e[t]:i},Fn.prototype.has=function(t){var e=this.__data__;return Sn?e[t]!==i:zt.call(e,t)},Fn.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Sn&&e===i?s:e,this},Gn.prototype.clear=function(){this.__data__=[],this.size=0},Gn.prototype.delete=function(t){var e=this.__data__,n=tr(e,t);return!(n<0||(n==e.length-1?e.pop():Wt.call(e,n,1),--this.size,0))},Gn.prototype.get=function(t){var e=this.__data__,n=tr(e,t);return n<0?i:e[n][1]},Gn.prototype.has=function(t){return tr(this.__data__,t)>-1},Gn.prototype.set=function(t,e){var n=this.__data__,r=tr(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this},$n.prototype.clear=function(){this.size=0,this.__data__={hash:new Fn,map:new(kn||Gn),string:new Fn}},$n.prototype.delete=function(t){var e=so(this,t).delete(t);return this.size-=e?1:0,e},$n.prototype.get=function(t){return so(this,t).get(t)},$n.prototype.has=function(t){return so(this,t).has(t)},$n.prototype.set=function(t,e){var n=so(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this},Yn.prototype.add=Yn.prototype.push=function(t){return this.__data__.set(t,s),this},Yn.prototype.has=function(t){return this.__data__.has(t)},Wn.prototype.clear=function(){this.__data__=new Gn,this.size=0},Wn.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},Wn.prototype.get=function(t){return this.__data__.get(t)},Wn.prototype.has=function(t){return this.__data__.has(t)},Wn.prototype.set=function(t,e){var n=this.__data__;if(n instanceof Gn){var r=n.__data__;if(!kn||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new $n(r)}return n.set(t,e),this.size=n.size,this};var lr=Pi(vr),fr=Pi(yr,!0);function hr(t,e){var n=!0;return lr(t,(function(t,r,i){return n=!!e(t,r,i)})),n}function pr(t,e,n){for(var r=-1,o=t.length;++r<o;){var s=t[r],a=e(s);if(null!=a&&(u===i?a==a&&!aa(a):n(a,u)))var u=a,c=s}return c}function dr(t,e){var n=[];return lr(t,(function(t,r,i){e(t,r,i)&&n.push(t)})),n}function _r(t,e,n,r,i){var o=-1,s=t.length;for(n||(n=_o),i||(i=[]);++o<s;){var a=t[o];e>0&&n(a)?e>1?_r(a,e-1,n,r,i):Ue(i,a):r||(i[i.length]=a)}return i}var mr=Oi(),gr=Oi(!0);function vr(t,e){return t&&mr(t,e,Pa)}function yr(t,e){return t&&gr(t,e,Pa)}function wr(t,e){return Ee(e,(function(e){return Zs(t[e])}))}function xr(t,e){for(var n=0,r=(e=mi(e,t)).length;null!=t&&n<r;)t=t[Ro(e[n++])];return n&&n==r?t:i}function br(t,e,n){var r=e(t);return Fs(t)?r:Ue(r,n(t))}function kr(t){return null==t?t===i?"[object Undefined]":"[object Null]":Qt&&Qt in At(t)?function(t){var e=zt.call(t,Qt),n=t[Qt];try{t[Qt]=i;var r=!0}catch(t){}var o=Rt.call(t);return r&&(e?t[Qt]=n:delete t[Qt]),o}(t):function(t){return Rt.call(t)}(t)}function Ar(t,e){return t>e}function Mr(t,e){return null!=t&&zt.call(t,e)}function Tr(t,e){return null!=t&&e in At(t)}function Sr(t,e,n){for(var o=n?Pe:Ie,s=t[0].length,a=t.length,u=a,c=r(a),l=1/0,f=[];u--;){var h=t[u];u&&e&&(h=Oe(h,He(e))),l=gn(h.length,l),c[u]=!n&&(e||s>=120&&h.length>=120)?new Yn(u&&h):i}h=t[0];var p=-1,d=c[0];t:for(;++p<s&&f.length<l;){var _=h[p],m=e?e(_):_;if(_=n||0!==_?_:0,!(d?Ke(d,m):o(f,m,n))){for(u=a;--u;){var g=c[u];if(!(g?Ke(g,m):o(t[u],m,n)))continue t}d&&d.push(m),f.push(_)}}return f}function Er(t,e,n){var r=null==(t=Mo(t,e=mi(e,t)))?t:t[Ro(Ho(e))];return null==r?i:ke(r,t,n)}function Ir(t){return ta(t)&&kr(t)==_}function Pr(t,e,n,r,o){return t===e||(null==t||null==e||!ta(t)&&!ta(e)?t!=t&&e!=e:function(t,e,n,r,o,s){var a=Fs(t),u=Fs(e),c=a?m:fo(t),l=u?m:fo(e),f=(c=c==_?A:c)==A,h=(l=l==_?A:l)==A,p=c==l;if(p&&Ws(t)){if(!Ws(e))return!1;a=!0,f=!1}if(p&&!f)return s||(s=new Wn),a||ua(t)?Qi(t,e,n,r,o,s):function(t,e,n,r,i,o,s){switch(n){case U:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case O:return!(t.byteLength!=e.byteLength||!o(new Lt(t),new Lt(e)));case g:case v:case k:return qs(+t,+e);case y:return t.name==e.name&&t.message==e.message;case T:case E:return t==e+"";case b:var a=on;case S:var u=1&r;if(a||(a=un),t.size!=e.size&&!u)return!1;var c=s.get(t);if(c)return c==e;r|=2,s.set(t,e);var l=Qi(a(t),a(e),r,i,o,s);return s.delete(t),l;case I:if(Rn)return Rn.call(t)==Rn.call(e)}return!1}(t,e,c,n,r,o,s);if(!(1&n)){var d=f&&zt.call(t,"__wrapped__"),w=h&&zt.call(e,"__wrapped__");if(d||w){var x=d?t.value():t,M=w?e.value():e;return s||(s=new Wn),o(x,M,n,r,s)}}return!!p&&(s||(s=new Wn),function(t,e,n,r,o,s){var a=1&n,u=to(t),c=u.length;if(c!=to(e).length&&!a)return!1;for(var l=c;l--;){var f=u[l];if(!(a?f in e:zt.call(e,f)))return!1}var h=s.get(t),p=s.get(e);if(h&&p)return h==e&&p==t;var d=!0;s.set(t,e),s.set(e,t);for(var _=a;++l<c;){var m=t[f=u[l]],g=e[f];if(r)var v=a?r(g,m,f,e,t,s):r(m,g,f,t,e,s);if(!(v===i?m===g||o(m,g,n,r,s):v)){d=!1;break}_||(_="constructor"==f)}if(d&&!_){var y=t.constructor,w=e.constructor;y==w||!("constructor"in t)||!("constructor"in e)||"function"==typeof y&&y instanceof y&&"function"==typeof w&&w instanceof w||(d=!1)}return s.delete(t),s.delete(e),d}(t,e,n,r,o,s))}(t,e,n,r,Pr,o))}function Or(t,e,n,r){var o=n.length,s=o,a=!r;if(null==t)return!s;for(t=At(t);o--;){var u=n[o];if(a&&u[2]?u[1]!==t[u[0]]:!(u[0]in t))return!1}for(;++o<s;){var c=(u=n[o])[0],l=t[c],f=u[1];if(a&&u[2]){if(l===i&&!(c in t))return!1}else{var h=new Wn;if(r)var p=r(l,f,c,t,e,h);if(!(p===i?Pr(f,l,3,r,h):p))return!1}}return!0}function Ur(t){return!(!Js(t)||(e=t,jt&&jt in e))&&(Zs(t)?qt:_t).test(No(t));var e}function zr(t){return"function"==typeof t?t:null==t?nu:"object"==typeof t?Fs(t)?Cr(t[0],t[1]):Nr(t):fu(t)}function Br(t){if(!xo(t))return _n(t);var e=[];for(var n in At(t))zt.call(t,n)&&"constructor"!=n&&e.push(n);return e}function jr(t,e){return t<e}function Rr(t,e){var n=-1,i=$s(t)?r(t.length):[];return lr(t,(function(t,r,o){i[++n]=e(t,r,o)})),i}function Nr(t){var e=ao(t);return 1==e.length&&e[0][2]?ko(e[0][0],e[0][1]):function(n){return n===t||Or(n,t,e)}}function Cr(t,e){return vo(t)&&bo(e)?ko(Ro(t),e):function(n){var r=Ma(n,t);return r===i&&r===e?Ta(n,t):Pr(e,r,3)}}function qr(t,e,n,r,o){t!==e&&mr(e,(function(s,a){if(o||(o=new Wn),Js(s))!function(t,e,n,r,o,s,a){var u=To(t,n),c=To(e,n),l=a.get(c);if(l)Qn(t,n,l);else{var f=s?s(u,c,n+"",t,e,a):i,h=f===i;if(h){var p=Fs(c),d=!p&&Ws(c),_=!p&&!d&&ua(c);f=c,p||d||_?Fs(u)?f=u:Ys(u)?f=Ti(u):d?(h=!1,f=wi(c,!0)):_?(h=!1,f=bi(c,!0)):f=[]:ra(c)||Ls(c)?(f=u,Ls(u)?f=ma(u):Js(u)&&!Zs(u)||(f=po(c))):h=!1}h&&(a.set(c,f),o(f,c,r,s,a),a.delete(c)),Qn(t,n,f)}}(t,e,a,n,qr,r,o);else{var u=r?r(To(t,a),s,a+"",t,e,o):i;u===i&&(u=s),Qn(t,a,u)}}),Oa)}function Dr(t,e){var n=t.length;if(n)return mo(e+=e<0?n:0,n)?t[e]:i}function Vr(t,e,n){e=e.length?Oe(e,(function(t){return Fs(t)?function(e){return xr(e,1===t.length?t[0]:t)}:t})):[nu];var r=-1;e=Oe(e,He(oo()));var i=Rr(t,(function(t,n,i){var o=Oe(e,(function(e){return e(t)}));return{criteria:o,index:++r,value:t}}));return function(t,e){var r=t.length;for(t.sort((function(t,e){return function(t,e,n){for(var r=-1,i=t.criteria,o=e.criteria,s=i.length,a=n.length;++r<s;){var u=ki(i[r],o[r]);if(u)return r>=a?u:u*("desc"==n[r]?-1:1)}return t.index-e.index}(t,e,n)}));r--;)t[r]=t[r].value;return t}(i)}function Lr(t,e,n){for(var r=-1,i=e.length,o={};++r<i;){var s=e[r],a=xr(t,s);n(a,s)&&Zr(o,mi(s,t),a)}return o}function Fr(t,e,n,r){var i=r?De:qe,o=-1,s=e.length,a=t;for(t===e&&(e=Ti(e)),n&&(a=Oe(t,He(n)));++o<s;)for(var u=0,c=e[o],l=n?n(c):c;(u=i(a,l,u,r))>-1;)a!==t&&Wt.call(a,u,1),Wt.call(t,u,1);return t}function Gr(t,e){for(var n=t?e.length:0,r=n-1;n--;){var i=e[n];if(n==r||i!==o){var o=i;mo(i)?Wt.call(t,i,1):ui(t,i)}}return t}function $r(t,e){return t+pe(wn()*(e-t+1))}function Yr(t,e){var n="";if(!t||e<1||e>f)return n;do{e%2&&(n+=t),(e=pe(e/2))&&(t+=t)}while(e);return n}function Wr(t,e){return Io(Ao(t,e,nu),t+"")}function Xr(t){return Hn(qa(t))}function Hr(t,e){var n=qa(t);return Uo(n,or(e,0,n.length))}function Zr(t,e,n,r){if(!Js(t))return t;for(var o=-1,s=(e=mi(e,t)).length,a=s-1,u=t;null!=u&&++o<s;){var c=Ro(e[o]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return t;if(o!=a){var f=u[c];(l=r?r(f,c,u):i)===i&&(l=Js(f)?f:mo(e[o+1])?[]:{})}Jn(u,c,l),u=u[c]}return t}var Kr=En?function(t,e){return En.set(t,e),t}:nu,Qr=te?function(t,e){return te(t,"toString",{configurable:!0,enumerable:!1,value:Ja(e),writable:!0})}:nu;function Jr(t){return Uo(qa(t))}function ti(t,e,n){var i=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var s=r(o);++i<o;)s[i]=t[i+e];return s}function ei(t,e){var n;return lr(t,(function(t,r,i){return!(n=e(t,r,i))})),!!n}function ni(t,e,n){var r=0,i=null==t?r:t.length;if("number"==typeof e&&e==e&&i<=2147483647){for(;r<i;){var o=r+i>>>1,s=t[o];null!==s&&!aa(s)&&(n?s<=e:s<e)?r=o+1:i=o}return i}return ri(t,e,nu,n)}function ri(t,e,n,r){var o=0,s=null==t?0:t.length;if(0===s)return 0;for(var a=(e=n(e))!=e,u=null===e,c=aa(e),l=e===i;o<s;){var f=pe((o+s)/2),h=n(t[f]),p=h!==i,d=null===h,_=h==h,m=aa(h);if(a)var g=r||_;else g=l?_&&(r||p):u?_&&p&&(r||!d):c?_&&p&&!d&&(r||!m):!d&&!m&&(r?h<=e:h<e);g?o=f+1:s=f}return gn(s,4294967294)}function ii(t,e){for(var n=-1,r=t.length,i=0,o=[];++n<r;){var s=t[n],a=e?e(s):s;if(!n||!qs(a,u)){var u=a;o[i++]=0===s?0:s}}return o}function oi(t){return"number"==typeof t?t:aa(t)?h:+t}function si(t){if("string"==typeof t)return t;if(Fs(t))return Oe(t,si)+"";if(aa(t))return Nn?Nn.call(t):"";var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function ai(t,e,n){var r=-1,i=Ie,o=t.length,s=!0,a=[],u=a;if(n)s=!1,i=Pe;else if(o>=200){var c=e?null:Yi(t);if(c)return un(c);s=!1,i=Ke,u=new Yn}else u=e?[]:a;t:for(;++r<o;){var l=t[r],f=e?e(l):l;if(l=n||0!==l?l:0,s&&f==f){for(var h=u.length;h--;)if(u[h]===f)continue t;e&&u.push(f),a.push(l)}else i(u,f,n)||(u!==a&&u.push(f),a.push(l))}return a}function ui(t,e){return null==(t=Mo(t,e=mi(e,t)))||delete t[Ro(Ho(e))]}function ci(t,e,n,r){return Zr(t,e,n(xr(t,e)),r)}function li(t,e,n,r){for(var i=t.length,o=r?i:-1;(r?o--:++o<i)&&e(t[o],o,t););return n?ti(t,r?0:o,r?o+1:i):ti(t,r?o+1:0,r?i:o)}function fi(t,e){var n=t;return n instanceof Ln&&(n=n.value()),ze(e,(function(t,e){return e.func.apply(e.thisArg,Ue([t],e.args))}),n)}function hi(t,e,n){var i=t.length;if(i<2)return i?ai(t[0]):[];for(var o=-1,s=r(i);++o<i;)for(var a=t[o],u=-1;++u<i;)u!=o&&(s[o]=cr(s[o]||a,t[u],e,n));return ai(_r(s,1),e,n)}function pi(t,e,n){for(var r=-1,o=t.length,s=e.length,a={};++r<o;){var u=r<s?e[r]:i;n(a,t[r],u)}return a}function di(t){return Ys(t)?t:[]}function _i(t){return"function"==typeof t?t:nu}function mi(t,e){return Fs(t)?t:vo(t,e)?[t]:jo(ga(t))}var gi=Wr;function vi(t,e,n){var r=t.length;return n=n===i?r:n,!e&&n>=r?t:ti(t,e,n)}var yi=se||function(t){return fe.clearTimeout(t)};function wi(t,e){if(e)return t.slice();var n=t.length,r=Ft?Ft(n):new t.constructor(n);return t.copy(r),r}function xi(t){var e=new t.constructor(t.byteLength);return new Lt(e).set(new Lt(t)),e}function bi(t,e){var n=e?xi(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function ki(t,e){if(t!==e){var n=t!==i,r=null===t,o=t==t,s=aa(t),a=e!==i,u=null===e,c=e==e,l=aa(e);if(!u&&!l&&!s&&t>e||s&&a&&c&&!u&&!l||r&&a&&c||!n&&c||!o)return 1;if(!r&&!s&&!l&&t<e||l&&n&&o&&!r&&!s||u&&n&&o||!a&&o||!c)return-1}return 0}function Ai(t,e,n,i){for(var o=-1,s=t.length,a=n.length,u=-1,c=e.length,l=mn(s-a,0),f=r(c+l),h=!i;++u<c;)f[u]=e[u];for(;++o<a;)(h||o<s)&&(f[n[o]]=t[o]);for(;l--;)f[u++]=t[o++];return f}function Mi(t,e,n,i){for(var o=-1,s=t.length,a=-1,u=n.length,c=-1,l=e.length,f=mn(s-u,0),h=r(f+l),p=!i;++o<f;)h[o]=t[o];for(var d=o;++c<l;)h[d+c]=e[c];for(;++a<u;)(p||o<s)&&(h[d+n[a]]=t[o++]);return h}function Ti(t,e){var n=-1,i=t.length;for(e||(e=r(i));++n<i;)e[n]=t[n];return e}function Si(t,e,n,r){var o=!n;n||(n={});for(var s=-1,a=e.length;++s<a;){var u=e[s],c=r?r(n[u],t[u],u,n,t):i;c===i&&(c=t[u]),o?rr(n,u,c):Jn(n,u,c)}return n}function Ei(t,e){return function(n,r){var i=Fs(n)?Ae:er,o=e?e():{};return i(n,t,oo(r,2),o)}}function Ii(t){return Wr((function(e,n){var r=-1,o=n.length,s=o>1?n[o-1]:i,a=o>2?n[2]:i;for(s=t.length>3&&"function"==typeof s?(o--,s):i,a&&go(n[0],n[1],a)&&(s=o<3?i:s,o=1),e=At(e);++r<o;){var u=n[r];u&&t(e,u,r,s)}return e}))}function Pi(t,e){return function(n,r){if(null==n)return n;if(!$s(n))return t(n,r);for(var i=n.length,o=e?i:-1,s=At(n);(e?o--:++o<i)&&!1!==r(s[o],o,s););return n}}function Oi(t){return function(e,n,r){for(var i=-1,o=At(e),s=r(e),a=s.length;a--;){var u=s[t?a:++i];if(!1===n(o[u],u,o))break}return e}}function Ui(t){return function(e){var n=rn(e=ga(e))?fn(e):i,r=n?n[0]:e.charAt(0),o=n?vi(n,1).join(""):e.slice(1);return r[t]()+o}}function zi(t){return function(e){return ze(Za(La(e).replace(Zt,"")),t,"")}}function Bi(t){return function(){var e=arguments;switch(e.length){case 0:return new t;case 1:return new t(e[0]);case 2:return new t(e[0],e[1]);case 3:return new t(e[0],e[1],e[2]);case 4:return new t(e[0],e[1],e[2],e[3]);case 5:return new t(e[0],e[1],e[2],e[3],e[4]);case 6:return new t(e[0],e[1],e[2],e[3],e[4],e[5]);case 7:return new t(e[0],e[1],e[2],e[3],e[4],e[5],e[6])}var n=qn(t.prototype),r=t.apply(n,e);return Js(r)?r:n}}function ji(t){return function(e,n,r){var o=At(e);if(!$s(e)){var s=oo(n,3);e=Pa(e),n=function(t){return s(o[t],t,o)}}var a=t(e,n,r);return a>-1?o[s?e[a]:a]:i}}function Ri(t){return Ji((function(e){var n=e.length,r=n,s=Vn.prototype.thru;for(t&&e.reverse();r--;){var a=e[r];if("function"!=typeof a)throw new St(o);if(s&&!u&&"wrapper"==ro(a))var u=new Vn([],!0)}for(r=u?r:n;++r<n;){var c=ro(a=e[r]),l="wrapper"==c?no(a):i;u=l&&yo(l[0])&&424==l[1]&&!l[4].length&&1==l[9]?u[ro(l[0])].apply(u,l[3]):1==a.length&&yo(a)?u[c]():u.thru(a)}return function(){var t=arguments,r=t[0];if(u&&1==t.length&&Fs(r))return u.plant(r).value();for(var i=0,o=n?e[i].apply(this,t):r;++i<n;)o=e[i].call(this,o);return o}}))}function Ni(t,e,n,o,s,a,u,l,f,h){var p=e&c,d=1&e,_=2&e,m=24&e,g=512&e,v=_?i:Bi(t);return function c(){for(var y=arguments.length,w=r(y),x=y;x--;)w[x]=arguments[x];if(m)var b=io(c),k=function(t,e){for(var n=t.length,r=0;n--;)t[n]===e&&++r;return r}(w,b);if(o&&(w=Ai(w,o,s,m)),a&&(w=Mi(w,a,u,m)),y-=k,m&&y<h){var A=an(w,b);return Gi(t,e,Ni,c.placeholder,n,w,A,l,f,h-y)}var M=d?n:this,T=_?M[t]:t;return y=w.length,l?w=function(t,e){for(var n=t.length,r=gn(e.length,n),o=Ti(t);r--;){var s=e[r];t[r]=mo(s,n)?o[s]:i}return t}(w,l):g&&y>1&&w.reverse(),p&&f<y&&(w.length=f),this&&this!==fe&&this instanceof c&&(T=v||Bi(T)),T.apply(M,w)}}function Ci(t,e){return function(n,r){return function(t,e,n,r){return vr(t,(function(t,i,o){e(r,n(t),i,o)})),r}(n,t,e(r),{})}}function qi(t,e){return function(n,r){var o;if(n===i&&r===i)return e;if(n!==i&&(o=n),r!==i){if(o===i)return r;"string"==typeof n||"string"==typeof r?(n=si(n),r=si(r)):(n=oi(n),r=oi(r)),o=t(n,r)}return o}}function Di(t){return Ji((function(e){return e=Oe(e,He(oo())),Wr((function(n){var r=this;return t(e,(function(t){return ke(t,r,n)}))}))}))}function Vi(t,e){var n=(e=e===i?" ":si(e)).length;if(n<2)return n?Yr(e,t):e;var r=Yr(e,he(t/ln(e)));return rn(e)?vi(fn(r),0,t).join(""):r.slice(0,t)}function Li(t){return function(e,n,o){return o&&"number"!=typeof o&&go(e,n,o)&&(n=o=i),e=ha(e),n===i?(n=e,e=0):n=ha(n),function(t,e,n,i){for(var o=-1,s=mn(he((e-t)/(n||1)),0),a=r(s);s--;)a[i?s:++o]=t,t+=n;return a}(e,n,o=o===i?e<n?1:-1:ha(o),t)}}function Fi(t){return function(e,n){return"string"==typeof e&&"string"==typeof n||(e=_a(e),n=_a(n)),t(e,n)}}function Gi(t,e,n,r,o,s,a,c,l,f){var h=8&e;e|=h?u:64,4&(e&=~(h?64:u))||(e&=-4);var p=[t,e,o,h?s:i,h?a:i,h?i:s,h?i:a,c,l,f],d=n.apply(i,p);return yo(t)&&So(d,p),d.placeholder=r,Po(d,t,e)}function $i(t){var e=kt[t];return function(t,n){if(t=_a(t),(n=null==n?0:gn(pa(n),292))&&Re(t)){var r=(ga(t)+"e").split("e");return+((r=(ga(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}var Yi=Mn&&1/un(new Mn([,-0]))[1]==l?function(t){return new Mn(t)}:au;function Wi(t){return function(e){var n=fo(e);return n==b?on(e):n==S?cn(e):function(t,e){return Oe(e,(function(e){return[e,t[e]]}))}(e,t(e))}}function Xi(t,e,n,s,l,f,h,p){var d=2&e;if(!d&&"function"!=typeof t)throw new St(o);var _=s?s.length:0;if(_||(e&=-97,s=l=i),h=h===i?h:mn(pa(h),0),p=p===i?p:pa(p),_-=l?l.length:0,64&e){var m=s,g=l;s=l=i}var v=d?i:no(t),y=[t,e,n,s,l,m,g,f,h,p];if(v&&function(t,e){var n=t[1],r=e[1],i=n|r,o=i<131,s=r==c&&8==n||r==c&&256==n&&t[7].length<=e[8]||384==r&&e[7].length<=e[8]&&8==n;if(!o&&!s)return t;1&r&&(t[2]=e[2],i|=1&n?0:4);var u=e[3];if(u){var l=t[3];t[3]=l?Ai(l,u,e[4]):u,t[4]=l?an(t[3],a):e[4]}(u=e[5])&&(l=t[5],t[5]=l?Mi(l,u,e[6]):u,t[6]=l?an(t[5],a):e[6]),(u=e[7])&&(t[7]=u),r&c&&(t[8]=null==t[8]?e[8]:gn(t[8],e[8])),null==t[9]&&(t[9]=e[9]),t[0]=e[0],t[1]=i}(y,v),t=y[0],e=y[1],n=y[2],s=y[3],l=y[4],!(p=y[9]=y[9]===i?d?0:t.length:mn(y[9]-_,0))&&24&e&&(e&=-25),e&&1!=e)w=8==e||16==e?function(t,e,n){var o=Bi(t);return function s(){for(var a=arguments.length,u=r(a),c=a,l=io(s);c--;)u[c]=arguments[c];var f=a<3&&u[0]!==l&&u[a-1]!==l?[]:an(u,l);return(a-=f.length)<n?Gi(t,e,Ni,s.placeholder,i,u,f,i,i,n-a):ke(this&&this!==fe&&this instanceof s?o:t,this,u)}}(t,e,p):e!=u&&33!=e||l.length?Ni.apply(i,y):function(t,e,n,i){var o=1&e,s=Bi(t);return function e(){for(var a=-1,u=arguments.length,c=-1,l=i.length,f=r(l+u),h=this&&this!==fe&&this instanceof e?s:t;++c<l;)f[c]=i[c];for(;u--;)f[c++]=arguments[++a];return ke(h,o?n:this,f)}}(t,e,n,s);else var w=function(t,e,n){var r=1&e,i=Bi(t);return function e(){return(this&&this!==fe&&this instanceof e?i:t).apply(r?n:this,arguments)}}(t,e,n);return Po((v?Kr:So)(w,y),t,e)}function Hi(t,e,n,r){return t===i||qs(t,Pt[n])&&!zt.call(r,n)?e:t}function Zi(t,e,n,r,o,s){return Js(t)&&Js(e)&&(s.set(e,t),qr(t,e,i,Zi,s),s.delete(e)),t}function Ki(t){return ra(t)?i:t}function Qi(t,e,n,r,o,s){var a=1&n,u=t.length,c=e.length;if(u!=c&&!(a&&c>u))return!1;var l=s.get(t),f=s.get(e);if(l&&f)return l==e&&f==t;var h=-1,p=!0,d=2&n?new Yn:i;for(s.set(t,e),s.set(e,t);++h<u;){var _=t[h],m=e[h];if(r)var g=a?r(m,_,h,e,t,s):r(_,m,h,t,e,s);if(g!==i){if(g)continue;p=!1;break}if(d){if(!je(e,(function(t,e){if(!Ke(d,e)&&(_===t||o(_,t,n,r,s)))return d.push(e)}))){p=!1;break}}else if(_!==m&&!o(_,m,n,r,s)){p=!1;break}}return s.delete(t),s.delete(e),p}function Ji(t){return Io(Ao(t,i,Go),t+"")}function to(t){return br(t,Pa,co)}function eo(t){return br(t,Oa,lo)}var no=En?function(t){return En.get(t)}:au;function ro(t){for(var e=t.name+"",n=In[e],r=zt.call(In,e)?n.length:0;r--;){var i=n[r],o=i.func;if(null==o||o==t)return i.name}return e}function io(t){return(zt.call(Cn,"placeholder")?Cn:t).placeholder}function oo(){var t=Cn.iteratee||ru;return t=t===ru?zr:t,arguments.length?t(arguments[0],arguments[1]):t}function so(t,e){var n,r,i=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof e?"string":"hash"]:i.map}function ao(t){for(var e=Pa(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,bo(i)]}return e}function uo(t,e){var n=function(t,e){return null==t?i:t[e]}(t,e);return Ur(n)?n:i}var co=_e?function(t){return null==t?[]:(t=At(t),Ee(_e(t),(function(e){return Yt.call(t,e)})))}:du,lo=_e?function(t){for(var e=[];t;)Ue(e,co(t)),t=Gt(t);return e}:du,fo=kr;function ho(t,e,n){for(var r=-1,i=(e=mi(e,t)).length,o=!1;++r<i;){var s=Ro(e[r]);if(!(o=null!=t&&n(t,s)))break;t=t[s]}return o||++r!=i?o:!!(i=null==t?0:t.length)&&Qs(i)&&mo(s,i)&&(Fs(t)||Ls(t))}function po(t){return"function"!=typeof t.constructor||xo(t)?{}:qn(Gt(t))}function _o(t){return Fs(t)||Ls(t)||!!(Xt&&t&&t[Xt])}function mo(t,e){var n=typeof t;return!!(e=null==e?f:e)&&("number"==n||"symbol"!=n&&gt.test(t))&&t>-1&&t%1==0&&t<e}function go(t,e,n){if(!Js(n))return!1;var r=typeof e;return!!("number"==r?$s(n)&&mo(e,n.length):"string"==r&&e in n)&&qs(n[e],t)}function vo(t,e){if(Fs(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!aa(t))||J.test(t)||!Q.test(t)||null!=e&&t in At(e)}function yo(t){var e=ro(t),n=Cn[e];if("function"!=typeof n||!(e in Ln.prototype))return!1;if(t===n)return!0;var r=no(n);return!!r&&t===r[0]}(bn&&fo(new bn(new ArrayBuffer(1)))!=U||kn&&fo(new kn)!=b||An&&fo(An.resolve())!=M||Mn&&fo(new Mn)!=S||Tn&&fo(new Tn)!=P)&&(fo=function(t){var e=kr(t),n=e==A?t.constructor:i,r=n?No(n):"";if(r)switch(r){case Pn:return U;case On:return b;case Un:return M;case zn:return S;case Bn:return P}return e});var wo=Ot?Zs:_u;function xo(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Pt)}function bo(t){return t==t&&!Js(t)}function ko(t,e){return function(n){return null!=n&&n[t]===e&&(e!==i||t in At(n))}}function Ao(t,e,n){return e=mn(e===i?t.length-1:e,0),function(){for(var i=arguments,o=-1,s=mn(i.length-e,0),a=r(s);++o<s;)a[o]=i[e+o];o=-1;for(var u=r(e+1);++o<e;)u[o]=i[o];return u[e]=n(a),ke(t,this,u)}}function Mo(t,e){return e.length<2?t:xr(t,ti(e,0,-1))}function To(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var So=Oo(Kr),Eo=le||function(t,e){return fe.setTimeout(t,e)},Io=Oo(Qr);function Po(t,e,n){var r=e+"";return Io(t,function(t,e){var n=e.length;if(!n)return t;var r=n-1;return e[r]=(n>1?"& ":"")+e[r],e=e.join(n>2?", ":" "),t.replace(ot,"{\n/* [wrapped with "+e+"] */\n")}(r,function(t,e){return Me(d,(function(n){var r="_."+n[0];e&n[1]&&!Ie(t,r)&&t.push(r)})),t.sort()}(function(t){var e=t.match(st);return e?e[1].split(at):[]}(r),n)))}function Oo(t){var e=0,n=0;return function(){var r=vn(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(i,arguments)}}function Uo(t,e){var n=-1,r=t.length,o=r-1;for(e=e===i?r:e;++n<e;){var s=$r(n,o),a=t[s];t[s]=t[n],t[n]=a}return t.length=e,t}var zo,Bo,jo=(zo=zs((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(tt,(function(t,n,r,i){e.push(r?i.replace(lt,"$1"):n||t)})),e}),(function(t){return 500===Bo.size&&Bo.clear(),t})),Bo=zo.cache,zo);function Ro(t){if("string"==typeof t||aa(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}function No(t){if(null!=t){try{return Ut.call(t)}catch(t){}try{return t+""}catch(t){}}return""}function Co(t){if(t instanceof Ln)return t.clone();var e=new Vn(t.__wrapped__,t.__chain__);return e.__actions__=Ti(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}var qo=Wr((function(t,e){return Ys(t)?cr(t,_r(e,1,Ys,!0)):[]})),Do=Wr((function(t,e){var n=Ho(e);return Ys(n)&&(n=i),Ys(t)?cr(t,_r(e,1,Ys,!0),oo(n,2)):[]})),Vo=Wr((function(t,e){var n=Ho(e);return Ys(n)&&(n=i),Ys(t)?cr(t,_r(e,1,Ys,!0),i,n):[]}));function Lo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),Ce(t,oo(e,3),i)}function Fo(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r-1;return n!==i&&(o=pa(n),o=n<0?mn(r+o,0):gn(o,r-1)),Ce(t,oo(e,3),o,!0)}function Go(t){return null!=t&&t.length?_r(t,1):[]}function $o(t){return t&&t.length?t[0]:i}var Yo=Wr((function(t){var e=Oe(t,di);return e.length&&e[0]===t[0]?Sr(e):[]})),Wo=Wr((function(t){var e=Ho(t),n=Oe(t,di);return e===Ho(n)?e=i:n.pop(),n.length&&n[0]===t[0]?Sr(n,oo(e,2)):[]})),Xo=Wr((function(t){var e=Ho(t),n=Oe(t,di);return(e="function"==typeof e?e:i)&&n.pop(),n.length&&n[0]===t[0]?Sr(n,i,e):[]}));function Ho(t){var e=null==t?0:t.length;return e?t[e-1]:i}var Zo=Wr(Ko);function Ko(t,e){return t&&t.length&&e&&e.length?Fr(t,e):t}var Qo=Ji((function(t,e){var n=null==t?0:t.length,r=ir(t,e);return Gr(t,Oe(e,(function(t){return mo(t,n)?+t:t})).sort(ki)),r}));function Jo(t){return null==t?t:xn.call(t)}var ts=Wr((function(t){return ai(_r(t,1,Ys,!0))})),es=Wr((function(t){var e=Ho(t);return Ys(e)&&(e=i),ai(_r(t,1,Ys,!0),oo(e,2))})),ns=Wr((function(t){var e=Ho(t);return e="function"==typeof e?e:i,ai(_r(t,1,Ys,!0),i,e)}));function rs(t){if(!t||!t.length)return[];var e=0;return t=Ee(t,(function(t){if(Ys(t))return e=mn(t.length,e),!0})),We(e,(function(e){return Oe(t,Fe(e))}))}function is(t,e){if(!t||!t.length)return[];var n=rs(t);return null==e?n:Oe(n,(function(t){return ke(e,i,t)}))}var os=Wr((function(t,e){return Ys(t)?cr(t,e):[]})),ss=Wr((function(t){return hi(Ee(t,Ys))})),as=Wr((function(t){var e=Ho(t);return Ys(e)&&(e=i),hi(Ee(t,Ys),oo(e,2))})),us=Wr((function(t){var e=Ho(t);return e="function"==typeof e?e:i,hi(Ee(t,Ys),i,e)})),cs=Wr(rs),ls=Wr((function(t){var e=t.length,n=e>1?t[e-1]:i;return n="function"==typeof n?(t.pop(),n):i,is(t,n)}));function fs(t){var e=Cn(t);return e.__chain__=!0,e}function hs(t,e){return e(t)}var ps=Ji((function(t){var e=t.length,n=e?t[0]:0,r=this.__wrapped__,o=function(e){return ir(e,t)};return!(e>1||this.__actions__.length)&&r instanceof Ln&&mo(n)?((r=r.slice(n,+n+(e?1:0))).__actions__.push({func:hs,args:[o],thisArg:i}),new Vn(r,this.__chain__).thru((function(t){return e&&!t.length&&t.push(i),t}))):this.thru(o)})),ds=Ei((function(t,e,n){zt.call(t,n)?++t[n]:rr(t,n,1)})),_s=ji(Lo),ms=ji(Fo);function gs(t,e){return(Fs(t)?Me:lr)(t,oo(e,3))}function vs(t,e){return(Fs(t)?Te:fr)(t,oo(e,3))}var ys=Ei((function(t,e,n){zt.call(t,n)?t[n].push(e):rr(t,n,[e])})),ws=Wr((function(t,e,n){var i=-1,o="function"==typeof e,s=$s(t)?r(t.length):[];return lr(t,(function(t){s[++i]=o?ke(e,t,n):Er(t,e,n)})),s})),xs=Ei((function(t,e,n){rr(t,n,e)}));function bs(t,e){return(Fs(t)?Oe:Rr)(t,oo(e,3))}var ks=Ei((function(t,e,n){t[n?0:1].push(e)}),(function(){return[[],[]]})),As=Wr((function(t,e){if(null==t)return[];var n=e.length;return n>1&&go(t,e[0],e[1])?e=[]:n>2&&go(e[0],e[1],e[2])&&(e=[e[0]]),Vr(t,_r(e,1),[])})),Ms=ce||function(){return fe.Date.now()};function Ts(t,e,n){return e=n?i:e,e=t&&null==e?t.length:e,Xi(t,c,i,i,i,i,e)}function Ss(t,e){var n;if("function"!=typeof e)throw new St(o);return t=pa(t),function(){return--t>0&&(n=e.apply(this,arguments)),t<=1&&(e=i),n}}var Es=Wr((function(t,e,n){var r=1;if(n.length){var i=an(n,io(Es));r|=u}return Xi(t,r,e,n,i)})),Is=Wr((function(t,e,n){var r=3;if(n.length){var i=an(n,io(Is));r|=u}return Xi(e,r,t,n,i)}));function Ps(t,e,n){var r,s,a,u,c,l,f=0,h=!1,p=!1,d=!0;if("function"!=typeof t)throw new St(o);function _(e){var n=r,o=s;return r=s=i,f=e,u=t.apply(o,n)}function m(t){var n=t-l;return l===i||n>=e||n<0||p&&t-f>=a}function g(){var t=Ms();if(m(t))return v(t);c=Eo(g,function(t){var n=e-(t-l);return p?gn(n,a-(t-f)):n}(t))}function v(t){return c=i,d&&r?_(t):(r=s=i,u)}function y(){var t=Ms(),n=m(t);if(r=arguments,s=this,l=t,n){if(c===i)return function(t){return f=t,c=Eo(g,e),h?_(t):u}(l);if(p)return yi(c),c=Eo(g,e),_(l)}return c===i&&(c=Eo(g,e)),u}return e=_a(e)||0,Js(n)&&(h=!!n.leading,a=(p="maxWait"in n)?mn(_a(n.maxWait)||0,e):a,d="trailing"in n?!!n.trailing:d),y.cancel=function(){c!==i&&yi(c),f=0,r=l=s=c=i},y.flush=function(){return c===i?u:v(Ms())},y}var Os=Wr((function(t,e){return ur(t,1,e)})),Us=Wr((function(t,e,n){return ur(t,_a(e)||0,n)}));function zs(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new St(o);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=t.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(zs.Cache||$n),n}function Bs(t){if("function"!=typeof t)throw new St(o);return function(){var e=arguments;switch(e.length){case 0:return!t.call(this);case 1:return!t.call(this,e[0]);case 2:return!t.call(this,e[0],e[1]);case 3:return!t.call(this,e[0],e[1],e[2])}return!t.apply(this,e)}}zs.Cache=$n;var js=gi((function(t,e){var n=(e=1==e.length&&Fs(e[0])?Oe(e[0],He(oo())):Oe(_r(e,1),He(oo()))).length;return Wr((function(r){for(var i=-1,o=gn(r.length,n);++i<o;)r[i]=e[i].call(this,r[i]);return ke(t,this,r)}))})),Rs=Wr((function(t,e){var n=an(e,io(Rs));return Xi(t,u,i,e,n)})),Ns=Wr((function(t,e){var n=an(e,io(Ns));return Xi(t,64,i,e,n)})),Cs=Ji((function(t,e){return Xi(t,256,i,i,i,e)}));function qs(t,e){return t===e||t!=t&&e!=e}var Ds=Fi(Ar),Vs=Fi((function(t,e){return t>=e})),Ls=Ir(function(){return arguments}())?Ir:function(t){return ta(t)&&zt.call(t,"callee")&&!Yt.call(t,"callee")},Fs=r.isArray,Gs=ge?He(ge):function(t){return ta(t)&&kr(t)==O};function $s(t){return null!=t&&Qs(t.length)&&!Zs(t)}function Ys(t){return ta(t)&&$s(t)}var Ws=me||_u,Xs=ve?He(ve):function(t){return ta(t)&&kr(t)==v};function Hs(t){if(!ta(t))return!1;var e=kr(t);return e==y||"[object DOMException]"==e||"string"==typeof t.message&&"string"==typeof t.name&&!ra(t)}function Zs(t){if(!Js(t))return!1;var e=kr(t);return e==w||e==x||"[object AsyncFunction]"==e||"[object Proxy]"==e}function Ks(t){return"number"==typeof t&&t==pa(t)}function Qs(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=f}function Js(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function ta(t){return null!=t&&"object"==typeof t}var ea=ye?He(ye):function(t){return ta(t)&&fo(t)==b};function na(t){return"number"==typeof t||ta(t)&&kr(t)==k}function ra(t){if(!ta(t)||kr(t)!=A)return!1;var e=Gt(t);if(null===e)return!0;var n=zt.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ut.call(n)==Nt}var ia=we?He(we):function(t){return ta(t)&&kr(t)==T},oa=xe?He(xe):function(t){return ta(t)&&fo(t)==S};function sa(t){return"string"==typeof t||!Fs(t)&&ta(t)&&kr(t)==E}function aa(t){return"symbol"==typeof t||ta(t)&&kr(t)==I}var ua=be?He(be):function(t){return ta(t)&&Qs(t.length)&&!!ie[kr(t)]},ca=Fi(jr),la=Fi((function(t,e){return t<=e}));function fa(t){if(!t)return[];if($s(t))return sa(t)?fn(t):Ti(t);if(Ht&&t[Ht])return function(t){for(var e,n=[];!(e=t.next()).done;)n.push(e.value);return n}(t[Ht]());var e=fo(t);return(e==b?on:e==S?un:qa)(t)}function ha(t){return t?(t=_a(t))===l||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0}function pa(t){var e=ha(t),n=e%1;return e==e?n?e-n:e:0}function da(t){return t?or(pa(t),0,p):0}function _a(t){if("number"==typeof t)return t;if(aa(t))return h;if(Js(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Js(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=Xe(t);var n=dt.test(t);return n||mt.test(t)?ue(t.slice(2),n?2:8):pt.test(t)?h:+t}function ma(t){return Si(t,Oa(t))}function ga(t){return null==t?"":si(t)}var va=Ii((function(t,e){if(xo(e)||$s(e))Si(e,Pa(e),t);else for(var n in e)zt.call(e,n)&&Jn(t,n,e[n])})),ya=Ii((function(t,e){Si(e,Oa(e),t)})),wa=Ii((function(t,e,n,r){Si(e,Oa(e),t,r)})),xa=Ii((function(t,e,n,r){Si(e,Pa(e),t,r)})),ba=Ji(ir),ka=Wr((function(t,e){t=At(t);var n=-1,r=e.length,o=r>2?e[2]:i;for(o&&go(e[0],e[1],o)&&(r=1);++n<r;)for(var s=e[n],a=Oa(s),u=-1,c=a.length;++u<c;){var l=a[u],f=t[l];(f===i||qs(f,Pt[l])&&!zt.call(t,l))&&(t[l]=s[l])}return t})),Aa=Wr((function(t){return t.push(i,Zi),ke(za,i,t)}));function Ma(t,e,n){var r=null==t?i:xr(t,e);return r===i?n:r}function Ta(t,e){return null!=t&&ho(t,e,Tr)}var Sa=Ci((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),t[e]=n}),Ja(nu)),Ea=Ci((function(t,e,n){null!=e&&"function"!=typeof e.toString&&(e=Rt.call(e)),zt.call(t,e)?t[e].push(n):t[e]=[n]}),oo),Ia=Wr(Er);function Pa(t){return $s(t)?Xn(t):Br(t)}function Oa(t){return $s(t)?Xn(t,!0):function(t){if(!Js(t))return function(t){var e=[];if(null!=t)for(var n in At(t))e.push(n);return e}(t);var e=xo(t),n=[];for(var r in t)("constructor"!=r||!e&&zt.call(t,r))&&n.push(r);return n}(t)}var Ua=Ii((function(t,e,n){qr(t,e,n)})),za=Ii((function(t,e,n,r){qr(t,e,n,r)})),Ba=Ji((function(t,e){var n={};if(null==t)return n;var r=!1;e=Oe(e,(function(e){return e=mi(e,t),r||(r=e.length>1),e})),Si(t,eo(t),n),r&&(n=sr(n,7,Ki));for(var i=e.length;i--;)ui(n,e[i]);return n})),ja=Ji((function(t,e){return null==t?{}:function(t,e){return Lr(t,e,(function(e,n){return Ta(t,n)}))}(t,e)}));function Ra(t,e){if(null==t)return{};var n=Oe(eo(t),(function(t){return[t]}));return e=oo(e),Lr(t,n,(function(t,n){return e(t,n[0])}))}var Na=Wi(Pa),Ca=Wi(Oa);function qa(t){return null==t?[]:Ze(t,Pa(t))}var Da=zi((function(t,e,n){return e=e.toLowerCase(),t+(n?Va(e):e)}));function Va(t){return Ha(ga(t).toLowerCase())}function La(t){return(t=ga(t))&&t.replace(vt,tn).replace(Kt,"")}var Fa=zi((function(t,e,n){return t+(n?"-":"")+e.toLowerCase()})),Ga=zi((function(t,e,n){return t+(n?" ":"")+e.toLowerCase()})),$a=Ui("toLowerCase"),Ya=zi((function(t,e,n){return t+(n?"_":"")+e.toLowerCase()})),Wa=zi((function(t,e,n){return t+(n?" ":"")+Ha(e)})),Xa=zi((function(t,e,n){return t+(n?" ":"")+e.toUpperCase()})),Ha=Ui("toUpperCase");function Za(t,e,n){return t=ga(t),(e=n?i:e)===i?function(t){return ee.test(t)}(t)?function(t){return t.match(Jt)||[]}(t):function(t){return t.match(ut)||[]}(t):t.match(e)||[]}var Ka=Wr((function(t,e){try{return ke(t,i,e)}catch(t){return Hs(t)?t:new xt(t)}})),Qa=Ji((function(t,e){return Me(e,(function(e){e=Ro(e),rr(t,e,Es(t[e],t))})),t}));function Ja(t){return function(){return t}}var tu=Ri(),eu=Ri(!0);function nu(t){return t}function ru(t){return zr("function"==typeof t?t:sr(t,1))}var iu=Wr((function(t,e){return function(n){return Er(n,t,e)}})),ou=Wr((function(t,e){return function(n){return Er(t,n,e)}}));function su(t,e,n){var r=Pa(e),i=wr(e,r);null!=n||Js(e)&&(i.length||!r.length)||(n=e,e=t,t=this,i=wr(e,Pa(e)));var o=!(Js(n)&&"chain"in n&&!n.chain),s=Zs(t);return Me(i,(function(n){var r=e[n];t[n]=r,s&&(t.prototype[n]=function(){var e=this.__chain__;if(o||e){var n=t(this.__wrapped__);return(n.__actions__=Ti(this.__actions__)).push({func:r,args:arguments,thisArg:t}),n.__chain__=e,n}return r.apply(t,Ue([this.value()],arguments))})})),t}function au(){}var uu=Di(Oe),cu=Di(Se),lu=Di(je);function fu(t){return vo(t)?Fe(Ro(t)):function(t){return function(e){return xr(e,t)}}(t)}var hu=Li(),pu=Li(!0);function du(){return[]}function _u(){return!1}var mu,gu=qi((function(t,e){return t+e}),0),vu=$i("ceil"),yu=qi((function(t,e){return t/e}),1),wu=$i("floor"),xu=qi((function(t,e){return t*e}),1),bu=$i("round"),ku=qi((function(t,e){return t-e}),0);return Cn.after=function(t,e){if("function"!=typeof e)throw new St(o);return t=pa(t),function(){if(--t<1)return e.apply(this,arguments)}},Cn.ary=Ts,Cn.assign=va,Cn.assignIn=ya,Cn.assignInWith=wa,Cn.assignWith=xa,Cn.at=ba,Cn.before=Ss,Cn.bind=Es,Cn.bindAll=Qa,Cn.bindKey=Is,Cn.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return Fs(t)?t:[t]},Cn.chain=fs,Cn.chunk=function(t,e,n){e=(n?go(t,e,n):e===i)?1:mn(pa(e),0);var o=null==t?0:t.length;if(!o||e<1)return[];for(var s=0,a=0,u=r(he(o/e));s<o;)u[a++]=ti(t,s,s+=e);return u},Cn.compact=function(t){for(var e=-1,n=null==t?0:t.length,r=0,i=[];++e<n;){var o=t[e];o&&(i[r++]=o)}return i},Cn.concat=function(){var t=arguments.length;if(!t)return[];for(var e=r(t-1),n=arguments[0],i=t;i--;)e[i-1]=arguments[i];return Ue(Fs(n)?Ti(n):[n],_r(e,1))},Cn.cond=function(t){var e=null==t?0:t.length,n=oo();return t=e?Oe(t,(function(t){if("function"!=typeof t[1])throw new St(o);return[n(t[0]),t[1]]})):[],Wr((function(n){for(var r=-1;++r<e;){var i=t[r];if(ke(i[0],this,n))return ke(i[1],this,n)}}))},Cn.conforms=function(t){return function(t){var e=Pa(t);return function(n){return ar(n,t,e)}}(sr(t,1))},Cn.constant=Ja,Cn.countBy=ds,Cn.create=function(t,e){var n=qn(t);return null==e?n:nr(n,e)},Cn.curry=function t(e,n,r){var o=Xi(e,8,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Cn.curryRight=function t(e,n,r){var o=Xi(e,16,i,i,i,i,i,n=r?i:n);return o.placeholder=t.placeholder,o},Cn.debounce=Ps,Cn.defaults=ka,Cn.defaultsDeep=Aa,Cn.defer=Os,Cn.delay=Us,Cn.difference=qo,Cn.differenceBy=Do,Cn.differenceWith=Vo,Cn.drop=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,(e=n||e===i?1:pa(e))<0?0:e,r):[]},Cn.dropRight=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,0,(e=r-(e=n||e===i?1:pa(e)))<0?0:e):[]},Cn.dropRightWhile=function(t,e){return t&&t.length?li(t,oo(e,3),!0,!0):[]},Cn.dropWhile=function(t,e){return t&&t.length?li(t,oo(e,3),!0):[]},Cn.fill=function(t,e,n,r){var o=null==t?0:t.length;return o?(n&&"number"!=typeof n&&go(t,e,n)&&(n=0,r=o),function(t,e,n,r){var o=t.length;for((n=pa(n))<0&&(n=-n>o?0:o+n),(r=r===i||r>o?o:pa(r))<0&&(r+=o),r=n>r?0:da(r);n<r;)t[n++]=e;return t}(t,e,n,r)):[]},Cn.filter=function(t,e){return(Fs(t)?Ee:dr)(t,oo(e,3))},Cn.flatMap=function(t,e){return _r(bs(t,e),1)},Cn.flatMapDeep=function(t,e){return _r(bs(t,e),l)},Cn.flatMapDepth=function(t,e,n){return n=n===i?1:pa(n),_r(bs(t,e),n)},Cn.flatten=Go,Cn.flattenDeep=function(t){return null!=t&&t.length?_r(t,l):[]},Cn.flattenDepth=function(t,e){return null!=t&&t.length?_r(t,e=e===i?1:pa(e)):[]},Cn.flip=function(t){return Xi(t,512)},Cn.flow=tu,Cn.flowRight=eu,Cn.fromPairs=function(t){for(var e=-1,n=null==t?0:t.length,r={};++e<n;){var i=t[e];r[i[0]]=i[1]}return r},Cn.functions=function(t){return null==t?[]:wr(t,Pa(t))},Cn.functionsIn=function(t){return null==t?[]:wr(t,Oa(t))},Cn.groupBy=ys,Cn.initial=function(t){return null!=t&&t.length?ti(t,0,-1):[]},Cn.intersection=Yo,Cn.intersectionBy=Wo,Cn.intersectionWith=Xo,Cn.invert=Sa,Cn.invertBy=Ea,Cn.invokeMap=ws,Cn.iteratee=ru,Cn.keyBy=xs,Cn.keys=Pa,Cn.keysIn=Oa,Cn.map=bs,Cn.mapKeys=function(t,e){var n={};return e=oo(e,3),vr(t,(function(t,r,i){rr(n,e(t,r,i),t)})),n},Cn.mapValues=function(t,e){var n={};return e=oo(e,3),vr(t,(function(t,r,i){rr(n,r,e(t,r,i))})),n},Cn.matches=function(t){return Nr(sr(t,1))},Cn.matchesProperty=function(t,e){return Cr(t,sr(e,1))},Cn.memoize=zs,Cn.merge=Ua,Cn.mergeWith=za,Cn.method=iu,Cn.methodOf=ou,Cn.mixin=su,Cn.negate=Bs,Cn.nthArg=function(t){return t=pa(t),Wr((function(e){return Dr(e,t)}))},Cn.omit=Ba,Cn.omitBy=function(t,e){return Ra(t,Bs(oo(e)))},Cn.once=function(t){return Ss(2,t)},Cn.orderBy=function(t,e,n,r){return null==t?[]:(Fs(e)||(e=null==e?[]:[e]),Fs(n=r?i:n)||(n=null==n?[]:[n]),Vr(t,e,n))},Cn.over=uu,Cn.overArgs=js,Cn.overEvery=cu,Cn.overSome=lu,Cn.partial=Rs,Cn.partialRight=Ns,Cn.partition=ks,Cn.pick=ja,Cn.pickBy=Ra,Cn.property=fu,Cn.propertyOf=function(t){return function(e){return null==t?i:xr(t,e)}},Cn.pull=Zo,Cn.pullAll=Ko,Cn.pullAllBy=function(t,e,n){return t&&t.length&&e&&e.length?Fr(t,e,oo(n,2)):t},Cn.pullAllWith=function(t,e,n){return t&&t.length&&e&&e.length?Fr(t,e,i,n):t},Cn.pullAt=Qo,Cn.range=hu,Cn.rangeRight=pu,Cn.rearg=Cs,Cn.reject=function(t,e){return(Fs(t)?Ee:dr)(t,Bs(oo(e,3)))},Cn.remove=function(t,e){var n=[];if(!t||!t.length)return n;var r=-1,i=[],o=t.length;for(e=oo(e,3);++r<o;){var s=t[r];e(s,r,t)&&(n.push(s),i.push(r))}return Gr(t,i),n},Cn.rest=function(t,e){if("function"!=typeof t)throw new St(o);return Wr(t,e=e===i?e:pa(e))},Cn.reverse=Jo,Cn.sampleSize=function(t,e,n){return e=(n?go(t,e,n):e===i)?1:pa(e),(Fs(t)?Zn:Hr)(t,e)},Cn.set=function(t,e,n){return null==t?t:Zr(t,e,n)},Cn.setWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:Zr(t,e,n,r)},Cn.shuffle=function(t){return(Fs(t)?Kn:Jr)(t)},Cn.slice=function(t,e,n){var r=null==t?0:t.length;return r?(n&&"number"!=typeof n&&go(t,e,n)?(e=0,n=r):(e=null==e?0:pa(e),n=n===i?r:pa(n)),ti(t,e,n)):[]},Cn.sortBy=As,Cn.sortedUniq=function(t){return t&&t.length?ii(t):[]},Cn.sortedUniqBy=function(t,e){return t&&t.length?ii(t,oo(e,2)):[]},Cn.split=function(t,e,n){return n&&"number"!=typeof n&&go(t,e,n)&&(e=n=i),(n=n===i?p:n>>>0)?(t=ga(t))&&("string"==typeof e||null!=e&&!ia(e))&&!(e=si(e))&&rn(t)?vi(fn(t),0,n):t.split(e,n):[]},Cn.spread=function(t,e){if("function"!=typeof t)throw new St(o);return e=null==e?0:mn(pa(e),0),Wr((function(n){var r=n[e],i=vi(n,0,e);return r&&Ue(i,r),ke(t,this,i)}))},Cn.tail=function(t){var e=null==t?0:t.length;return e?ti(t,1,e):[]},Cn.take=function(t,e,n){return t&&t.length?ti(t,0,(e=n||e===i?1:pa(e))<0?0:e):[]},Cn.takeRight=function(t,e,n){var r=null==t?0:t.length;return r?ti(t,(e=r-(e=n||e===i?1:pa(e)))<0?0:e,r):[]},Cn.takeRightWhile=function(t,e){return t&&t.length?li(t,oo(e,3),!1,!0):[]},Cn.takeWhile=function(t,e){return t&&t.length?li(t,oo(e,3)):[]},Cn.tap=function(t,e){return e(t),t},Cn.throttle=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new St(o);return Js(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Ps(t,e,{leading:r,maxWait:e,trailing:i})},Cn.thru=hs,Cn.toArray=fa,Cn.toPairs=Na,Cn.toPairsIn=Ca,Cn.toPath=function(t){return Fs(t)?Oe(t,Ro):aa(t)?[t]:Ti(jo(ga(t)))},Cn.toPlainObject=ma,Cn.transform=function(t,e,n){var r=Fs(t),i=r||Ws(t)||ua(t);if(e=oo(e,4),null==n){var o=t&&t.constructor;n=i?r?new o:[]:Js(t)&&Zs(o)?qn(Gt(t)):{}}return(i?Me:vr)(t,(function(t,r,i){return e(n,t,r,i)})),n},Cn.unary=function(t){return Ts(t,1)},Cn.union=ts,Cn.unionBy=es,Cn.unionWith=ns,Cn.uniq=function(t){return t&&t.length?ai(t):[]},Cn.uniqBy=function(t,e){return t&&t.length?ai(t,oo(e,2)):[]},Cn.uniqWith=function(t,e){return e="function"==typeof e?e:i,t&&t.length?ai(t,i,e):[]},Cn.unset=function(t,e){return null==t||ui(t,e)},Cn.unzip=rs,Cn.unzipWith=is,Cn.update=function(t,e,n){return null==t?t:ci(t,e,_i(n))},Cn.updateWith=function(t,e,n,r){return r="function"==typeof r?r:i,null==t?t:ci(t,e,_i(n),r)},Cn.values=qa,Cn.valuesIn=function(t){return null==t?[]:Ze(t,Oa(t))},Cn.without=os,Cn.words=Za,Cn.wrap=function(t,e){return Rs(_i(e),t)},Cn.xor=ss,Cn.xorBy=as,Cn.xorWith=us,Cn.zip=cs,Cn.zipObject=function(t,e){return pi(t||[],e||[],Jn)},Cn.zipObjectDeep=function(t,e){return pi(t||[],e||[],Zr)},Cn.zipWith=ls,Cn.entries=Na,Cn.entriesIn=Ca,Cn.extend=ya,Cn.extendWith=wa,su(Cn,Cn),Cn.add=gu,Cn.attempt=Ka,Cn.camelCase=Da,Cn.capitalize=Va,Cn.ceil=vu,Cn.clamp=function(t,e,n){return n===i&&(n=e,e=i),n!==i&&(n=(n=_a(n))==n?n:0),e!==i&&(e=(e=_a(e))==e?e:0),or(_a(t),e,n)},Cn.clone=function(t){return sr(t,4)},Cn.cloneDeep=function(t){return sr(t,5)},Cn.cloneDeepWith=function(t,e){return sr(t,5,e="function"==typeof e?e:i)},Cn.cloneWith=function(t,e){return sr(t,4,e="function"==typeof e?e:i)},Cn.conformsTo=function(t,e){return null==e||ar(t,e,Pa(e))},Cn.deburr=La,Cn.defaultTo=function(t,e){return null==t||t!=t?e:t},Cn.divide=yu,Cn.endsWith=function(t,e,n){t=ga(t),e=si(e);var r=t.length,o=n=n===i?r:or(pa(n),0,r);return(n-=e.length)>=0&&t.slice(n,o)==e},Cn.eq=qs,Cn.escape=function(t){return(t=ga(t))&&X.test(t)?t.replace(Y,en):t},Cn.escapeRegExp=function(t){return(t=ga(t))&&nt.test(t)?t.replace(et,"\\$&"):t},Cn.every=function(t,e,n){var r=Fs(t)?Se:hr;return n&&go(t,e,n)&&(e=i),r(t,oo(e,3))},Cn.find=_s,Cn.findIndex=Lo,Cn.findKey=function(t,e){return Ne(t,oo(e,3),vr)},Cn.findLast=ms,Cn.findLastIndex=Fo,Cn.findLastKey=function(t,e){return Ne(t,oo(e,3),yr)},Cn.floor=wu,Cn.forEach=gs,Cn.forEachRight=vs,Cn.forIn=function(t,e){return null==t?t:mr(t,oo(e,3),Oa)},Cn.forInRight=function(t,e){return null==t?t:gr(t,oo(e,3),Oa)},Cn.forOwn=function(t,e){return t&&vr(t,oo(e,3))},Cn.forOwnRight=function(t,e){return t&&yr(t,oo(e,3))},Cn.get=Ma,Cn.gt=Ds,Cn.gte=Vs,Cn.has=function(t,e){return null!=t&&ho(t,e,Mr)},Cn.hasIn=Ta,Cn.head=$o,Cn.identity=nu,Cn.includes=function(t,e,n,r){t=$s(t)?t:qa(t),n=n&&!r?pa(n):0;var i=t.length;return n<0&&(n=mn(i+n,0)),sa(t)?n<=i&&t.indexOf(e,n)>-1:!!i&&qe(t,e,n)>-1},Cn.indexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var i=null==n?0:pa(n);return i<0&&(i=mn(r+i,0)),qe(t,e,i)},Cn.inRange=function(t,e,n){return e=ha(e),n===i?(n=e,e=0):n=ha(n),function(t,e,n){return t>=gn(e,n)&&t<mn(e,n)}(t=_a(t),e,n)},Cn.invoke=Ia,Cn.isArguments=Ls,Cn.isArray=Fs,Cn.isArrayBuffer=Gs,Cn.isArrayLike=$s,Cn.isArrayLikeObject=Ys,Cn.isBoolean=function(t){return!0===t||!1===t||ta(t)&&kr(t)==g},Cn.isBuffer=Ws,Cn.isDate=Xs,Cn.isElement=function(t){return ta(t)&&1===t.nodeType&&!ra(t)},Cn.isEmpty=function(t){if(null==t)return!0;if($s(t)&&(Fs(t)||"string"==typeof t||"function"==typeof t.splice||Ws(t)||ua(t)||Ls(t)))return!t.length;var e=fo(t);if(e==b||e==S)return!t.size;if(xo(t))return!Br(t).length;for(var n in t)if(zt.call(t,n))return!1;return!0},Cn.isEqual=function(t,e){return Pr(t,e)},Cn.isEqualWith=function(t,e,n){var r=(n="function"==typeof n?n:i)?n(t,e):i;return r===i?Pr(t,e,i,n):!!r},Cn.isError=Hs,Cn.isFinite=function(t){return"number"==typeof t&&Re(t)},Cn.isFunction=Zs,Cn.isInteger=Ks,Cn.isLength=Qs,Cn.isMap=ea,Cn.isMatch=function(t,e){return t===e||Or(t,e,ao(e))},Cn.isMatchWith=function(t,e,n){return n="function"==typeof n?n:i,Or(t,e,ao(e),n)},Cn.isNaN=function(t){return na(t)&&t!=+t},Cn.isNative=function(t){if(wo(t))throw new xt("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Ur(t)},Cn.isNil=function(t){return null==t},Cn.isNull=function(t){return null===t},Cn.isNumber=na,Cn.isObject=Js,Cn.isObjectLike=ta,Cn.isPlainObject=ra,Cn.isRegExp=ia,Cn.isSafeInteger=function(t){return Ks(t)&&t>=-9007199254740991&&t<=f},Cn.isSet=oa,Cn.isString=sa,Cn.isSymbol=aa,Cn.isTypedArray=ua,Cn.isUndefined=function(t){return t===i},Cn.isWeakMap=function(t){return ta(t)&&fo(t)==P},Cn.isWeakSet=function(t){return ta(t)&&"[object WeakSet]"==kr(t)},Cn.join=function(t,e){return null==t?"":Ge.call(t,e)},Cn.kebabCase=Fa,Cn.last=Ho,Cn.lastIndexOf=function(t,e,n){var r=null==t?0:t.length;if(!r)return-1;var o=r;return n!==i&&(o=(o=pa(n))<0?mn(r+o,0):gn(o,r-1)),e==e?function(t,e,n){for(var r=n+1;r--;)if(t[r]===e)return r;return r}(t,e,o):Ce(t,Ve,o,!0)},Cn.lowerCase=Ga,Cn.lowerFirst=$a,Cn.lt=ca,Cn.lte=la,Cn.max=function(t){return t&&t.length?pr(t,nu,Ar):i},Cn.maxBy=function(t,e){return t&&t.length?pr(t,oo(e,2),Ar):i},Cn.mean=function(t){return Le(t,nu)},Cn.meanBy=function(t,e){return Le(t,oo(e,2))},Cn.min=function(t){return t&&t.length?pr(t,nu,jr):i},Cn.minBy=function(t,e){return t&&t.length?pr(t,oo(e,2),jr):i},Cn.stubArray=du,Cn.stubFalse=_u,Cn.stubObject=function(){return{}},Cn.stubString=function(){return""},Cn.stubTrue=function(){return!0},Cn.multiply=xu,Cn.nth=function(t,e){return t&&t.length?Dr(t,pa(e)):i},Cn.noConflict=function(){return fe._===this&&(fe._=Ct),this},Cn.noop=au,Cn.now=Ms,Cn.pad=function(t,e,n){t=ga(t);var r=(e=pa(e))?ln(t):0;if(!e||r>=e)return t;var i=(e-r)/2;return Vi(pe(i),n)+t+Vi(he(i),n)},Cn.padEnd=function(t,e,n){t=ga(t);var r=(e=pa(e))?ln(t):0;return e&&r<e?t+Vi(e-r,n):t},Cn.padStart=function(t,e,n){t=ga(t);var r=(e=pa(e))?ln(t):0;return e&&r<e?Vi(e-r,n)+t:t},Cn.parseInt=function(t,e,n){return n||null==e?e=0:e&&(e=+e),yn(ga(t).replace(rt,""),e||0)},Cn.random=function(t,e,n){if(n&&"boolean"!=typeof n&&go(t,e,n)&&(e=n=i),n===i&&("boolean"==typeof e?(n=e,e=i):"boolean"==typeof t&&(n=t,t=i)),t===i&&e===i?(t=0,e=1):(t=ha(t),e===i?(e=t,t=0):e=ha(e)),t>e){var r=t;t=e,e=r}if(n||t%1||e%1){var o=wn();return gn(t+o*(e-t+ae("1e-"+((o+"").length-1))),e)}return $r(t,e)},Cn.reduce=function(t,e,n){var r=Fs(t)?ze:$e,i=arguments.length<3;return r(t,oo(e,4),n,i,lr)},Cn.reduceRight=function(t,e,n){var r=Fs(t)?Be:$e,i=arguments.length<3;return r(t,oo(e,4),n,i,fr)},Cn.repeat=function(t,e,n){return e=(n?go(t,e,n):e===i)?1:pa(e),Yr(ga(t),e)},Cn.replace=function(){var t=arguments,e=ga(t[0]);return t.length<3?e:e.replace(t[1],t[2])},Cn.result=function(t,e,n){var r=-1,o=(e=mi(e,t)).length;for(o||(o=1,t=i);++r<o;){var s=null==t?i:t[Ro(e[r])];s===i&&(r=o,s=n),t=Zs(s)?s.call(t):s}return t},Cn.round=bu,Cn.runInContext=t,Cn.sample=function(t){return(Fs(t)?Hn:Xr)(t)},Cn.size=function(t){if(null==t)return 0;if($s(t))return sa(t)?ln(t):t.length;var e=fo(t);return e==b||e==S?t.size:Br(t).length},Cn.snakeCase=Ya,Cn.some=function(t,e,n){var r=Fs(t)?je:ei;return n&&go(t,e,n)&&(e=i),r(t,oo(e,3))},Cn.sortedIndex=function(t,e){return ni(t,e)},Cn.sortedIndexBy=function(t,e,n){return ri(t,e,oo(n,2))},Cn.sortedIndexOf=function(t,e){var n=null==t?0:t.length;if(n){var r=ni(t,e);if(r<n&&qs(t[r],e))return r}return-1},Cn.sortedLastIndex=function(t,e){return ni(t,e,!0)},Cn.sortedLastIndexBy=function(t,e,n){return ri(t,e,oo(n,2),!0)},Cn.sortedLastIndexOf=function(t,e){if(null!=t&&t.length){var n=ni(t,e,!0)-1;if(qs(t[n],e))return n}return-1},Cn.startCase=Wa,Cn.startsWith=function(t,e,n){return t=ga(t),n=null==n?0:or(pa(n),0,t.length),e=si(e),t.slice(n,n+e.length)==e},Cn.subtract=ku,Cn.sum=function(t){return t&&t.length?Ye(t,nu):0},Cn.sumBy=function(t,e){return t&&t.length?Ye(t,oo(e,2)):0},Cn.template=function(t,e,n){var r=Cn.templateSettings;n&&go(t,e,n)&&(e=i),t=ga(t),e=wa({},e,r,Hi);var o,s,a=wa({},e.imports,r.imports,Hi),u=Pa(a),c=Ze(a,u),l=0,f=e.interpolate||yt,h="__p += '",p=Mt((e.escape||yt).source+"|"+f.source+"|"+(f===K?ft:yt).source+"|"+(e.evaluate||yt).source+"|$","g"),d="//# sourceURL="+(zt.call(e,"sourceURL")?(e.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++re+"]")+"\n";t.replace(p,(function(e,n,r,i,a,u){return r||(r=i),h+=t.slice(l,u).replace(wt,nn),n&&(o=!0,h+="' +\n__e("+n+") +\n'"),a&&(s=!0,h+="';\n"+a+";\n__p += '"),r&&(h+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),l=u+e.length,e})),h+="';\n";var _=zt.call(e,"variable")&&e.variable;if(_){if(ct.test(_))throw new xt("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(s?h.replace(L,""):h).replace(F,"$1").replace(G,"$1;"),h="function("+(_||"obj")+") {\n"+(_?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(s?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var m=Ka((function(){return bt(u,d+"return "+h).apply(i,c)}));if(m.source=h,Hs(m))throw m;return m},Cn.times=function(t,e){if((t=pa(t))<1||t>f)return[];var n=p,r=gn(t,p);e=oo(e),t-=p;for(var i=We(r,e);++n<t;)e(n);return i},Cn.toFinite=ha,Cn.toInteger=pa,Cn.toLength=da,Cn.toLower=function(t){return ga(t).toLowerCase()},Cn.toNumber=_a,Cn.toSafeInteger=function(t){return t?or(pa(t),-9007199254740991,f):0===t?t:0},Cn.toString=ga,Cn.toUpper=function(t){return ga(t).toUpperCase()},Cn.trim=function(t,e,n){if((t=ga(t))&&(n||e===i))return Xe(t);if(!t||!(e=si(e)))return t;var r=fn(t),o=fn(e);return vi(r,Qe(r,o),Je(r,o)+1).join("")},Cn.trimEnd=function(t,e,n){if((t=ga(t))&&(n||e===i))return t.slice(0,hn(t)+1);if(!t||!(e=si(e)))return t;var r=fn(t);return vi(r,0,Je(r,fn(e))+1).join("")},Cn.trimStart=function(t,e,n){if((t=ga(t))&&(n||e===i))return t.replace(rt,"");if(!t||!(e=si(e)))return t;var r=fn(t);return vi(r,Qe(r,fn(e))).join("")},Cn.truncate=function(t,e){var n=30,r="...";if(Js(e)){var o="separator"in e?e.separator:o;n="length"in e?pa(e.length):n,r="omission"in e?si(e.omission):r}var s=(t=ga(t)).length;if(rn(t)){var a=fn(t);s=a.length}if(n>=s)return t;var u=n-ln(r);if(u<1)return r;var c=a?vi(a,0,u).join(""):t.slice(0,u);if(o===i)return c+r;if(a&&(u+=c.length-u),ia(o)){if(t.slice(u).search(o)){var l,f=c;for(o.global||(o=Mt(o.source,ga(ht.exec(o))+"g")),o.lastIndex=0;l=o.exec(f);)var h=l.index;c=c.slice(0,h===i?u:h)}}else if(t.indexOf(si(o),u)!=u){var p=c.lastIndexOf(o);p>-1&&(c=c.slice(0,p))}return c+r},Cn.unescape=function(t){return(t=ga(t))&&W.test(t)?t.replace($,pn):t},Cn.uniqueId=function(t){var e=++Bt;return ga(t)+e},Cn.upperCase=Xa,Cn.upperFirst=Ha,Cn.each=gs,Cn.eachRight=vs,Cn.first=$o,su(Cn,(mu={},vr(Cn,(function(t,e){zt.call(Cn.prototype,e)||(mu[e]=t)})),mu),{chain:!1}),Cn.VERSION="4.17.21",Me(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(t){Cn[t].placeholder=Cn})),Me(["drop","take"],(function(t,e){Ln.prototype[t]=function(n){n=n===i?1:mn(pa(n),0);var r=this.__filtered__&&!e?new Ln(this):this.clone();return r.__filtered__?r.__takeCount__=gn(n,r.__takeCount__):r.__views__.push({size:gn(n,p),type:t+(r.__dir__<0?"Right":"")}),r},Ln.prototype[t+"Right"]=function(e){return this.reverse()[t](e).reverse()}})),Me(["filter","map","takeWhile"],(function(t,e){var n=e+1,r=1==n||3==n;Ln.prototype[t]=function(t){var e=this.clone();return e.__iteratees__.push({iteratee:oo(t,3),type:n}),e.__filtered__=e.__filtered__||r,e}})),Me(["head","last"],(function(t,e){var n="take"+(e?"Right":"");Ln.prototype[t]=function(){return this[n](1).value()[0]}})),Me(["initial","tail"],(function(t,e){var n="drop"+(e?"":"Right");Ln.prototype[t]=function(){return this.__filtered__?new Ln(this):this[n](1)}})),Ln.prototype.compact=function(){return this.filter(nu)},Ln.prototype.find=function(t){return this.filter(t).head()},Ln.prototype.findLast=function(t){return this.reverse().find(t)},Ln.prototype.invokeMap=Wr((function(t,e){return"function"==typeof t?new Ln(this):this.map((function(n){return Er(n,t,e)}))})),Ln.prototype.reject=function(t){return this.filter(Bs(oo(t)))},Ln.prototype.slice=function(t,e){t=pa(t);var n=this;return n.__filtered__&&(t>0||e<0)?new Ln(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),e!==i&&(n=(e=pa(e))<0?n.dropRight(-e):n.take(e-t)),n)},Ln.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},Ln.prototype.toArray=function(){return this.take(p)},vr(Ln.prototype,(function(t,e){var n=/^(?:filter|find|map|reject)|While$/.test(e),r=/^(?:head|last)$/.test(e),o=Cn[r?"take"+("last"==e?"Right":""):e],s=r||/^find/.test(e);o&&(Cn.prototype[e]=function(){var e=this.__wrapped__,a=r?[1]:arguments,u=e instanceof Ln,c=a[0],l=u||Fs(e),f=function(t){var e=o.apply(Cn,Ue([t],a));return r&&h?e[0]:e};l&&n&&"function"==typeof c&&1!=c.length&&(u=l=!1);var h=this.__chain__,p=!!this.__actions__.length,d=s&&!h,_=u&&!p;if(!s&&l){e=_?e:new Ln(this);var m=t.apply(e,a);return m.__actions__.push({func:hs,args:[f],thisArg:i}),new Vn(m,h)}return d&&_?t.apply(this,a):(m=this.thru(f),d?r?m.value()[0]:m.value():m)})})),Me(["pop","push","shift","sort","splice","unshift"],(function(t){var e=Et[t],n=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",r=/^(?:pop|shift)$/.test(t);Cn.prototype[t]=function(){var t=arguments;if(r&&!this.__chain__){var i=this.value();return e.apply(Fs(i)?i:[],t)}return this[n]((function(n){return e.apply(Fs(n)?n:[],t)}))}})),vr(Ln.prototype,(function(t,e){var n=Cn[e];if(n){var r=n.name+"";zt.call(In,r)||(In[r]=[]),In[r].push({name:e,func:n})}})),In[Ni(i,2).name]=[{name:"wrapper",func:i}],Ln.prototype.clone=function(){var t=new Ln(this.__wrapped__);return t.__actions__=Ti(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=Ti(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=Ti(this.__views__),t},Ln.prototype.reverse=function(){if(this.__filtered__){var t=new Ln(this);t.__dir__=-1,t.__filtered__=!0}else(t=this.clone()).__dir__*=-1;return t},Ln.prototype.value=function(){var t=this.__wrapped__.value(),e=this.__dir__,n=Fs(t),r=e<0,i=n?t.length:0,o=function(t,e,n){for(var r=-1,i=n.length;++r<i;){var o=n[r],s=o.size;switch(o.type){case"drop":t+=s;break;case"dropRight":e-=s;break;case"take":e=gn(e,t+s);break;case"takeRight":t=mn(t,e-s)}}return{start:t,end:e}}(0,i,this.__views__),s=o.start,a=o.end,u=a-s,c=r?a:s-1,l=this.__iteratees__,f=l.length,h=0,p=gn(u,this.__takeCount__);if(!n||!r&&i==u&&p==u)return fi(t,this.__actions__);var d=[];t:for(;u--&&h<p;){for(var _=-1,m=t[c+=e];++_<f;){var g=l[_],v=g.iteratee,y=g.type,w=v(m);if(2==y)m=w;else if(!w){if(1==y)continue t;break t}}d[h++]=m}return d},Cn.prototype.at=ps,Cn.prototype.chain=function(){return fs(this)},Cn.prototype.commit=function(){return new Vn(this.value(),this.__chain__)},Cn.prototype.next=function(){this.__values__===i&&(this.__values__=fa(this.value()));var t=this.__index__>=this.__values__.length;return{done:t,value:t?i:this.__values__[this.__index__++]}},Cn.prototype.plant=function(t){for(var e,n=this;n instanceof Dn;){var r=Co(n);r.__index__=0,r.__values__=i,e?o.__wrapped__=r:e=r;var o=r;n=n.__wrapped__}return o.__wrapped__=t,e},Cn.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof Ln){var e=t;return this.__actions__.length&&(e=new Ln(this)),(e=e.reverse()).__actions__.push({func:hs,args:[Jo],thisArg:i}),new Vn(e,this.__chain__)}return this.thru(Jo)},Cn.prototype.toJSON=Cn.prototype.valueOf=Cn.prototype.value=function(){return fi(this.__wrapped__,this.__actions__)},Cn.prototype.first=Cn.prototype.head,Ht&&(Cn.prototype[Ht]=function(){return this}),Cn}();fe._=dn,(r=function(){return dn}.call(e,n,e,t))===i||(t.exports=r)}.call(this)}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var r={};(()=>{"use strict";n.d(r,{UI:()=>vi,Ji:()=>li,mL:()=>ai,Eh:()=>_i,jO:()=>ui,Lz:()=>wi,sZ:()=>ci,PM:()=>hi});const t=(t,e)=>{const n=new Uint32Array(e);ui.queue.writeBuffer(t,0,n.buffer,0,e.length*Uint32Array.BYTES_PER_ELEMENT)},e=(e,n)=>{const r=new Uint32Array(e),i=ui.createBuffer({size:r.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,label:n});return t(i,e),i},i=(t,e)=>{if(e instanceof Float32Array)ui.queue.writeBuffer(t,0,e.buffer,0,e.length*Float32Array.BYTES_PER_ELEMENT);else{const n=new Float32Array(e);ui.queue.writeBuffer(t,0,n.buffer,0,e.length*Float32Array.BYTES_PER_ELEMENT)}},o=(t,e,n)=>{const r=new Float32Array(e),o=t.createBuffer({size:r.byteLength,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,label:n});return i(o,e),o};let s=1e-6,a=Float32Array;function u(t=0,e=0){const n=new a(2);return void 0!==t&&(n[0]=t,void 0!==e&&(n[1]=e)),n}let c=Float32Array;function l(t,e,n){const r=new c(3);return void 0!==t&&(r[0]=t,void 0!==e&&(r[1]=e,void 0!==n&&(r[2]=n))),r}const f=u;function h(t,e,n){return(n=n||new a(2))[0]=t[0]-e[0],n[1]=t[1]-e[1],n}const p=h;function d(t,e,n){return(n=n||new a(2))[0]=t[0]*e,n[1]=t[1]*e,n}const _=d;function m(t,e){return(e=e||new a(2))[0]=1/t[0],e[1]=1/t[1],e}const g=m;function v(t,e){return t[0]*e[0]+t[1]*e[1]}function y(t){const e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}const w=y;function x(t){const e=t[0],n=t[1];return e*e+n*n}const b=x;function k(t,e){const n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)}const A=k;function M(t,e){const n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r}const T=M;function S(t,e){return(e=e||new a(2))[0]=t[0],e[1]=t[1],e}const E=S;function I(t,e,n){return(n=n||new a(2))[0]=t[0]*e[0],n[1]=t[1]*e[1],n}const P=I;function O(t,e,n){return(n=n||new a(2))[0]=t[0]/e[0],n[1]=t[1]/e[1],n}const U=O;var z=Object.freeze({__proto__:null,create:u,setDefaultType:function(t){const e=a;return a=t,e},fromValues:f,set:function(t,e,n){return(n=n||new a(2))[0]=t,n[1]=e,n},ceil:function(t,e){return(e=e||new a(2))[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e},floor:function(t,e){return(e=e||new a(2))[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e},round:function(t,e){return(e=e||new a(2))[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e},clamp:function(t,e=0,n=1,r){return(r=r||new a(2))[0]=Math.min(n,Math.max(e,t[0])),r[1]=Math.min(n,Math.max(e,t[1])),r},add:function(t,e,n){return(n=n||new a(2))[0]=t[0]+e[0],n[1]=t[1]+e[1],n},addScaled:function(t,e,n,r){return(r=r||new a(2))[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r},angle:function(t,e){const n=t[0],r=t[1],i=t[0],o=t[1],s=Math.sqrt(n*n+r*r)*Math.sqrt(i*i+o*o),a=s&&v(t,e)/s;return Math.acos(a)},subtract:h,sub:p,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<s&&Math.abs(t[1]-e[1])<s},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},lerp:function(t,e,n,r){return(r=r||new a(2))[0]=t[0]+n*(e[0]-t[0]),r[1]=t[1]+n*(e[1]-t[1]),r},lerpV:function(t,e,n,r){return(r=r||new a(2))[0]=t[0]+n[0]*(e[0]-t[0]),r[1]=t[1]+n[1]*(e[1]-t[1]),r},max:function(t,e,n){return(n=n||new a(2))[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n},min:function(t,e,n){return(n=n||new a(2))[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n},mulScalar:d,scale:_,divScalar:function(t,e,n){return(n=n||new a(2))[0]=t[0]/e,n[1]=t[1]/e,n},inverse:m,invert:g,cross:function(t,e,n){n=n||new c(3);const r=t[0]*e[1]-t[1]*e[0];return n[0]=0,n[1]=0,n[2]=r,n},dot:v,length:y,len:w,lengthSq:x,lenSq:b,distance:k,dist:A,distanceSq:M,distSq:T,normalize:function(t,e){e=e||new a(2);const n=t[0],r=t[1],i=Math.sqrt(n*n+r*r);return i>1e-5?(e[0]=n/i,e[1]=r/i):(e[0]=0,e[1]=0),e},negate:function(t,e){return(e=e||new a(2))[0]=-t[0],e[1]=-t[1],e},copy:S,clone:E,multiply:I,mul:P,divide:O,div:U,random:function(t=1,e){e=e||new a(2);const n=2*Math.random()*Math.PI;return e[0]=Math.cos(n)*t,e[1]=Math.sin(n)*t,e},zero:function(t){return(t=t||new a(2))[0]=0,t[1]=0,t},transformMat4:function(t,e,n){n=n||new a(2);const r=t[0],i=t[1];return n[0]=r*e[0]+i*e[4]+e[12],n[1]=r*e[1]+i*e[5]+e[13],n},transformMat3:function(t,e,n){n=n||new a(2);const r=t[0],i=t[1];return n[0]=e[0]*r+e[4]*i+e[8],n[1]=e[1]*r+e[5]*i+e[9],n}});Float32Array;new Map([[Float32Array,()=>new Float32Array(12)],[Float64Array,()=>new Float64Array(12)],[Array,()=>new Array(12).fill(0)]]).get(Float32Array);const B=l;function j(t,e,n){return(n=n||new c(3))[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n}const R=j;function N(t,e,n){return(n=n||new c(3))[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n}const C=N;function q(t,e){return(e=e||new c(3))[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}const D=q;function V(t,e,n){n=n||new c(3);const r=t[2]*e[0]-t[0]*e[2],i=t[0]*e[1]-t[1]*e[0];return n[0]=t[1]*e[2]-t[2]*e[1],n[1]=r,n[2]=i,n}function L(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function F(t){const e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}const G=F;function $(t){const e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}const Y=$;function W(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(n*n+r*r+i*i)}const X=W;function H(t,e){const n=t[0]-e[0],r=t[1]-e[1],i=t[2]-e[2];return n*n+r*r+i*i}const Z=H;function K(t,e){e=e||new c(3);const n=t[0],r=t[1],i=t[2],o=Math.sqrt(n*n+r*r+i*i);return o>1e-5?(e[0]=n/o,e[1]=r/o,e[2]=i/o):(e[0]=0,e[1]=0,e[2]=0),e}function Q(t,e){return(e=e||new c(3))[0]=t[0],e[1]=t[1],e[2]=t[2],e}const J=Q;function tt(t,e,n){return(n=n||new c(3))[0]=t[0]*e[0],n[1]=t[1]*e[1],n[2]=t[2]*e[2],n}const et=tt;function nt(t,e,n){return(n=n||new c(3))[0]=t[0]/e[0],n[1]=t[1]/e[1],n[2]=t[2]/e[2],n}const rt=nt;var it=Object.freeze({__proto__:null,create:l,setDefaultType:function(t){const e=c;return c=t,e},fromValues:B,set:function(t,e,n,r){return(r=r||new c(3))[0]=t,r[1]=e,r[2]=n,r},ceil:function(t,e){return(e=e||new c(3))[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e},floor:function(t,e){return(e=e||new c(3))[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e},round:function(t,e){return(e=e||new c(3))[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e},clamp:function(t,e=0,n=1,r){return(r=r||new c(3))[0]=Math.min(n,Math.max(e,t[0])),r[1]=Math.min(n,Math.max(e,t[1])),r[2]=Math.min(n,Math.max(e,t[2])),r},add:function(t,e,n){return(n=n||new c(3))[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n},addScaled:function(t,e,n,r){return(r=r||new c(3))[0]=t[0]+e[0]*n,r[1]=t[1]+e[1]*n,r[2]=t[2]+e[2]*n,r},angle:function(t,e){const n=t[0],r=t[1],i=t[2],o=t[0],s=t[1],a=t[2],u=Math.sqrt(n*n+r*r+i*i)*Math.sqrt(o*o+s*s+a*a),c=u&&L(t,e)/u;return Math.acos(c)},subtract:j,sub:R,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<s&&Math.abs(t[1]-e[1])<s&&Math.abs(t[2]-e[2])<s},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},lerp:function(t,e,n,r){return(r=r||new c(3))[0]=t[0]+n*(e[0]-t[0]),r[1]=t[1]+n*(e[1]-t[1]),r[2]=t[2]+n*(e[2]-t[2]),r},lerpV:function(t,e,n,r){return(r=r||new c(3))[0]=t[0]+n[0]*(e[0]-t[0]),r[1]=t[1]+n[1]*(e[1]-t[1]),r[2]=t[2]+n[2]*(e[2]-t[2]),r},max:function(t,e,n){return(n=n||new c(3))[0]=Math.max(t[0],e[0]),n[1]=Math.max(t[1],e[1]),n[2]=Math.max(t[2],e[2]),n},min:function(t,e,n){return(n=n||new c(3))[0]=Math.min(t[0],e[0]),n[1]=Math.min(t[1],e[1]),n[2]=Math.min(t[2],e[2]),n},mulScalar:N,scale:C,divScalar:function(t,e,n){return(n=n||new c(3))[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n},inverse:q,invert:D,cross:V,dot:L,length:F,len:G,lengthSq:$,lenSq:Y,distance:W,dist:X,distanceSq:H,distSq:Z,normalize:K,negate:function(t,e){return(e=e||new c(3))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},copy:Q,clone:J,multiply:tt,mul:et,divide:nt,div:rt,random:function(t=1,e){e=e||new c(3);const n=2*Math.random()*Math.PI,r=2*Math.random()-1,i=Math.sqrt(1-r*r)*t;return e[0]=Math.cos(n)*i,e[1]=Math.sin(n)*i,e[2]=r*t,e},zero:function(t){return(t=t||new c(3))[0]=0,t[1]=0,t[2]=0,t},transformMat4:function(t,e,n){n=n||new c(3);const r=t[0],i=t[1],o=t[2],s=e[3]*r+e[7]*i+e[11]*o+e[15]||1;return n[0]=(e[0]*r+e[4]*i+e[8]*o+e[12])/s,n[1]=(e[1]*r+e[5]*i+e[9]*o+e[13])/s,n[2]=(e[2]*r+e[6]*i+e[10]*o+e[14])/s,n},transformMat4Upper3x3:function(t,e,n){n=n||new c(3);const r=t[0],i=t[1],o=t[2];return n[0]=r*e[0]+i*e[4]+o*e[8],n[1]=r*e[1]+i*e[5]+o*e[9],n[2]=r*e[2]+i*e[6]+o*e[10],n},transformMat3:function(t,e,n){n=n||new c(3);const r=t[0],i=t[1],o=t[2];return n[0]=r*e[0]+i*e[4]+o*e[8],n[1]=r*e[1]+i*e[5]+o*e[9],n[2]=r*e[2]+i*e[6]+o*e[10],n},transformQuat:function(t,e,n){n=n||new c(3);const r=e[0],i=e[1],o=e[2],s=2*e[3],a=t[0],u=t[1],l=t[2],f=i*l-o*u,h=o*a-r*l,p=r*u-i*a;return n[0]=a+f*s+2*(i*p-o*h),n[1]=u+h*s+2*(o*f-r*p),n[2]=l+p*s+2*(r*h-i*f),n},getTranslation:function(t,e){return(e=e||new c(3))[0]=t[12],e[1]=t[13],e[2]=t[14],e},getAxis:function(t,e,n){const r=4*e;return(n=n||new c(3))[0]=t[r+0],n[1]=t[r+1],n[2]=t[r+2],n},getScaling:function(t,e){e=e||new c(3);const n=t[0],r=t[1],i=t[2],o=t[4],s=t[5],a=t[6],u=t[8],l=t[9],f=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(o*o+s*s+a*a),e[2]=Math.sqrt(u*u+l*l+f*f),e}});let ot=Float32Array;function st(t,e){return(e=e||new ot(16))[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}const at=st;function ut(t){return(t=t||new ot(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ct(t,e){e=e||new ot(16);const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],_=t[13],m=t[14],g=t[15],v=h*g,y=m*p,w=u*g,x=m*c,b=u*p,k=h*c,A=i*g,M=m*o,T=i*p,S=h*o,E=i*c,I=u*o,P=l*_,O=d*f,U=s*_,z=d*a,B=s*f,j=l*a,R=n*_,N=d*r,C=n*f,q=l*r,D=n*a,V=s*r,L=v*a+x*f+b*_-(y*a+w*f+k*_),F=y*r+A*f+S*_-(v*r+M*f+T*_),G=w*r+M*a+E*_-(x*r+A*a+I*_),$=k*r+T*a+I*f-(b*r+S*a+E*f),Y=1/(n*L+s*F+l*G+d*$);return e[0]=Y*L,e[1]=Y*F,e[2]=Y*G,e[3]=Y*$,e[4]=Y*(y*s+w*l+k*d-(v*s+x*l+b*d)),e[5]=Y*(v*n+M*l+T*d-(y*n+A*l+S*d)),e[6]=Y*(x*n+A*s+I*d-(w*n+M*s+E*d)),e[7]=Y*(b*n+S*s+E*l-(k*n+T*s+I*l)),e[8]=Y*(P*c+z*p+B*g-(O*c+U*p+j*g)),e[9]=Y*(O*o+R*p+q*g-(P*o+N*p+C*g)),e[10]=Y*(U*o+N*c+D*g-(z*o+R*c+V*g)),e[11]=Y*(j*o+C*c+V*p-(B*o+q*c+D*p)),e[12]=Y*(U*h+j*m+O*u-(B*m+P*u+z*h)),e[13]=Y*(C*m+P*i+N*h-(R*h+q*m+O*i)),e[14]=Y*(R*u+V*m+z*i-(D*m+U*i+N*u)),e[15]=Y*(D*h+B*i+q*u-(C*u+V*h+j*i)),e}const lt=ct;function ft(t,e,n){n=n||new ot(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],f=t[8],h=t[9],p=t[10],d=t[11],_=t[12],m=t[13],g=t[14],v=t[15],y=e[0],w=e[1],x=e[2],b=e[3],k=e[4],A=e[5],M=e[6],T=e[7],S=e[8],E=e[9],I=e[10],P=e[11],O=e[12],U=e[13],z=e[14],B=e[15];return n[0]=r*y+a*w+f*x+_*b,n[1]=i*y+u*w+h*x+m*b,n[2]=o*y+c*w+p*x+g*b,n[3]=s*y+l*w+d*x+v*b,n[4]=r*k+a*A+f*M+_*T,n[5]=i*k+u*A+h*M+m*T,n[6]=o*k+c*A+p*M+g*T,n[7]=s*k+l*A+d*M+v*T,n[8]=r*S+a*E+f*I+_*P,n[9]=i*S+u*E+h*I+m*P,n[10]=o*S+c*E+p*I+g*P,n[11]=s*S+l*E+d*I+v*P,n[12]=r*O+a*U+f*z+_*B,n[13]=i*O+u*U+h*z+m*B,n[14]=o*O+c*U+p*z+g*B,n[15]=s*O+l*U+d*z+v*B,n}const ht=ft;let pt,dt,_t;function mt(t,e,n){n=n||new ot(16);let r=t[0],i=t[1],o=t[2];const s=Math.sqrt(r*r+i*i+o*o);r/=s,i/=s,o/=s;const a=r*r,u=i*i,c=o*o,l=Math.cos(e),f=Math.sin(e),h=1-l;return n[0]=a+(1-a)*l,n[1]=r*i*h+o*f,n[2]=r*o*h-i*f,n[3]=0,n[4]=r*i*h-o*f,n[5]=u+(1-u)*l,n[6]=i*o*h+r*f,n[7]=0,n[8]=r*o*h+i*f,n[9]=i*o*h-r*f,n[10]=c+(1-c)*l,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}const gt=mt;function vt(t,e,n,r){r=r||new ot(16);let i=e[0],o=e[1],s=e[2];const a=Math.sqrt(i*i+o*o+s*s);i/=a,o/=a,s/=a;const u=i*i,c=o*o,l=s*s,f=Math.cos(n),h=Math.sin(n),p=1-f,d=u+(1-u)*f,_=i*o*p+s*h,m=i*s*p-o*h,g=i*o*p-s*h,v=c+(1-c)*f,y=o*s*p+i*h,w=i*s*p+o*h,x=o*s*p-i*h,b=l+(1-l)*f,k=t[0],A=t[1],M=t[2],T=t[3],S=t[4],E=t[5],I=t[6],P=t[7],O=t[8],U=t[9],z=t[10],B=t[11];return r[0]=d*k+_*S+m*O,r[1]=d*A+_*E+m*U,r[2]=d*M+_*I+m*z,r[3]=d*T+_*P+m*B,r[4]=g*k+v*S+y*O,r[5]=g*A+v*E+y*U,r[6]=g*M+v*I+y*z,r[7]=g*T+v*P+y*B,r[8]=w*k+x*S+b*O,r[9]=w*A+x*E+b*U,r[10]=w*M+x*I+b*z,r[11]=w*T+x*P+b*B,t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]),r}const yt=vt;var wt=Object.freeze({__proto__:null,setDefaultType:function(t){const e=ot;return ot=t,e},create:function(t,e,n,r,i,o,s,a,u,c,l,f,h,p,d,_){const m=new ot(16);return void 0!==t&&(m[0]=t,void 0!==e&&(m[1]=e,void 0!==n&&(m[2]=n,void 0!==r&&(m[3]=r,void 0!==i&&(m[4]=i,void 0!==o&&(m[5]=o,void 0!==s&&(m[6]=s,void 0!==a&&(m[7]=a,void 0!==u&&(m[8]=u,void 0!==c&&(m[9]=c,void 0!==l&&(m[10]=l,void 0!==f&&(m[11]=f,void 0!==h&&(m[12]=h,void 0!==p&&(m[13]=p,void 0!==d&&(m[14]=d,void 0!==_&&(m[15]=_)))))))))))))))),m},set:function(t,e,n,r,i,o,s,a,u,c,l,f,h,p,d,_,m){return(m=m||new ot(16))[0]=t,m[1]=e,m[2]=n,m[3]=r,m[4]=i,m[5]=o,m[6]=s,m[7]=a,m[8]=u,m[9]=c,m[10]=l,m[11]=f,m[12]=h,m[13]=p,m[14]=d,m[15]=_,m},fromMat3:function(t,e){return(e=e||new ot(16))[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=0,e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},fromQuat:function(t,e){e=e||new ot(16);const n=t[0],r=t[1],i=t[2],o=t[3],s=n+n,a=r+r,u=i+i,c=n*s,l=r*s,f=r*a,h=i*s,p=i*a,d=i*u,_=o*s,m=o*a,g=o*u;return e[0]=1-f-d,e[1]=l+g,e[2]=h-m,e[3]=0,e[4]=l-g,e[5]=1-c-d,e[6]=p+_,e[7]=0,e[8]=h+m,e[9]=p-_,e[10]=1-c-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},negate:function(t,e){return(e=e||new ot(16))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e},copy:st,clone:at,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<s&&Math.abs(t[1]-e[1])<s&&Math.abs(t[2]-e[2])<s&&Math.abs(t[3]-e[3])<s&&Math.abs(t[4]-e[4])<s&&Math.abs(t[5]-e[5])<s&&Math.abs(t[6]-e[6])<s&&Math.abs(t[7]-e[7])<s&&Math.abs(t[8]-e[8])<s&&Math.abs(t[9]-e[9])<s&&Math.abs(t[10]-e[10])<s&&Math.abs(t[11]-e[11])<s&&Math.abs(t[12]-e[12])<s&&Math.abs(t[13]-e[13])<s&&Math.abs(t[14]-e[14])<s&&Math.abs(t[15]-e[15])<s},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},identity:ut,transpose:function(t,e){if((e=e||new ot(16))===t){let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,e}const n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],f=t[9],h=t[10],p=t[11],d=t[12],_=t[13],m=t[14],g=t[15];return e[0]=n,e[1]=s,e[2]=l,e[3]=d,e[4]=r,e[5]=a,e[6]=f,e[7]=_,e[8]=i,e[9]=u,e[10]=h,e[11]=m,e[12]=o,e[13]=c,e[14]=p,e[15]=g,e},inverse:ct,determinant:function(t){const e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],f=t[10],h=t[11],p=t[12],d=t[13],_=t[14],m=t[15],g=f*m,v=_*h,y=a*m,w=_*u,x=a*h,b=f*u,k=r*m,A=_*i,M=r*h,T=f*i,S=r*u,E=a*i;return e*(g*s+w*l+x*d-(v*s+y*l+b*d))+o*(v*n+k*l+T*d-(g*n+A*l+M*d))+c*(y*n+A*s+S*d-(w*n+k*s+E*d))+p*(b*n+M*s+E*l-(x*n+T*s+S*l))},invert:lt,multiply:ft,mul:ht,setTranslation:function(t,e,n){return t!==(n=n||ut())&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11]),n[12]=e[0],n[13]=e[1],n[14]=e[2],n[15]=1,n},getTranslation:function(t,e){return(e=e||l())[0]=t[12],e[1]=t[13],e[2]=t[14],e},getAxis:function(t,e,n){const r=4*e;return(n=n||l())[0]=t[r+0],n[1]=t[r+1],n[2]=t[r+2],n},setAxis:function(t,e,n,r){r!==t&&(r=st(t,r));const i=4*n;return r[i+0]=e[0],r[i+1]=e[1],r[i+2]=e[2],r},getScaling:function(t,e){e=e||l();const n=t[0],r=t[1],i=t[2],o=t[4],s=t[5],a=t[6],u=t[8],c=t[9],f=t[10];return e[0]=Math.sqrt(n*n+r*r+i*i),e[1]=Math.sqrt(o*o+s*s+a*a),e[2]=Math.sqrt(u*u+c*c+f*f),e},perspective:function(t,e,n,r,i){i=i||new ot(16);const o=Math.tan(.5*Math.PI-.5*t);if(i[0]=o/e,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,r===1/0)i[10]=-1,i[14]=-n;else{const t=1/(n-r);i[10]=r*t,i[14]=r*n*t}return i},ortho:function(t,e,n,r,i,o,s){return(s=s||new ot(16))[0]=2/(e-t),s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/(r-n),s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1/(i-o),s[11]=0,s[12]=(e+t)/(t-e),s[13]=(r+n)/(n-r),s[14]=i/(i-o),s[15]=1,s},frustum:function(t,e,n,r,i,o,s){const a=e-t,u=r-n,c=i-o;return(s=s||new ot(16))[0]=2*i/a,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*i/u,s[6]=0,s[7]=0,s[8]=(t+e)/a,s[9]=(r+n)/u,s[10]=o/c,s[11]=-1,s[12]=0,s[13]=0,s[14]=i*o/c,s[15]=0,s},aim:function(t,e,n,r){return r=r||new ot(16),pt=pt||l(),dt=dt||l(),_t=_t||l(),K(j(e,t,_t),_t),K(V(n,_t,pt),pt),K(V(_t,pt,dt),dt),r[0]=pt[0],r[1]=pt[1],r[2]=pt[2],r[3]=0,r[4]=dt[0],r[5]=dt[1],r[6]=dt[2],r[7]=0,r[8]=_t[0],r[9]=_t[1],r[10]=_t[2],r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},cameraAim:function(t,e,n,r){return r=r||new ot(16),pt=pt||l(),dt=dt||l(),_t=_t||l(),K(j(t,e,_t),_t),K(V(n,_t,pt),pt),K(V(_t,pt,dt),dt),r[0]=pt[0],r[1]=pt[1],r[2]=pt[2],r[3]=0,r[4]=dt[0],r[5]=dt[1],r[6]=dt[2],r[7]=0,r[8]=_t[0],r[9]=_t[1],r[10]=_t[2],r[11]=0,r[12]=t[0],r[13]=t[1],r[14]=t[2],r[15]=1,r},lookAt:function(t,e,n,r){return r=r||new ot(16),pt=pt||l(),dt=dt||l(),_t=_t||l(),K(j(t,e,_t),_t),K(V(n,_t,pt),pt),K(V(_t,pt,dt),dt),r[0]=pt[0],r[1]=dt[0],r[2]=_t[0],r[3]=0,r[4]=pt[1],r[5]=dt[1],r[6]=_t[1],r[7]=0,r[8]=pt[2],r[9]=dt[2],r[10]=_t[2],r[11]=0,r[12]=-(pt[0]*t[0]+pt[1]*t[1]+pt[2]*t[2]),r[13]=-(dt[0]*t[0]+dt[1]*t[1]+dt[2]*t[2]),r[14]=-(_t[0]*t[0]+_t[1]*t[1]+_t[2]*t[2]),r[15]=1,r},translation:function(t,e){return(e=e||new ot(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},translate:function(t,e,n){n=n||new ot(16);const r=e[0],i=e[1],o=e[2],s=t[0],a=t[1],u=t[2],c=t[3],l=t[4],f=t[5],h=t[6],p=t[7],d=t[8],_=t[9],m=t[10],g=t[11],v=t[12],y=t[13],w=t[14],x=t[15];return t!==n&&(n[0]=s,n[1]=a,n[2]=u,n[3]=c,n[4]=l,n[5]=f,n[6]=h,n[7]=p,n[8]=d,n[9]=_,n[10]=m,n[11]=g),n[12]=s*r+l*i+d*o+v,n[13]=a*r+f*i+_*o+y,n[14]=u*r+h*i+m*o+w,n[15]=c*r+p*i+g*o+x,n},rotationX:function(t,e){e=e||new ot(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotateX:function(t,e,n){n=n||new ot(16);const r=t[4],i=t[5],o=t[6],s=t[7],a=t[8],u=t[9],c=t[10],l=t[11],f=Math.cos(e),h=Math.sin(e);return n[4]=f*r+h*a,n[5]=f*i+h*u,n[6]=f*o+h*c,n[7]=f*s+h*l,n[8]=f*a-h*r,n[9]=f*u-h*i,n[10]=f*c-h*o,n[11]=f*l-h*s,t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},rotationY:function(t,e){e=e||new ot(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotateY:function(t,e,n){n=n||new ot(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[8],u=t[9],c=t[10],l=t[11],f=Math.cos(e),h=Math.sin(e);return n[0]=f*r-h*a,n[1]=f*i-h*u,n[2]=f*o-h*c,n[3]=f*s-h*l,n[8]=f*a+h*r,n[9]=f*u+h*i,n[10]=f*c+h*o,n[11]=f*l+h*s,t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},rotationZ:function(t,e){e=e||new ot(16);const n=Math.cos(t),r=Math.sin(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},rotateZ:function(t,e,n){n=n||new ot(16);const r=t[0],i=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],f=Math.cos(e),h=Math.sin(e);return n[0]=f*r+h*a,n[1]=f*i+h*u,n[2]=f*o+h*c,n[3]=f*s+h*l,n[4]=f*a-h*r,n[5]=f*u-h*i,n[6]=f*c-h*o,n[7]=f*l-h*s,t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},axisRotation:mt,rotation:gt,axisRotate:vt,rotate:yt,scaling:function(t,e){return(e=e||new ot(16))[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},scale:function(t,e,n){n=n||new ot(16);const r=e[0],i=e[1],o=e[2];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=r*t[3],n[4]=i*t[4],n[5]=i*t[5],n[6]=i*t[6],n[7]=i*t[7],n[8]=o*t[8],n[9]=o*t[9],n[10]=o*t[10],n[11]=o*t[11],t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n},uniformScaling:function(t,e){return(e=e||new ot(16))[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},uniformScale:function(t,e,n){return(n=n||new ot(16))[0]=e*t[0],n[1]=e*t[1],n[2]=e*t[2],n[3]=e*t[3],n[4]=e*t[4],n[5]=e*t[5],n[6]=e*t[6],n[7]=e*t[7],n[8]=e*t[8],n[9]=e*t[9],n[10]=e*t[10],n[11]=e*t[11],t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n}});let xt=Float32Array;function bt(t,e,n,r){const i=new xt(4);return void 0!==t&&(i[0]=t,void 0!==e&&(i[1]=e,void 0!==n&&(i[2]=n,void 0!==r&&(i[3]=r)))),i}const kt=bt;function At(t,e,n){n=n||new xt(4);const r=.5*e,i=Math.sin(r);return n[0]=i*t[0],n[1]=i*t[1],n[2]=i*t[2],n[3]=Math.cos(r),n}function Mt(t,e,n){n=n||new xt(4);const r=t[0],i=t[1],o=t[2],s=t[3],a=e[0],u=e[1],c=e[2],l=e[3];return n[0]=r*l+s*a+i*c-o*u,n[1]=i*l+s*u+o*a-r*c,n[2]=o*l+s*c+r*u-i*a,n[3]=s*l-r*a-i*u-o*c,n}const Tt=Mt;function St(t,e,n,r){r=r||new xt(4);const i=t[0],o=t[1],a=t[2],u=t[3];let c,l,f=e[0],h=e[1],p=e[2],d=e[3],_=i*f+o*h+a*p+u*d;if(_<0&&(_=-_,f=-f,h=-h,p=-p,d=-d),1-_>s){const t=Math.acos(_),e=Math.sin(t);c=Math.sin((1-n)*t)/e,l=Math.sin(n*t)/e}else c=1-n,l=n;return r[0]=c*i+l*f,r[1]=c*o+l*h,r[2]=c*a+l*p,r[3]=c*u+l*d,r}function Et(t,e){return(e=e||new xt(4))[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}const It=Et;function Pt(t,e,n){return(n=n||new xt(4))[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n}const Ot=Pt;function Ut(t,e,n){return(n=n||new xt(4))[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n}const zt=Ut;function Bt(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function jt(t){const e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}const Rt=jt;function Nt(t){const e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}const Ct=Nt;function qt(t,e){e=e||new xt(4);const n=t[0],r=t[1],i=t[2],o=t[3],s=Math.sqrt(n*n+r*r+i*i+o*o);return s>1e-5?(e[0]=n/s,e[1]=r/s,e[2]=i/s,e[3]=o/s):(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}let Dt,Vt,Lt,Ft,Gt;var $t=Object.freeze({__proto__:null,create:bt,setDefaultType:function(t){const e=xt;return xt=t,e},fromValues:kt,set:function(t,e,n,r,i){return(i=i||new xt(4))[0]=t,i[1]=e,i[2]=n,i[3]=r,i},fromAxisAngle:At,toAxisAngle:function(t,e){e=e||l(4);const n=2*Math.acos(t[3]),r=Math.sin(.5*n);return r>s?(e[0]=t[0]/r,e[1]=t[1]/r,e[2]=t[2]/r):(e[0]=1,e[1]=0,e[2]=0),{angle:n,axis:e}},angle:function(t,e){const n=Bt(t,e);return Math.acos(2*n*n-1)},multiply:Mt,mul:Tt,rotateX:function(t,e,n){n=n||new xt(4);const r=.5*e,i=t[0],o=t[1],s=t[2],a=t[3],u=Math.sin(r),c=Math.cos(r);return n[0]=i*c+a*u,n[1]=o*c+s*u,n[2]=s*c-o*u,n[3]=a*c-i*u,n},rotateY:function(t,e,n){n=n||new xt(4);const r=.5*e,i=t[0],o=t[1],s=t[2],a=t[3],u=Math.sin(r),c=Math.cos(r);return n[0]=i*c-s*u,n[1]=o*c+a*u,n[2]=s*c+i*u,n[3]=a*c-o*u,n},rotateZ:function(t,e,n){n=n||new xt(4);const r=.5*e,i=t[0],o=t[1],s=t[2],a=t[3],u=Math.sin(r),c=Math.cos(r);return n[0]=i*c+o*u,n[1]=o*c-i*u,n[2]=s*c+a*u,n[3]=a*c-s*u,n},slerp:St,inverse:function(t,e){e=e||new xt(4);const n=t[0],r=t[1],i=t[2],o=t[3],s=n*n+r*r+i*i+o*o,a=s?1/s:0;return e[0]=-n*a,e[1]=-r*a,e[2]=-i*a,e[3]=o*a,e},conjugate:function(t,e){return(e=e||new xt(4))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},fromMat:function(t,e){e=e||new xt(4);const n=t[0]+t[5]+t[10];if(n>0){const r=Math.sqrt(n+1);e[3]=.5*r;const i=.5/r;e[0]=(t[6]-t[9])*i,e[1]=(t[8]-t[2])*i,e[2]=(t[1]-t[4])*i}else{let n=0;t[5]>t[0]&&(n=1),t[10]>t[4*n+n]&&(n=2);const r=(n+1)%3,i=(n+2)%3,o=Math.sqrt(t[4*n+n]-t[4*r+r]-t[4*i+i]+1);e[n]=.5*o;const s=.5/o;e[3]=(t[4*r+i]-t[4*i+r])*s,e[r]=(t[4*r+n]+t[4*n+r])*s,e[i]=(t[4*i+n]+t[4*n+i])*s}return e},fromEuler:function(t,e,n,r,i){i=i||new xt(4);const o=.5*t,s=.5*e,a=.5*n,u=Math.sin(o),c=Math.cos(o),l=Math.sin(s),f=Math.cos(s),h=Math.sin(a),p=Math.cos(a);switch(r){case"xyz":i[0]=u*f*p+c*l*h,i[1]=c*l*p-u*f*h,i[2]=c*f*h+u*l*p,i[3]=c*f*p-u*l*h;break;case"xzy":i[0]=u*f*p-c*l*h,i[1]=c*l*p-u*f*h,i[2]=c*f*h+u*l*p,i[3]=c*f*p+u*l*h;break;case"yxz":i[0]=u*f*p+c*l*h,i[1]=c*l*p-u*f*h,i[2]=c*f*h-u*l*p,i[3]=c*f*p+u*l*h;break;case"yzx":i[0]=u*f*p+c*l*h,i[1]=c*l*p+u*f*h,i[2]=c*f*h-u*l*p,i[3]=c*f*p-u*l*h;break;case"zxy":i[0]=u*f*p-c*l*h,i[1]=c*l*p+u*f*h,i[2]=c*f*h+u*l*p,i[3]=c*f*p-u*l*h;break;case"zyx":i[0]=u*f*p-c*l*h,i[1]=c*l*p+u*f*h,i[2]=c*f*h-u*l*p,i[3]=c*f*p+u*l*h;break;default:throw new Error(`Unknown rotation order: ${r}`)}return i},copy:Et,clone:It,add:function(t,e,n){return(n=n||new xt(4))[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n},subtract:Pt,sub:Ot,mulScalar:Ut,scale:zt,divScalar:function(t,e,n){return(n=n||new xt(4))[0]=t[0]/e,n[1]=t[1]/e,n[2]=t[2]/e,n[3]=t[3]/e,n},dot:Bt,lerp:function(t,e,n,r){return(r=r||new xt(4))[0]=t[0]+n*(e[0]-t[0]),r[1]=t[1]+n*(e[1]-t[1]),r[2]=t[2]+n*(e[2]-t[2]),r[3]=t[3]+n*(e[3]-t[3]),r},length:jt,len:Rt,lengthSq:Nt,lenSq:Ct,normalize:qt,equalsApproximately:function(t,e){return Math.abs(t[0]-e[0])<s&&Math.abs(t[1]-e[1])<s&&Math.abs(t[2]-e[2])<s&&Math.abs(t[3]-e[3])<s},equals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},identity:function(t){return(t=t||new xt(4))[0]=0,t[1]=0,t[2]=0,t[3]=1,t},rotationTo:function(t,e,n){n=n||new xt(4),Dt=Dt||l(),Vt=Vt||l(1,0,0),Lt=Lt||l(0,1,0);const r=L(t,e);return r<-.999999?(V(Vt,t,Dt),G(Dt)<1e-6&&V(Lt,t,Dt),K(Dt,Dt),At(Dt,Math.PI,n),n):r>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(V(t,e,Dt),n[0]=Dt[0],n[1]=Dt[1],n[2]=Dt[2],n[3]=1+r,qt(n,n))},sqlerp:function(t,e,n,r,i,o){return o=o||new xt(4),Ft=Ft||new xt(4),Gt=Gt||new xt(4),St(t,r,i,Ft),St(e,n,i,Gt),St(Ft,Gt,2*i*(1-i),o),o}});Float32Array;const Yt={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},Wt=t=>1e3*t,Xt=t=>t/1e3,Ht=()=>{},Zt=t=>t;function Kt(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}const Qt=t=>t(),Jt=(t,e,n=Yt.duration)=>new Proxy({animations:t.map(Qt).filter(Boolean),duration:n,options:e},te),te={get:(t,e)=>{const n=t.animations[0];switch(e){case"duration":return t.duration;case"currentTime":return Xt((null==n?void 0:n[e])||0);case"playbackRate":case"playState":return null==n?void 0:n[e];case"finished":return t.finished||(t.finished=Promise.all(t.animations.map(ee)).catch(Ht)),t.finished;case"stop":return()=>{t.animations.forEach((t=>Kt(t)))};case"forEachNative":return e=>{t.animations.forEach((n=>e(n,t)))};default:return void 0===(null==n?void 0:n[e])?void 0:()=>t.animations.forEach((t=>t[e]()))}},set:(t,e,n)=>{switch(e){case"currentTime":n=Wt(n);case"playbackRate":for(let r=0;r<t.animations.length;r++)t.animations[r][e]=n;return!0}return!1}},ee=t=>t.finished,ne=t=>"object"==typeof t&&Boolean(t.createAnimation),re=t=>"number"==typeof t,ie=t=>Array.isArray(t)&&!re(t[0]),oe=(t,e,n)=>-n*t+n*e+t,se=(t,e,n)=>e-t==0?1:(n-t)/(e-t);function ae(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const i=se(0,e,r);t.push(oe(n,1,i))}}const ue=(t,e,n)=>Math.min(Math.max(n,t),e);const ce=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,le=1e-7,fe=12;function he(t,e,n,r){if(t===e&&n===r)return Zt;return i=>0===i||1===i?i:ce(function(t,e,n,r,i){let o,s,a=0;do{s=e+(n-e)/2,o=ce(s,r,i)-t,o>0?n=s:e=s}while(Math.abs(o)>le&&++a<fe);return s}(i,0,1,t,n),e,r)}const pe=t=>"function"==typeof t,de=t=>Array.isArray(t)&&re(t[0]),_e={ease:he(.25,.1,.25,1),"ease-in":he(.42,0,1,1),"ease-in-out":he(.42,0,.58,1),"ease-out":he(0,0,.58,1)},me=/\((.*?)\)/;function ge(t){if(pe(t))return t;if(de(t))return he(...t);if(_e[t])return _e[t];if(t.startsWith("steps")){const e=me.exec(t);if(e){const t=e[1].split(",");return((t,e="end")=>n=>{const r=(n="end"===e?Math.min(n,.999):Math.max(n,.001))*t,i="end"===e?Math.floor(r):Math.ceil(r);return ue(0,1,i/t)})(parseFloat(t[0]),t[1].trim())}}return Zt}class ve{constructor(t,e=[0,1],{easing:n,duration:r=Yt.duration,delay:i=Yt.delay,endDelay:o=Yt.endDelay,repeat:s=Yt.repeat,offset:a,direction:u="normal",autoplay:c=!0}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=Zt,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),n=n||Yt.easing,ne(n)){const t=n.createAnimation(e);n=t.easing,e=t.keyframes||e,r=t.duration||r}this.repeat=s,this.easing=ie(n)?Zt:ge(n),this.updateDuration(r);const l=function(t,e=function(t){const e=[0];return ae(e,t-1),e}(t.length),n=Zt){const r=t.length,i=r-e.length;return i>0&&ae(e,i),i=>{let o=0;for(;o<r-2&&!(i<e[o+1]);o++);let s=ue(0,1,se(e[o],e[o+1],i));const a=function(t,e){return ie(t)?t[((t,e,n)=>{const r=e-t;return((n-t)%r+r)%r+t})(0,t.length,e)]:t}(n,o);return s=a(s),oe(t[o],t[o+1],s)}}(e,a,ie(n)?n.map(ge):Zt);this.tick=e=>{var n;let r=0;r=void 0!==this.pauseTime?this.pauseTime:(e-this.startTime)*this.rate,this.t=r,r/=1e3,r=Math.max(r-i,0),"finished"===this.playState&&void 0===this.pauseTime&&(r=this.totalDuration);const s=r/this.duration;let a=Math.floor(s),c=s%1;!c&&s>=1&&(c=1),1===c&&a--;const f=a%2;("reverse"===u||"alternate"===u&&f||"alternate-reverse"===u&&!f)&&(c=1-c);const h=r>=this.totalDuration?1:Math.min(c,1),p=l(this.easing(h));t(p),void 0===this.pauseTime&&("finished"===this.playState||r>=this.totalDuration+o)?(this.playState="finished",null===(n=this.resolve)||void 0===n||n.call(this,p)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},c&&this.play()}play(){const t=performance.now();this.playState="running",void 0!==this.pauseTime?this.startTime=t-this.pauseTime:this.startTime||(this.startTime=t),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var t;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(t=this.reject)||void 0===t||t.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(t){this.duration=t,this.totalDuration=t*(this.repeat+1)}get currentTime(){return this.t}set currentTime(t){void 0!==this.pauseTime||0===this.rate?this.pauseTime=t:this.startTime=performance.now()-t/this.rate}get playbackRate(){return this.rate}set playbackRate(t){this.rate=t}}class ye{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const we=new WeakMap;function xe(t){return we.has(t)||we.set(t,{transforms:[],values:new Map}),we.get(t)}const be=["","X","Y","Z"],ke={x:"translateX",y:"translateY",z:"translateZ"},Ae={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},Me={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:Ae,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:Zt},skew:Ae},Te=new Map,Se=t=>`--motion-${t}`,Ee=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{be.forEach((e=>{Ee.push(t+e),Te.set(Se(t+e),Me[t])}))}));const Ie=(t,e)=>Ee.indexOf(t)-Ee.indexOf(e),Pe=new Set(Ee),Oe=t=>Pe.has(t),Ue=t=>t.sort(Ie).reduce(ze,"").trim(),ze=(t,e)=>`${t} ${e}(var(${Se(e)}))`,Be=t=>t.startsWith("--"),je=new Set,Re=(t,e)=>document.createElement("div").animate(t,e),Ne={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{Re({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(Re({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{Re({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}},Ce={},qe={};for(const t in Ne)qe[t]=()=>(void 0===Ce[t]&&(Ce[t]=Ne[t]()),Ce[t]);const De=(t,e)=>pe(t)?qe.linearEasing()?`linear(${((t,e)=>{let n="";const r=Math.round(e/.015);for(let e=0;e<r;e++)n+=t(se(0,r-1,e))+", ";return n.substring(0,n.length-2)})(t,e)})`:Yt.easing:de(t)?Ve(t):t,Ve=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`;function Le(t){return ke[t]&&(t=ke[t]),Oe(t)?Se(t):t}const Fe=(t,e)=>{e=Le(e);let n=Be(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!n&&0!==n){const t=Te.get(e);t&&(n=t.initialValue)}return n},Ge=(t,e,n)=>{e=Le(e),Be(e)?t.style.setProperty(e,n):t.style[e]=n},$e=t=>"string"==typeof t;function Ye(t,e){var n;let r=(null==e?void 0:e.toDefaultUnit)||Zt;const i=t[t.length-1];if($e(i)){const t=(null===(n=i.match(/(-?[\d.]+)([a-z%]*)/))||void 0===n?void 0:n[2])||"";t&&(r=e=>e+t)}return r}function We(t,e,n,r={},i){const o=window.__MOTION_DEV_TOOLS_RECORD,s=!1!==r.record&&o;let a,{duration:u=Yt.duration,delay:c=Yt.delay,endDelay:l=Yt.endDelay,repeat:f=Yt.repeat,easing:h=Yt.easing,persist:p=!1,direction:d,offset:_,allowWebkitAcceleration:m=!1,autoplay:g=!0}=r;const v=xe(t),y=Oe(e);let w=qe.waapi();y&&((t,e)=>{ke[e]&&(e=ke[e]);const{transforms:n}=xe(t);var r,i;i=e,-1===(r=n).indexOf(i)&&r.push(i),t.style.transform=Ue(n)})(t,e);const x=Le(e),b=function(t,e){return t.has(e)||t.set(e,new ye),t.get(e)}(v.values,x),k=Te.get(x);return Kt(b.animation,!(ne(h)&&b.generator)&&!1!==r.record),()=>{const v=()=>{var e,n;return null!==(n=null!==(e=Fe(t,x))&&void 0!==e?e:null==k?void 0:k.initialValue)&&void 0!==n?n:0};let A=function(t,e){for(let n=0;n<t.length;n++)null===t[n]&&(t[n]=n?t[n-1]:e());return t}((t=>Array.isArray(t)?t:[t])(n),v);const M=Ye(A,k);if(ne(h)){const t=h.createAnimation(A,"opacity"!==e,v,x,b);h=t.easing,A=t.keyframes||A,u=t.duration||u}if(Be(x)&&(qe.cssRegisterProperty()?function(t){if(!je.has(t)){je.add(t);try{const{syntax:e,initialValue:n}=Te.has(t)?Te.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:n})}catch(t){}}}(x):w=!1),y&&!qe.linearEasing()&&(pe(h)||ie(h)&&h.some(pe))&&(w=!1),w){k&&(A=A.map((t=>re(t)?k.toDefaultUnit(t):t))),1!==A.length||qe.partialKeyframes()&&!s||A.unshift(v());const e={delay:Wt(c),duration:Wt(u),endDelay:Wt(l),easing:ie(h)?void 0:De(h,u),direction:d,iterations:f+1,fill:"both"};a=t.animate({[x]:A,offset:_,easing:ie(h)?h.map((t=>De(t,u))):void 0},e),a.finished||(a.finished=new Promise(((t,e)=>{a.onfinish=t,a.oncancel=e})));const n=A[A.length-1];a.finished.then((()=>{p||(Ge(t,x,n),a.cancel())})).catch(Ht),m||(a.playbackRate=1.000001)}else if(i&&y)A=A.map((t=>"string"==typeof t?parseFloat(t):t)),1===A.length&&A.unshift(parseFloat(v())),a=new i((e=>{Ge(t,x,M?M(e):e)}),A,Object.assign(Object.assign({},r),{duration:u,easing:h}));else{const e=A[A.length-1];Ge(t,x,k&&re(e)?k.toDefaultUnit(e):e)}return s&&o(t,e,A,{duration:u,delay:c,easing:h,repeat:f,offset:_},"motion-one"),b.setAnimation(a),a&&!g&&a.pause(),a}}const Xe=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);function He(t,e,n){return pe(t)?t(e,n):t}const Ze=(Ke=ve,function(t,e,n={}){const r=(t=function(t,e){return"string"==typeof t?t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}(t)).length;Boolean(r),Boolean(e);const i=[];for(let o=0;o<r;o++){const s=t[o];for(const t in e){const a=Xe(n,t);a.delay=He(a.delay,o,r);const u=We(s,t,e[t],a,Ke);i.push(u)}}return Jt(i,n,n.duration)});var Ke;function Qe(t,e={}){return Jt([()=>{const n=new ve(t,[0,1],e);return n.finished.catch((()=>{})),n}],e,e.duration)}function Je(t,e,n){return(pe(t)?Qe:Ze)(t,e,n)}function tn(t,e,n){const r=Math.max(e-5,0);return i=n-t(r),(o=e-r)?i*(1e3/o):0;var i,o}function en(t){return re(t)&&!isNaN(t)}function nn(t){return $e(t)?parseFloat(t):t}const rn=function(t){const e=new WeakMap;return(t={})=>{const n=new Map,r=(e=0,r=100,i=0,o=!1)=>{const s=`${e}-${r}-${i}-${o}`;return n.has(s)||n.set(s,(({from:t=0,velocity:e=0,power:n=.8,decay:r=.325,bounceDamping:i,bounceStiffness:o,changeTarget:s,min:a,max:u,restDistance:c=.5,restSpeed:l})=>{r=Wt(r);const f={hasReachedTarget:!1,done:!1,current:t,target:t},h=t=>void 0===a?u:void 0===u||Math.abs(a-t)<Math.abs(u-t)?a:u;let p=n*e;const d=t+p,_=void 0===s?d:s(d);f.target=_,_!==d&&(p=_-t);const m=t=>-p*Math.exp(-t/r),g=t=>_+m(t),v=t=>{const e=m(t),n=g(t);f.done=Math.abs(e)<=c,f.current=f.done?_:n};let y,w;const x=t=>{var e;e=f.current,(void 0!==a&&e<a||void 0!==u&&e>u)&&(y=t,w=(({stiffness:t=100,damping:e=10,mass:n=1,from:r=0,to:i=1,velocity:o=0,restSpeed:s,restDistance:a}={})=>{o=o?Xt(o):0;const u={done:!1,hasReachedTarget:!1,current:r,target:i},c=i-r,l=Math.sqrt(t/n)/1e3,f=((t=100,e=10,n=1)=>e/(2*Math.sqrt(t*n)))(t,e,n),h=Math.abs(c)<5;let p;if(s||(s=h?.01:2),a||(a=h?.005:.5),f<1){const t=l*Math.sqrt(1-f*f);p=e=>i-Math.exp(-f*l*e)*((f*l*c-o)/t*Math.sin(t*e)+c*Math.cos(t*e))}else p=t=>i-Math.exp(-l*t)*(c+(l*c-o)*t);return t=>{u.current=p(t);const e=0===t?o:tn(p,t,u.current),n=Math.abs(e)<=s,c=Math.abs(i-u.current)<=a;var l,f,h;return u.done=n&&c,u.hasReachedTarget=(l=r,f=i,h=u.current,l<f&&h>=f||l>f&&h<=f),u}})({from:f.current,to:h(f.current),velocity:tn(g,t,f.current),damping:i,stiffness:o,restDistance:c,restSpeed:l}))};return x(0),t=>{let e=!1;return w||void 0!==y||(e=!0,v(t),x(t)),void 0!==y&&t>y?(f.hasReachedTarget=!0,w(t-y)):(f.hasReachedTarget=!1,!e&&v(t),f)}})(Object.assign({from:e,to:r,velocity:i},t))),n.get(s)},i=(t,n)=>(e.has(t)||e.set(t,function(t,e=Zt){let n,r=10,i=t(0);const o=[e(i.current)];for(;!i.done&&r<1e4;)i=t(r),o.push(e(i.done?i.target:i.current)),void 0===n&&i.hasReachedTarget&&(n=r),r+=10;const s=r-10;return 1===o.length&&o.push(i.current),{keyframes:o,duration:s/1e3,overshootDuration:(null!=n?n:s)/1e3}}(t,n)),e.get(t));return{createAnimation:(t,e=!0,n,o,s)=>{let a,u,c,l=0,f=Zt;const h=t.length;if(e)if(f=Ye(t,o?Te.get(Le(o)):void 0),c=nn(t[h-1]),h>1&&null!==t[0])u=nn(t[0]);else{const t=null==s?void 0:s.generator;if(t){const{animation:e,generatorStartTime:n}=s,r=(null==e?void 0:e.startTime)||n||0,i=(null==e?void 0:e.currentTime)||performance.now()-r,o=t(i).current;u=o,l=tn((e=>t(e).current),i,o)}else n&&(u=nn(n()))}if(en(u)&&en(c)){const t=r(u,c,l,null==o?void 0:o.includes("scale"));a=Object.assign(Object.assign({},i(t,f)),{easing:"linear"}),s&&(s.generator=t,s.generatorStartTime=performance.now())}return a||(a={easing:"ease",duration:i(r(0,100)).overshootDuration}),a}}}}();class on{position;targetPosition;rotation;targetRotation;scale;targetScale;constructor(t){this.position=t.position,this.rotation=t.rotation,this.targetPosition=this.position,this.targetRotation=this.rotation,this.scale=it.create(1,1,1),this.targetScale=this.scale}update(){Je((t=>{this.position=it.lerp(this.position,this.targetPosition,t)}),{easing:rn({velocity:2e-4*_i})}),Je((t=>{this.rotation=$t.slerp(this.rotation,this.targetRotation,t)}),{easing:rn({velocity:2e-4*_i})}),Je((t=>{this.scale=it.lerp(this.scale,this.targetScale,t)}),{easing:rn({velocity:2e-4*_i})})}}const sn=new class{pressed={w:!1,a:!1,s:!1,d:!1,q:!1,e:!1," ":!1,shift:!1};constructor(){window.addEventListener("keydown",(t=>{const e=t.key.toLowerCase();this.pressed[e]=!0})),window.addEventListener("keyup",(t=>{const e=t.key.toLowerCase();this.pressed[e]=!1})),window.addEventListener("blur",(()=>{Object.keys(this.pressed).forEach((t=>{this.pressed[t]=!1}))}))}},an=async t=>{const e=t.createShaderModule({code:"@group(0) @binding(0) var mySampler : sampler;\r\n@group(0) @binding(1) var myTexture : texture_2d<f32>;\r\n//@group(0) @binding(2) var debugTexture : texture_2d<f32>;\r\n\r\nstruct VertexOutput {\r\n  @builtin(position) Position : vec4<f32>,\r\n  @location(0) fragUV : vec2<f32>,\r\n}\r\n\r\n@vertex\r\nfn vertex_main(@builtin(vertex_index) VertexIndex : u32) -> VertexOutput {\r\n  const pos = array(\r\n    vec2( 1.0,  1.0),\r\n    vec2( 1.0, -1.0),\r\n    vec2(-1.0, -1.0),\r\n    vec2( 1.0,  1.0),\r\n    vec2(-1.0, -1.0),\r\n    vec2(-1.0,  1.0),\r\n  );\r\n\r\n  const uv = array(\r\n    vec2(1.0, 0.0),\r\n    vec2(1.0, 1.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(1.0, 0.0),\r\n    vec2(0.0, 1.0),\r\n    vec2(0.0, 0.0),\r\n  );\r\n\r\n  var output : VertexOutput;\r\n  output.Position = vec4(pos[VertexIndex], 0.0, 1.0);\r\n  output.fragUV = uv[VertexIndex];\r\n  return output;\r\n}\r\n\r\nfn get_debug_colour(index : i32) -> vec4<f32> {\r\n  let colours = array(\r\n    vec4<f32>(1.0, 0.0, 0.0, 1.0),\r\n    vec4<f32>(0.0, 1.0, 0.0, 1.0),\r\n    vec4<f32>(0.0, 0.0, 1.0, 1.0),\r\n    vec4<f32>(1.0, 1.0, 0.0, 1.0),\r\n    vec4<f32>(1.0, 0.0, 1.0, 1.0),\r\n    vec4<f32>(0.0, 1.0, 1.0, 1.0),\r\n    vec4<f32>(1.0, 1.0, 1.0, 1.0),\r\n    vec4<f32>(0.0, 0.0, 0.0, 1.0),\r\n  );\r\n  return colours[index % 8];\r\n}\r\n\r\n@fragment\r\nfn fragment_main(@location(0) fragUV : vec2<f32>) -> @location(0) vec4<f32> {\r\n    let pixel = fragUV * vec2<f32>(textureDimensions(myTexture));\r\n    return textureLoad(myTexture, vec2<u32>(pixel),0);\r\n}\r\n"}),n=t.createRenderPipeline({layout:"auto",vertex:{module:e,entryPoint:"vertex_main"},fragment:{module:e,entryPoint:"fragment_main",targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]}});return{render:e=>{const r=e.commandEncoder.beginRenderPass({timestampWrites:e.timestampWrites,colorAttachments:[{view:ci.getCurrentTexture().createView(),loadOp:"clear",clearValue:[.3,.3,.3,1],storeOp:"store"}]}),i=t.createBindGroup({layout:n.getBindGroupLayout(0),entries:[{binding:1,resource:e.outputTextures.finalTexture.createView()}]});return r.setPipeline(n),r.setBindGroup(0,i),r.draw(6),r.end(),[e.commandEncoder.finish()]},label:"fullscreen quad"}},un=t=>t&&"number"==typeof t.length&&t.buffer instanceof ArrayBuffer&&"number"==typeof t.byteLength,cn={i32:{numElements:1,align:4,size:4,type:"i32",View:Int32Array},u32:{numElements:1,align:4,size:4,type:"u32",View:Uint32Array},f32:{numElements:1,align:4,size:4,type:"f32",View:Float32Array},f16:{numElements:1,align:2,size:2,type:"u16",View:Uint16Array},vec2f:{numElements:2,align:8,size:8,type:"f32",View:Float32Array},vec2i:{numElements:2,align:8,size:8,type:"i32",View:Int32Array},vec2u:{numElements:2,align:8,size:8,type:"u32",View:Uint32Array},vec2h:{numElements:2,align:4,size:4,type:"u16",View:Uint16Array},vec3i:{numElements:3,align:16,size:12,type:"i32",View:Int32Array},vec3u:{numElements:3,align:16,size:12,type:"u32",View:Uint32Array},vec3f:{numElements:3,align:16,size:12,type:"f32",View:Float32Array},vec3h:{numElements:3,align:8,size:6,type:"u16",View:Uint16Array},vec4i:{numElements:4,align:16,size:16,type:"i32",View:Int32Array},vec4u:{numElements:4,align:16,size:16,type:"u32",View:Uint32Array},vec4f:{numElements:4,align:16,size:16,type:"f32",View:Float32Array},vec4h:{numElements:4,align:8,size:8,type:"u16",View:Uint16Array},mat2x2f:{numElements:4,align:8,size:16,type:"f32",View:Float32Array},mat2x2h:{numElements:4,align:4,size:8,type:"u16",View:Uint16Array},mat3x2f:{numElements:6,align:8,size:24,type:"f32",View:Float32Array},mat3x2h:{numElements:6,align:4,size:12,type:"u16",View:Uint16Array},mat4x2f:{numElements:8,align:8,size:32,type:"f32",View:Float32Array},mat4x2h:{numElements:8,align:4,size:16,type:"u16",View:Uint16Array},mat2x3f:{numElements:8,align:16,size:32,pad:[3,1],type:"f32",View:Float32Array},mat2x3h:{numElements:8,align:8,size:16,pad:[3,1],type:"u16",View:Uint16Array},mat3x3f:{numElements:12,align:16,size:48,pad:[3,1],type:"f32",View:Float32Array},mat3x3h:{numElements:12,align:8,size:24,pad:[3,1],type:"u16",View:Uint16Array},mat4x3f:{numElements:16,align:16,size:64,pad:[3,1],type:"f32",View:Float32Array},mat4x3h:{numElements:16,align:8,size:32,pad:[3,1],type:"u16",View:Uint16Array},mat2x4f:{numElements:8,align:16,size:32,type:"f32",View:Float32Array},mat2x4h:{numElements:8,align:8,size:16,type:"u16",View:Uint16Array},mat3x4f:{numElements:12,align:16,size:48,pad:[3,1],type:"f32",View:Float32Array},mat3x4h:{numElements:12,align:8,size:24,pad:[3,1],type:"u16",View:Uint16Array},mat4x4f:{numElements:16,align:16,size:64,type:"f32",View:Float32Array},mat4x4h:{numElements:16,align:8,size:32,type:"u16",View:Uint16Array},bool:{numElements:0,align:1,size:0,type:"bool",View:Uint32Array}},ln={...cn,"atomic<i32>":cn.i32,"atomic<u32>":cn.u32,"vec2<i32>":cn.vec2i,"vec2<u32>":cn.vec2u,"vec2<f32>":cn.vec2f,"vec2<f16>":cn.vec2h,"vec3<i32>":cn.vec3i,"vec3<u32>":cn.vec3u,"vec3<f32>":cn.vec3f,"vec3<f16>":cn.vec3h,"vec4<i32>":cn.vec4i,"vec4<u32>":cn.vec4u,"vec4<f32>":cn.vec4f,"vec4<f16>":cn.vec4h,"mat2x2<f32>":cn.mat2x2f,"mat2x2<f16>":cn.mat2x2h,"mat3x2<f32>":cn.mat3x2f,"mat3x2<f16>":cn.mat3x2h,"mat4x2<f32>":cn.mat4x2f,"mat4x2<f16>":cn.mat4x2h,"mat2x3<f32>":cn.mat2x3f,"mat2x3<f16>":cn.mat2x3h,"mat3x3<f32>":cn.mat3x3f,"mat3x3<f16>":cn.mat3x3h,"mat4x3<f32>":cn.mat4x3f,"mat4x3<f16>":cn.mat4x3h,"mat2x4<f32>":cn.mat2x4f,"mat2x4<f16>":cn.mat2x4h,"mat3x4<f32>":cn.mat3x4f,"mat3x4<f16>":cn.mat3x4h,"mat4x4<f32>":cn.mat4x4f,"mat4x4<f16>":cn.mat4x4h},fn=(hn=ln,Object.keys(hn));var hn,pn,dn,_n,mn,gn;!function(t=[],e){const n=new Set;for(const r of fn){const i=ln[r];n.has(i)||(n.add(i),i.flatten=t.includes(r)?e:!e)}}(),new WeakMap;class vn{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class yn{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}search(t){}searchBlock(t,e){if(t){e(wn.instance);for(const n of t)n instanceof Array?this.searchBlock(n,e):n.search(e);e(xn.instance)}}}class wn extends yn{}wn.instance=new wn;class xn extends yn{}xn.instance=new xn;class bn extends yn{constructor(){super()}}class kn extends bn{constructor(t,e,n,r){super(),this.name=t,this.args=e,this.returnType=n,this.body=r}get astNodeType(){return"function"}search(t){this.searchBlock(this.body,t)}}class An extends bn{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}search(t){this.expression.search(t)}}class Mn extends bn{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"while"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class Tn extends bn{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}search(t){this.searchBlock(this.body,t)}}class Sn extends bn{constructor(t,e,n,r){super(),this.init=t,this.condition=e,this.increment=n,this.body=r}get astNodeType(){return"for"}search(t){var e,n,r;null===(e=this.init)||void 0===e||e.search(t),null===(n=this.condition)||void 0===n||n.search(t),null===(r=this.increment)||void 0===r||r.search(t),this.searchBlock(this.body,t)}}class En extends bn{constructor(t,e,n,r,i){super(),this.name=t,this.type=e,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"var"}search(t){var e;t(this),null===(e=this.value)||void 0===e||e.search(t)}}class In extends bn{constructor(t,e,n){super(),this.name=t,this.type=e,this.value=n}get astNodeType(){return"override"}search(t){var e;null===(e=this.value)||void 0===e||e.search(t)}}class Pn extends bn{constructor(t,e,n,r,i){super(),this.name=t,this.type=e,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"let"}search(t){var e;null===(e=this.value)||void 0===e||e.search(t)}}class On extends bn{constructor(t,e,n,r,i){super(),this.name=t,this.type=e,this.storage=n,this.access=r,this.value=i}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}search(t){var e;null===(e=this.value)||void 0===e||e.search(t)}}!function(t){t.increment="++",t.decrement="--"}(pn||(pn={})),function(t){t.parse=function(e){const n=e;if("parse"==n)throw new Error("Invalid value for IncrementOperator");return t[n]}}(pn||(pn={}));class Un extends bn{constructor(t,e){super(),this.operator=t,this.variable=e}get astNodeType(){return"increment"}search(t){this.variable.search(t)}}!function(t){t.assign="=",t.addAssign="+=",t.subtractAssin="-=",t.multiplyAssign="*=",t.divideAssign="/=",t.moduloAssign="%=",t.andAssign="&=",t.orAssign="|=",t.xorAssign="^=",t.shiftLeftAssign="<<=",t.shiftRightAssign=">>="}(dn||(dn={})),function(t){t.parse=function(t){const e=t;if("parse"==e)throw new Error("Invalid value for AssignOperator");return e}}(dn||(dn={}));class zn extends bn{constructor(t,e,n){super(),this.operator=t,this.variable=e,this.value=n}get astNodeType(){return"assign"}search(t){this.value.search(t)}}class Bn extends bn{constructor(t,e){super(),this.name=t,this.args=e}get astNodeType(){return"call"}}class jn extends bn{constructor(t,e){super(),this.body=t,this.continuing=e}get astNodeType(){return"loop"}}class Rn extends bn{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"body"}}class Nn extends bn{constructor(t,e,n,r){super(),this.condition=t,this.body=e,this.elseif=n,this.else=r}get astNodeType(){return"if"}search(t){this.condition.search(t),this.searchBlock(this.body,t),this.searchBlock(this.elseif,t),this.searchBlock(this.else,t)}}class Cn extends bn{constructor(t){super(),this.value=t}get astNodeType(){return"return"}search(t){var e;null===(e=this.value)||void 0===e||e.search(t)}}class qn extends bn{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}}class Dn extends bn{constructor(t,e){super(),this.name=t,this.type=e}get astNodeType(){return"alias"}}class Vn extends bn{constructor(){super()}get astNodeType(){return"discard"}}class Ln extends bn{constructor(){super()}get astNodeType(){return"break"}}class Fn extends bn{constructor(){super()}get astNodeType(){return"continue"}}class Gn extends bn{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}}class $n extends Gn{constructor(t,e){super(t),this.members=e}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let e=0;e<this.members.length;e++)if(this.members[e].name==t)return e;return-1}}class Yn extends Gn{constructor(t,e,n){super(t),this.format=e,this.access=n}get astNodeType(){return"template"}}class Wn extends Gn{constructor(t,e,n,r){super(t),this.storage=e,this.type=n,this.access=r}get astNodeType(){return"pointer"}}class Xn extends Gn{constructor(t,e,n,r){super(t),this.attributes=e,this.format=n,this.count=r}get astNodeType(){return"array"}get isArray(){return!0}}class Hn extends Gn{constructor(t,e,n){super(t),this.format=e,this.access=n}get astNodeType(){return"sampler"}}class Zn extends yn{constructor(){super()}}class Kn extends Zn{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}}class Qn extends Zn{constructor(t,e){super(),this.type=t,this.args=e}get astNodeType(){return"createExpr"}}class Jn extends Zn{constructor(t,e){super(),this.name=t,this.args=e}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return 180*this.args[0].evaluate(t)/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}search(t){for(const e of this.args)e.search(t);t(this)}}class tr extends Zn{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}search(t){t(this)}}class er extends Zn{constructor(t,e){super(),this.name=t,this.initializer=e}get astNodeType(){return"constExpr"}evaluate(t){var e,n;if(this.initializer instanceof Qn){const r=null===(e=this.postfix)||void 0===e?void 0:e.evaluateString(t),i=null===(n=this.initializer.type)||void 0===n?void 0:n.name,o=t.structs.get(i),s=null==o?void 0:o.getMemberIndex(r);if(-1!=s)return this.initializer.args[s].evaluate(t);console.log(s)}return this.initializer.evaluate(t)}search(t){this.initializer.search(t)}}class nr extends Zn{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}}class rr extends Zn{constructor(t,e){super(),this.type=t,this.value=e}get astNodeType(){return"bitcastExpr"}search(t){this.value.search(t)}}class ir extends Zn{constructor(t,e){super(),this.type=t,this.args=e}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}search(t){this.searchBlock(this.args,t)}}class or extends Zn{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}search(t){this.searchBlock(this.contents,t)}}class sr extends Zn{constructor(){super()}}class ar extends sr{constructor(t,e){super(),this.operator=t,this.right=e}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}search(t){this.right.search(t)}}class ur extends sr{constructor(t,e,n){super(),this.operator=t,this.left=e,this.right=n}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}search(t){this.left.search(t),this.right.search(t)}}class cr extends yn{constructor(){super()}}class lr extends cr{constructor(t,e){super(),this.selector=t,this.body=e}get astNodeType(){return"case"}search(t){this.searchBlock(this.body,t)}}class fr extends cr{constructor(t){super(),this.body=t}get astNodeType(){return"default"}search(t){this.searchBlock(this.body,t)}}class hr extends yn{constructor(t,e,n){super(),this.name=t,this.type=e,this.attributes=n}get astNodeType(){return"argument"}}class pr extends yn{constructor(t,e){super(),this.condition=t,this.body=e}get astNodeType(){return"elseif"}search(t){this.condition.search(t),this.searchBlock(this.body,t)}}class dr extends yn{constructor(t,e,n){super(),this.name=t,this.type=e,this.attributes=n}get astNodeType(){return"member"}}class _r extends yn{constructor(t,e){super(),this.name=t,this.value=e}get astNodeType(){return"attribute"}}!function(t){t[t.token=0]="token",t[t.keyword=1]="keyword",t[t.reserved=2]="reserved"}(mn||(mn={}));class mr{constructor(t,e,n){this.name=t,this.type=e,this.rule=n}toString(){return this.name}}class gr{}_n=gr,gr.none=new mr("",mn.reserved,""),gr.eof=new mr("EOF",mn.token,""),gr.reserved={asm:new mr("asm",mn.reserved,"asm"),bf16:new mr("bf16",mn.reserved,"bf16"),do:new mr("do",mn.reserved,"do"),enum:new mr("enum",mn.reserved,"enum"),f16:new mr("f16",mn.reserved,"f16"),f64:new mr("f64",mn.reserved,"f64"),handle:new mr("handle",mn.reserved,"handle"),i8:new mr("i8",mn.reserved,"i8"),i16:new mr("i16",mn.reserved,"i16"),i64:new mr("i64",mn.reserved,"i64"),mat:new mr("mat",mn.reserved,"mat"),premerge:new mr("premerge",mn.reserved,"premerge"),regardless:new mr("regardless",mn.reserved,"regardless"),typedef:new mr("typedef",mn.reserved,"typedef"),u8:new mr("u8",mn.reserved,"u8"),u16:new mr("u16",mn.reserved,"u16"),u64:new mr("u64",mn.reserved,"u64"),unless:new mr("unless",mn.reserved,"unless"),using:new mr("using",mn.reserved,"using"),vec:new mr("vec",mn.reserved,"vec"),void:new mr("void",mn.reserved,"void")},gr.keywords={array:new mr("array",mn.keyword,"array"),atomic:new mr("atomic",mn.keyword,"atomic"),bool:new mr("bool",mn.keyword,"bool"),f32:new mr("f32",mn.keyword,"f32"),i32:new mr("i32",mn.keyword,"i32"),mat2x2:new mr("mat2x2",mn.keyword,"mat2x2"),mat2x3:new mr("mat2x3",mn.keyword,"mat2x3"),mat2x4:new mr("mat2x4",mn.keyword,"mat2x4"),mat3x2:new mr("mat3x2",mn.keyword,"mat3x2"),mat3x3:new mr("mat3x3",mn.keyword,"mat3x3"),mat3x4:new mr("mat3x4",mn.keyword,"mat3x4"),mat4x2:new mr("mat4x2",mn.keyword,"mat4x2"),mat4x3:new mr("mat4x3",mn.keyword,"mat4x3"),mat4x4:new mr("mat4x4",mn.keyword,"mat4x4"),ptr:new mr("ptr",mn.keyword,"ptr"),sampler:new mr("sampler",mn.keyword,"sampler"),sampler_comparison:new mr("sampler_comparison",mn.keyword,"sampler_comparison"),struct:new mr("struct",mn.keyword,"struct"),texture_1d:new mr("texture_1d",mn.keyword,"texture_1d"),texture_2d:new mr("texture_2d",mn.keyword,"texture_2d"),texture_2d_array:new mr("texture_2d_array",mn.keyword,"texture_2d_array"),texture_3d:new mr("texture_3d",mn.keyword,"texture_3d"),texture_cube:new mr("texture_cube",mn.keyword,"texture_cube"),texture_cube_array:new mr("texture_cube_array",mn.keyword,"texture_cube_array"),texture_multisampled_2d:new mr("texture_multisampled_2d",mn.keyword,"texture_multisampled_2d"),texture_storage_1d:new mr("texture_storage_1d",mn.keyword,"texture_storage_1d"),texture_storage_2d:new mr("texture_storage_2d",mn.keyword,"texture_storage_2d"),texture_storage_2d_array:new mr("texture_storage_2d_array",mn.keyword,"texture_storage_2d_array"),texture_storage_3d:new mr("texture_storage_3d",mn.keyword,"texture_storage_3d"),texture_depth_2d:new mr("texture_depth_2d",mn.keyword,"texture_depth_2d"),texture_depth_2d_array:new mr("texture_depth_2d_array",mn.keyword,"texture_depth_2d_array"),texture_depth_cube:new mr("texture_depth_cube",mn.keyword,"texture_depth_cube"),texture_depth_cube_array:new mr("texture_depth_cube_array",mn.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new mr("texture_depth_multisampled_2d",mn.keyword,"texture_depth_multisampled_2d"),texture_external:new mr("texture_external",mn.keyword,"texture_external"),u32:new mr("u32",mn.keyword,"u32"),vec2:new mr("vec2",mn.keyword,"vec2"),vec3:new mr("vec3",mn.keyword,"vec3"),vec4:new mr("vec4",mn.keyword,"vec4"),bitcast:new mr("bitcast",mn.keyword,"bitcast"),block:new mr("block",mn.keyword,"block"),break:new mr("break",mn.keyword,"break"),case:new mr("case",mn.keyword,"case"),continue:new mr("continue",mn.keyword,"continue"),continuing:new mr("continuing",mn.keyword,"continuing"),default:new mr("default",mn.keyword,"default"),discard:new mr("discard",mn.keyword,"discard"),else:new mr("else",mn.keyword,"else"),enable:new mr("enable",mn.keyword,"enable"),fallthrough:new mr("fallthrough",mn.keyword,"fallthrough"),false:new mr("false",mn.keyword,"false"),fn:new mr("fn",mn.keyword,"fn"),for:new mr("for",mn.keyword,"for"),function:new mr("function",mn.keyword,"function"),if:new mr("if",mn.keyword,"if"),let:new mr("let",mn.keyword,"let"),const:new mr("const",mn.keyword,"const"),loop:new mr("loop",mn.keyword,"loop"),while:new mr("while",mn.keyword,"while"),private:new mr("private",mn.keyword,"private"),read:new mr("read",mn.keyword,"read"),read_write:new mr("read_write",mn.keyword,"read_write"),return:new mr("return",mn.keyword,"return"),storage:new mr("storage",mn.keyword,"storage"),switch:new mr("switch",mn.keyword,"switch"),true:new mr("true",mn.keyword,"true"),alias:new mr("alias",mn.keyword,"alias"),type:new mr("type",mn.keyword,"type"),uniform:new mr("uniform",mn.keyword,"uniform"),var:new mr("var",mn.keyword,"var"),override:new mr("override",mn.keyword,"override"),workgroup:new mr("workgroup",mn.keyword,"workgroup"),write:new mr("write",mn.keyword,"write"),r8unorm:new mr("r8unorm",mn.keyword,"r8unorm"),r8snorm:new mr("r8snorm",mn.keyword,"r8snorm"),r8uint:new mr("r8uint",mn.keyword,"r8uint"),r8sint:new mr("r8sint",mn.keyword,"r8sint"),r16uint:new mr("r16uint",mn.keyword,"r16uint"),r16sint:new mr("r16sint",mn.keyword,"r16sint"),r16float:new mr("r16float",mn.keyword,"r16float"),rg8unorm:new mr("rg8unorm",mn.keyword,"rg8unorm"),rg8snorm:new mr("rg8snorm",mn.keyword,"rg8snorm"),rg8uint:new mr("rg8uint",mn.keyword,"rg8uint"),rg8sint:new mr("rg8sint",mn.keyword,"rg8sint"),r32uint:new mr("r32uint",mn.keyword,"r32uint"),r32sint:new mr("r32sint",mn.keyword,"r32sint"),r32float:new mr("r32float",mn.keyword,"r32float"),rg16uint:new mr("rg16uint",mn.keyword,"rg16uint"),rg16sint:new mr("rg16sint",mn.keyword,"rg16sint"),rg16float:new mr("rg16float",mn.keyword,"rg16float"),rgba8unorm:new mr("rgba8unorm",mn.keyword,"rgba8unorm"),rgba8unorm_srgb:new mr("rgba8unorm_srgb",mn.keyword,"rgba8unorm_srgb"),rgba8snorm:new mr("rgba8snorm",mn.keyword,"rgba8snorm"),rgba8uint:new mr("rgba8uint",mn.keyword,"rgba8uint"),rgba8sint:new mr("rgba8sint",mn.keyword,"rgba8sint"),bgra8unorm:new mr("bgra8unorm",mn.keyword,"bgra8unorm"),bgra8unorm_srgb:new mr("bgra8unorm_srgb",mn.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new mr("rgb10a2unorm",mn.keyword,"rgb10a2unorm"),rg11b10float:new mr("rg11b10float",mn.keyword,"rg11b10float"),rg32uint:new mr("rg32uint",mn.keyword,"rg32uint"),rg32sint:new mr("rg32sint",mn.keyword,"rg32sint"),rg32float:new mr("rg32float",mn.keyword,"rg32float"),rgba16uint:new mr("rgba16uint",mn.keyword,"rgba16uint"),rgba16sint:new mr("rgba16sint",mn.keyword,"rgba16sint"),rgba16float:new mr("rgba16float",mn.keyword,"rgba16float"),rgba32uint:new mr("rgba32uint",mn.keyword,"rgba32uint"),rgba32sint:new mr("rgba32sint",mn.keyword,"rgba32sint"),rgba32float:new mr("rgba32float",mn.keyword,"rgba32float"),static_assert:new mr("static_assert",mn.keyword,"static_assert")},gr.tokens={decimal_float_literal:new mr("decimal_float_literal",mn.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new mr("hex_float_literal",mn.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new mr("int_literal",mn.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new mr("uint_literal",mn.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new mr("ident",mn.token,/[a-zA-Z][0-9a-zA-Z_]*/),and:new mr("and",mn.token,"&"),and_and:new mr("and_and",mn.token,"&&"),arrow:new mr("arrow ",mn.token,"->"),attr:new mr("attr",mn.token,"@"),attr_left:new mr("attr_left",mn.token,"[["),attr_right:new mr("attr_right",mn.token,"]]"),forward_slash:new mr("forward_slash",mn.token,"/"),bang:new mr("bang",mn.token,"!"),bracket_left:new mr("bracket_left",mn.token,"["),bracket_right:new mr("bracket_right",mn.token,"]"),brace_left:new mr("brace_left",mn.token,"{"),brace_right:new mr("brace_right",mn.token,"}"),colon:new mr("colon",mn.token,":"),comma:new mr("comma",mn.token,","),equal:new mr("equal",mn.token,"="),equal_equal:new mr("equal_equal",mn.token,"=="),not_equal:new mr("not_equal",mn.token,"!="),greater_than:new mr("greater_than",mn.token,">"),greater_than_equal:new mr("greater_than_equal",mn.token,">="),shift_right:new mr("shift_right",mn.token,">>"),less_than:new mr("less_than",mn.token,"<"),less_than_equal:new mr("less_than_equal",mn.token,"<="),shift_left:new mr("shift_left",mn.token,"<<"),modulo:new mr("modulo",mn.token,"%"),minus:new mr("minus",mn.token,"-"),minus_minus:new mr("minus_minus",mn.token,"--"),period:new mr("period",mn.token,"."),plus:new mr("plus",mn.token,"+"),plus_plus:new mr("plus_plus",mn.token,"++"),or:new mr("or",mn.token,"|"),or_or:new mr("or_or",mn.token,"||"),paren_left:new mr("paren_left",mn.token,"("),paren_right:new mr("paren_right",mn.token,")"),semicolon:new mr("semicolon",mn.token,";"),star:new mr("star",mn.token,"*"),tilde:new mr("tilde",mn.token,"~"),underscore:new mr("underscore",mn.token,"_"),xor:new mr("xor",mn.token,"^"),plus_equal:new mr("plus_equal",mn.token,"+="),minus_equal:new mr("minus_equal",mn.token,"-="),times_equal:new mr("times_equal",mn.token,"*="),division_equal:new mr("division_equal",mn.token,"/="),modulo_equal:new mr("modulo_equal",mn.token,"%="),and_equal:new mr("and_equal",mn.token,"&="),or_equal:new mr("or_equal",mn.token,"|="),xor_equal:new mr("xor_equal",mn.token,"^="),shift_right_equal:new mr("shift_right_equal",mn.token,">>="),shift_left_equal:new mr("shift_left_equal",mn.token,"<<=")},gr.storage_class=[_n.keywords.function,_n.keywords.private,_n.keywords.workgroup,_n.keywords.uniform,_n.keywords.storage],gr.access_mode=[_n.keywords.read,_n.keywords.write,_n.keywords.read_write],gr.sampler_type=[_n.keywords.sampler,_n.keywords.sampler_comparison],gr.sampled_texture_type=[_n.keywords.texture_1d,_n.keywords.texture_2d,_n.keywords.texture_2d_array,_n.keywords.texture_3d,_n.keywords.texture_cube,_n.keywords.texture_cube_array],gr.multisampled_texture_type=[_n.keywords.texture_multisampled_2d],gr.storage_texture_type=[_n.keywords.texture_storage_1d,_n.keywords.texture_storage_2d,_n.keywords.texture_storage_2d_array,_n.keywords.texture_storage_3d],gr.depth_texture_type=[_n.keywords.texture_depth_2d,_n.keywords.texture_depth_2d_array,_n.keywords.texture_depth_cube,_n.keywords.texture_depth_cube_array,_n.keywords.texture_depth_multisampled_2d],gr.texture_external_type=[_n.keywords.texture_external],gr.any_texture_type=[..._n.sampled_texture_type,..._n.multisampled_texture_type,..._n.storage_texture_type,..._n.depth_texture_type,..._n.texture_external_type],gr.texel_format=[_n.keywords.r8unorm,_n.keywords.r8snorm,_n.keywords.r8uint,_n.keywords.r8sint,_n.keywords.r16uint,_n.keywords.r16sint,_n.keywords.r16float,_n.keywords.rg8unorm,_n.keywords.rg8snorm,_n.keywords.rg8uint,_n.keywords.rg8sint,_n.keywords.r32uint,_n.keywords.r32sint,_n.keywords.r32float,_n.keywords.rg16uint,_n.keywords.rg16sint,_n.keywords.rg16float,_n.keywords.rgba8unorm,_n.keywords.rgba8unorm_srgb,_n.keywords.rgba8snorm,_n.keywords.rgba8uint,_n.keywords.rgba8sint,_n.keywords.bgra8unorm,_n.keywords.bgra8unorm_srgb,_n.keywords.rgb10a2unorm,_n.keywords.rg11b10float,_n.keywords.rg32uint,_n.keywords.rg32sint,_n.keywords.rg32float,_n.keywords.rgba16uint,_n.keywords.rgba16sint,_n.keywords.rgba16float,_n.keywords.rgba32uint,_n.keywords.rgba32sint,_n.keywords.rgba32float],gr.const_literal=[_n.tokens.int_literal,_n.tokens.uint_literal,_n.tokens.decimal_float_literal,_n.tokens.hex_float_literal,_n.keywords.true,_n.keywords.false],gr.literal_or_ident=[_n.tokens.ident,_n.tokens.int_literal,_n.tokens.uint_literal,_n.tokens.decimal_float_literal,_n.tokens.hex_float_literal],gr.element_count_expression=[_n.tokens.int_literal,_n.tokens.uint_literal,_n.tokens.ident],gr.template_types=[_n.keywords.vec2,_n.keywords.vec3,_n.keywords.vec4,_n.keywords.mat2x2,_n.keywords.mat2x3,_n.keywords.mat2x4,_n.keywords.mat3x2,_n.keywords.mat3x3,_n.keywords.mat3x4,_n.keywords.mat4x2,_n.keywords.mat4x3,_n.keywords.mat4x4,_n.keywords.atomic,_n.keywords.bitcast,..._n.any_texture_type],gr.attribute_name=[_n.tokens.ident,_n.keywords.block],gr.assignment_operators=[_n.tokens.equal,_n.tokens.plus_equal,_n.tokens.minus_equal,_n.tokens.times_equal,_n.tokens.division_equal,_n.tokens.modulo_equal,_n.tokens.and_equal,_n.tokens.or_equal,_n.tokens.xor_equal,_n.tokens.shift_right_equal,_n.tokens.shift_left_equal],gr.increment_operators=[_n.tokens.plus_plus,_n.tokens.minus_minus];class vr{constructor(t,e,n){this.type=t,this.lexeme=e,this.line=n}toString(){return this.lexeme}isTemplateType(){return-1!=gr.template_types.indexOf(this.type)}isArrayType(){return this.type==gr.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class yr{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=null!=t?t:""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new vr(gr.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if("\n"==t)return this._line++,!0;if(this._isWhitespace(t))return!0;if("/"==t){if("/"==this._peekAhead()){for(;"\n"!=t;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}if("*"==this._peekAhead()){this._advance();let e=1;for(;e>0;){if(this._isAtEnd())return!0;if(t=this._advance(),"\n"==t)this._line++;else if("*"==t){if("/"==this._peekAhead()&&(this._advance(),e--,0==e))return!0}else"/"==t&&"*"==this._peekAhead()&&(this._advance(),e++)}return!0}}let e=gr.none;for(;;){let n=this._findType(t);const r=this._peekAhead();if(">"==t&&(">"==r||"="==r)){let t=!1,e=this._tokens.length-1;for(let n=0;n<5&&e>=0;++n,--e)if(this._tokens[e].type===gr.tokens.less_than){e>0&&this._tokens[e-1].isArrayOrTemplateType()&&(t=!0);break}if(t)return this._addToken(n),!0}if(n===gr.none){let r=t,i=0;const o=2;for(let t=0;t<o;++t)if(r+=this._peekAhead(t),n=this._findType(r),n!==gr.none){i=t;break}if(n===gr.none)return e!==gr.none&&(this._current--,this._addToken(e),!0);t=r,this._current+=i+1}if(e=n,this._isAtEnd())break;t+=this._advance()}return e!==gr.none&&(this._addToken(e),!0)}_findType(t){for(const e in gr.keywords){const n=gr.keywords[e];if(this._match(t,n.rule))return n}for(const e in gr.tokens){const n=gr.tokens[e];if(this._match(t,n.rule))return n}return gr.none}_match(t,e){if("string"==typeof e){if(e==t)return!0}else{const n=e.exec(t);if(n&&0==n.index&&n[0]==t)return!0}return!1}_isAtEnd(){return this._current>=this._source.length}_isWhitespace(t){return" "==t||"\t"==t||"\r"==t}_advance(t=0){let e=this._source[this._current];return t=t||0,t++,this._current+=t,e}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){const e=this._source.substring(this._start,this._current);this._tokens.push(new vr(t,e,this._line))}}class wr{constructor(){this._tokens=[],this._current=0,this._context=new vn}parse(t){this._initialize(t);let e=[];for(;!this._isAtEnd();){const t=this._global_decl_or_directive();if(!t)break;e.push(t)}return e}_initialize(t){if(t)if("string"==typeof t){const e=new yr(t);this._tokens=e.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,e){return console.error(t,e),{token:t,message:e,toString:function(){return`${e}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==gr.eof}_match(t){if(t instanceof mr)return!!this._check(t)&&(this._advance(),!0);for(let e=0,n=t.length;e<n;++e){const n=t[e];if(this._check(n))return this._advance(),!0}return!1}_consume(t,e){if(this._check(t))return this._advance();throw this._error(this._peek(),e)}_check(t){if(this._isAtEnd())return!1;const e=this._peek();if(t instanceof Array){let n=e.type;return-1!=t.indexOf(n)}return e.type==t}_advance(){return this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(gr.tokens.semicolon)&&!this._isAtEnd(););if(this._match(gr.keywords.alias)){const t=this._type_alias();return this._consume(gr.tokens.semicolon,"Expected ';'"),t}if(this._match(gr.keywords.enable)){const t=this._enable_directive();return this._consume(gr.tokens.semicolon,"Expected ';'"),t}const t=this._attribute();if(this._check(gr.keywords.var)){const e=this._global_variable_decl();return null!=e&&(e.attributes=t),this._consume(gr.tokens.semicolon,"Expected ';'."),e}if(this._check(gr.keywords.override)){const e=this._override_variable_decl();return null!=e&&(e.attributes=t),this._consume(gr.tokens.semicolon,"Expected ';'."),e}if(this._check(gr.keywords.let)){const e=this._global_let_decl();return null!=e&&(e.attributes=t),this._consume(gr.tokens.semicolon,"Expected ';'."),e}if(this._check(gr.keywords.const)){const e=this._global_const_decl();return null!=e&&(e.attributes=t),this._consume(gr.tokens.semicolon,"Expected ';'."),e}if(this._check(gr.keywords.struct)){const e=this._struct_decl();return null!=e&&(e.attributes=t),e}if(this._check(gr.keywords.fn)){const e=this._function_decl();return null!=e&&(e.attributes=t),e}return null}_function_decl(){if(!this._match(gr.keywords.fn))return null;const t=this._consume(gr.tokens.ident,"Expected function name.").toString();this._consume(gr.tokens.paren_left,"Expected '(' for function arguments.");const e=[];if(!this._check(gr.tokens.paren_right))do{if(this._check(gr.tokens.paren_right))break;const t=this._attribute(),n=this._consume(gr.tokens.ident,"Expected argument name.").toString();this._consume(gr.tokens.colon,"Expected ':' for argument type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r,e.push(new hr(n,i,t)))}while(this._match(gr.tokens.comma));this._consume(gr.tokens.paren_right,"Expected ')' after function arguments.");let n=null;if(this._match(gr.tokens.arrow)){const t=this._attribute();n=this._type_decl(),null!=n&&(n.attributes=t)}const r=this._compound_statement();return new kn(t,e,n,r)}_compound_statement(){const t=[];for(this._consume(gr.tokens.brace_left,"Expected '{' for block.");!this._check(gr.tokens.brace_right);){const e=this._statement();null!==e&&t.push(e)}return this._consume(gr.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(gr.tokens.semicolon)&&!this._isAtEnd(););if(this._check(gr.keywords.if))return this._if_statement();if(this._check(gr.keywords.switch))return this._switch_statement();if(this._check(gr.keywords.loop))return this._loop_statement();if(this._check(gr.keywords.for))return this._for_statement();if(this._check(gr.keywords.while))return this._while_statement();if(this._check(gr.keywords.continuing))return this._continuing_statement();if(this._check(gr.keywords.static_assert))return this._static_assert_statement();if(this._check(gr.tokens.brace_left))return this._compound_statement();let t=null;return t=this._check(gr.keywords.return)?this._return_statement():this._check([gr.keywords.var,gr.keywords.let,gr.keywords.const])?this._variable_statement():this._match(gr.keywords.discard)?new Vn:this._match(gr.keywords.break)?new Ln:this._match(gr.keywords.continue)?new Fn:this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),null!=t&&this._consume(gr.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(gr.keywords.static_assert))return null;let t=this._optional_paren_expression();return new An(t)}_while_statement(){if(!this._match(gr.keywords.while))return null;let t=this._optional_paren_expression();const e=this._compound_statement();return new Mn(t,e)}_continuing_statement(){if(!this._match(gr.keywords.continuing))return null;const t=this._compound_statement();return new Tn(t)}_for_statement(){if(!this._match(gr.keywords.for))return null;this._consume(gr.tokens.paren_left,"Expected '('.");const t=this._check(gr.tokens.semicolon)?null:this._for_init();this._consume(gr.tokens.semicolon,"Expected ';'.");const e=this._check(gr.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(gr.tokens.semicolon,"Expected ';'.");const n=this._check(gr.tokens.paren_right)?null:this._for_increment();this._consume(gr.tokens.paren_right,"Expected ')'.");const r=this._compound_statement();return new Sn(t,e,n,r)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(gr.keywords.var)){const t=this._variable_decl();if(null===t)throw this._error(this._peek(),"Variable declaration expected.");let e=null;return this._match(gr.tokens.equal)&&(e=this._short_circuit_or_expression()),new En(t.name,t.type,t.storage,t.access,e)}if(this._match(gr.keywords.let)){const t=this._consume(gr.tokens.ident,"Expected name for let.").toString();let e=null;if(this._match(gr.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}this._consume(gr.tokens.equal,"Expected '=' for let.");const n=this._short_circuit_or_expression();return new Pn(t,e,null,null,n)}if(this._match(gr.keywords.const)){const t=this._consume(gr.tokens.ident,"Expected name for const.").toString();let e=null;if(this._match(gr.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}this._consume(gr.tokens.equal,"Expected '=' for const.");const n=this._short_circuit_or_expression();return new On(t,e,null,null,n)}return null}_increment_decrement_statement(){const t=this._current,e=this._unary_expression();if(null==e)return null;if(!this._check(gr.increment_operators))return this._current=t,null;const n=this._consume(gr.increment_operators,"Expected increment operator");return new Un(n.type===gr.tokens.plus_plus?pn.increment:pn.decrement,e)}_assignment_statement(){let t=null;if(this._check(gr.tokens.brace_right))return null;let e=this._match(gr.tokens.underscore);if(e||(t=this._unary_expression()),!e&&null==t)return null;const n=this._consume(gr.assignment_operators,"Expected assignment operator."),r=this._short_circuit_or_expression();return new zn(dn.parse(n.lexeme),t,r)}_func_call_statement(){if(!this._check(gr.tokens.ident))return null;const t=this._current,e=this._consume(gr.tokens.ident,"Expected function name."),n=this._argument_expression_list();return null===n?(this._current=t,null):new Bn(e.lexeme,n)}_loop_statement(){if(!this._match(gr.keywords.loop))return null;this._consume(gr.tokens.brace_left,"Expected '{' for loop.");const t=[];let e=this._statement();for(;null!==e;){if(Array.isArray(e))for(let n of e)t.push(n);else t.push(e);e=this._statement()}let n=null;return this._match(gr.keywords.continuing)&&(n=this._compound_statement()),this._consume(gr.tokens.brace_right,"Expected '}' for loop."),new jn(t,n)}_switch_statement(){if(!this._match(gr.keywords.switch))return null;const t=this._optional_paren_expression();this._consume(gr.tokens.brace_left,"Expected '{' for switch.");const e=this._switch_body();if(null==e||0==e.length)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(gr.tokens.brace_right,"Expected '}' for switch."),new Rn(t,e)}_switch_body(){const t=[];if(this._match(gr.keywords.case)){const e=this._case_selectors();this._match(gr.tokens.colon),this._consume(gr.tokens.brace_left,"Exected '{' for switch case.");const n=this._case_body();this._consume(gr.tokens.brace_right,"Exected '}' for switch case."),t.push(new lr(e,n))}if(this._match(gr.keywords.default)){this._match(gr.tokens.colon),this._consume(gr.tokens.brace_left,"Exected '{' for switch default.");const e=this._case_body();this._consume(gr.tokens.brace_right,"Exected '}' for switch default."),t.push(new fr(e))}if(this._check([gr.keywords.default,gr.keywords.case])){const e=this._switch_body();t.push(e[0])}return t}_case_selectors(){var t,e,n,r;const i=[null!==(e=null===(t=this._shift_expression())||void 0===t?void 0:t.evaluate(this._context).toString())&&void 0!==e?e:""];for(;this._match(gr.tokens.comma);)i.push(null!==(r=null===(n=this._shift_expression())||void 0===n?void 0:n.evaluate(this._context).toString())&&void 0!==r?r:"");return i}_case_body(){if(this._match(gr.keywords.fallthrough))return this._consume(gr.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(null==t)return[];t instanceof Array||(t=[t]);const e=this._case_body();return 0==e.length?t:[...t,e[0]]}_if_statement(){if(!this._match(gr.keywords.if))return null;const t=this._optional_paren_expression(),e=this._compound_statement();let n=[];this._match_elseif()&&(n=this._elseif_statement(n));let r=null;return this._match(gr.keywords.else)&&(r=this._compound_statement()),new Nn(t,e,n,r)}_match_elseif(){return this._tokens[this._current].type===gr.keywords.else&&this._tokens[this._current+1].type===gr.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(t=[]){const e=this._optional_paren_expression(),n=this._compound_statement();return t.push(new pr(e,n)),this._match_elseif()&&this._elseif_statement(t),t}_return_statement(){if(!this._match(gr.keywords.return))return null;const t=this._short_circuit_or_expression();return new Cn(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(gr.tokens.or_or);)t=new ur(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(gr.tokens.and_and);)t=new ur(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(gr.tokens.or);)t=new ur(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(gr.tokens.xor);)t=new ur(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(gr.tokens.and);)t=new ur(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){const t=this._relational_expression();return this._match([gr.tokens.equal_equal,gr.tokens.not_equal])?new ur(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([gr.tokens.less_than,gr.tokens.greater_than,gr.tokens.less_than_equal,gr.tokens.greater_than_equal]);)t=new ur(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([gr.tokens.shift_left,gr.tokens.shift_right]);)t=new ur(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([gr.tokens.plus,gr.tokens.minus]);)t=new ur(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([gr.tokens.star,gr.tokens.forward_slash,gr.tokens.modulo]);)t=new ur(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([gr.tokens.minus,gr.tokens.bang,gr.tokens.tilde,gr.tokens.star,gr.tokens.and])?new ar(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){const t=this._primary_expression(),e=this._postfix_expression();return e&&(t.postfix=e),t}_postfix_expression(){if(this._match(gr.tokens.bracket_left)){const t=this._short_circuit_or_expression();this._consume(gr.tokens.bracket_right,"Expected ']'.");const e=this._postfix_expression();return e&&(t.postfix=e),t}if(this._match(gr.tokens.period)){const t=this._consume(gr.tokens.ident,"Expected member name."),e=this._postfix_expression(),n=new Kn(t.lexeme);return e&&(n.postfix=e),n}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(gr.tokens.ident)){const t=this._previous().toString();if(this._check(gr.tokens.paren_left)){const e=this._argument_expression_list(),n=this._getStruct(t);return null!=n?new Qn(n,e):new Jn(t,e)}if(this._context.constants.has(t)){const e=this._context.constants.get(t);return new er(t,e.value)}return new tr(t)}if(this._match(gr.const_literal))return new nr(parseFloat(this._previous().toString()));if(this._check(gr.tokens.paren_left))return this._paren_expression();if(this._match(gr.keywords.bitcast)){this._consume(gr.tokens.less_than,"Expected '<'.");const t=this._type_decl();this._consume(gr.tokens.greater_than,"Expected '>'.");const e=this._paren_expression();return new rr(t,e)}const t=this._type_decl(),e=this._argument_expression_list();return new ir(t,e)}_argument_expression_list(){if(!this._match(gr.tokens.paren_left))return null;const t=[];do{if(this._check(gr.tokens.paren_right))break;const e=this._short_circuit_or_expression();t.push(e)}while(this._match(gr.tokens.comma));return this._consume(gr.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(gr.tokens.paren_left);const t=this._short_circuit_or_expression();return this._match(gr.tokens.paren_right),new or([t])}_paren_expression(){this._consume(gr.tokens.paren_left,"Expected '('.");const t=this._short_circuit_or_expression();return this._consume(gr.tokens.paren_right,"Expected ')'."),new or([t])}_struct_decl(){if(!this._match(gr.keywords.struct))return null;const t=this._consume(gr.tokens.ident,"Expected name for struct.").toString();this._consume(gr.tokens.brace_left,"Expected '{' for struct body.");const e=[];for(;!this._check(gr.tokens.brace_right);){const t=this._attribute(),n=this._consume(gr.tokens.ident,"Expected variable name.").toString();this._consume(gr.tokens.colon,"Expected ':' for struct member type.");const r=this._attribute(),i=this._type_decl();null!=i&&(i.attributes=r),this._check(gr.tokens.brace_right)?this._match(gr.tokens.comma):this._consume(gr.tokens.comma,"Expected ',' for struct member."),e.push(new dr(n,i,t))}this._consume(gr.tokens.brace_right,"Expected '}' after struct body.");const n=new $n(t,e);return this._context.structs.set(t,n),n}_global_variable_decl(){const t=this._variable_decl();return t&&this._match(gr.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){const t=this._override_decl();return t&&this._match(gr.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(gr.keywords.const))return null;const t=this._consume(gr.tokens.ident,"Expected variable name");let e=null;if(this._match(gr.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}let n=null;if(this._match(gr.tokens.equal)){const t=this._short_circuit_or_expression();if(t instanceof Qn)n=t;else if(t instanceof er&&t.initializer instanceof Qn)n=t.initializer;else try{const e=t.evaluate(this._context);n=new nr(e)}catch(e){n=t}}const r=new On(t.toString(),e,"","",n);return this._context.constants.set(r.name,r),r}_global_let_decl(){if(!this._match(gr.keywords.let))return null;const t=this._consume(gr.tokens.ident,"Expected variable name");let e=null;if(this._match(gr.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}let n=null;return this._match(gr.tokens.equal)&&(n=this._const_expression()),new Pn(t.toString(),e,"","",n)}_const_expression(){if(this._match(gr.const_literal))return new Kn(this._previous().toString());const t=this._type_decl();this._consume(gr.tokens.paren_left,"Expected '('.");let e=[];for(;!this._check(gr.tokens.paren_right)&&(e.push(this._const_expression()),this._check(gr.tokens.comma));)this._advance();return this._consume(gr.tokens.paren_right,"Expected ')'."),new Qn(t,e)}_variable_decl(){if(!this._match(gr.keywords.var))return null;let t="",e="";this._match(gr.tokens.less_than)&&(t=this._consume(gr.storage_class,"Expected storage_class.").toString(),this._match(gr.tokens.comma)&&(e=this._consume(gr.access_mode,"Expected access_mode.").toString()),this._consume(gr.tokens.greater_than,"Expected '>'."));const n=this._consume(gr.tokens.ident,"Expected variable name");let r=null;if(this._match(gr.tokens.colon)){const t=this._attribute();r=this._type_decl(),null!=r&&(r.attributes=t)}return new En(n.toString(),r,t,e,null)}_override_decl(){if(!this._match(gr.keywords.override))return null;const t=this._consume(gr.tokens.ident,"Expected variable name");let e=null;if(this._match(gr.tokens.colon)){const t=this._attribute();e=this._type_decl(),null!=e&&(e.attributes=t)}return new In(t.toString(),e,null)}_enable_directive(){const t=this._consume(gr.tokens.ident,"identity expected.");return new qn(t.toString())}_type_alias(){const t=this._consume(gr.tokens.ident,"identity expected.");this._consume(gr.tokens.equal,"Expected '=' for type alias.");let e=this._type_decl();if(null===e)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(e.name)&&(e=this._context.aliases.get(e.name).type);const n=new Dn(t.toString(),e);return this._context.aliases.set(n.name,n),n}_type_decl(){if(this._check([gr.tokens.ident,...gr.texel_format,gr.keywords.bool,gr.keywords.f32,gr.keywords.i32,gr.keywords.u32])){const t=this._advance(),e=t.toString();return this._context.structs.has(e)?this._context.structs.get(e):this._context.aliases.has(e)?this._context.aliases.get(e).type:new Gn(t.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(gr.template_types)){let t=this._advance().toString(),e=null,n=null;return this._match(gr.tokens.less_than)&&(e=this._type_decl(),n=null,this._match(gr.tokens.comma)&&(n=this._consume(gr.access_mode,"Expected access_mode for pointer").toString()),this._consume(gr.tokens.greater_than,"Expected '>' for type.")),new Yn(t,e,n)}if(this._match(gr.keywords.ptr)){let t=this._previous().toString();this._consume(gr.tokens.less_than,"Expected '<' for pointer.");const e=this._consume(gr.storage_class,"Expected storage_class for pointer");this._consume(gr.tokens.comma,"Expected ',' for pointer.");const n=this._type_decl();let r=null;return this._match(gr.tokens.comma)&&(r=this._consume(gr.access_mode,"Expected access_mode for pointer").toString()),this._consume(gr.tokens.greater_than,"Expected '>' for pointer."),new Wn(t,e.toString(),n,r)}const e=this._attribute();if(this._match(gr.keywords.array)){let t=null,n=-1;const r=this._previous();if(this._match(gr.tokens.less_than)){t=this._type_decl(),this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);let e="";this._match(gr.tokens.comma)&&(e=this._shift_expression().evaluate(this._context).toString()),this._consume(gr.tokens.greater_than,"Expected '>' for array."),n=e?parseInt(e):0}return new Xn(r.toString(),e,t,n)}return null}_texture_sampler_types(){if(this._match(gr.sampler_type))return new Hn(this._previous().toString(),null,null);if(this._match(gr.depth_texture_type))return new Hn(this._previous().toString(),null,null);if(this._match(gr.sampled_texture_type)||this._match(gr.multisampled_texture_type)){const t=this._previous();this._consume(gr.tokens.less_than,"Expected '<' for sampler type.");const e=this._type_decl();return this._consume(gr.tokens.greater_than,"Expected '>' for sampler type."),new Hn(t.toString(),e,null)}if(this._match(gr.storage_texture_type)){const t=this._previous();this._consume(gr.tokens.less_than,"Expected '<' for sampler type.");const e=this._consume(gr.texel_format,"Invalid texel format.").toString();this._consume(gr.tokens.comma,"Expected ',' after texel format.");const n=this._consume(gr.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(gr.tokens.greater_than,"Expected '>' for sampler type."),new Hn(t.toString(),e,n)}return null}_attribute(){let t=[];for(;this._match(gr.tokens.attr);){const e=this._consume(gr.attribute_name,"Expected attribute name"),n=new _r(e.toString(),null);if(this._match(gr.tokens.paren_left)){if(n.value=this._consume(gr.literal_or_ident,"Expected attribute value").toString(),this._check(gr.tokens.comma)){this._advance();do{const t=this._consume(gr.literal_or_ident,"Expected attribute value").toString();n.value instanceof Array||(n.value=[n.value]),n.value.push(t)}while(this._match(gr.tokens.comma))}this._consume(gr.tokens.paren_right,"Expected ')'")}t.push(n)}for(;this._match(gr.tokens.attr_left);){if(!this._check(gr.tokens.attr_right))do{const e=this._consume(gr.attribute_name,"Expected attribute name"),n=new _r(e.toString(),null);if(this._match(gr.tokens.paren_left)){if(n.value=[this._consume(gr.literal_or_ident,"Expected attribute value").toString()],this._check(gr.tokens.comma)){this._advance();do{const t=this._consume(gr.literal_or_ident,"Expected attribute value").toString();n.value.push(t)}while(this._match(gr.tokens.comma))}this._consume(gr.tokens.paren_right,"Expected ')'")}t.push(n)}while(this._match(gr.tokens.comma));this._consume(gr.tokens.attr_right,"Expected ']]' after attribute declarations")}return 0==t.length?null:t}}class xr{constructor(t,e){this.name=t,this.attributes=e,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}}class br{constructor(t,e,n){this.name=t,this.type=e,this.attributes=n,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class kr extends xr{constructor(t,e){super(t,e),this.members=[],this.align=0}get isStruct(){return!0}}class Ar extends xr{constructor(t,e){super(t,e),this.count=0,this.stride=0}get isArray(){return!0}}class Mr extends xr{constructor(t,e,n,r){super(t,n),this.format=e,this.access=r}get isTemplate(){return!0}}!function(t){t[t.Uniform=0]="Uniform",t[t.Storage=1]="Storage",t[t.Texture=2]="Texture",t[t.Sampler=3]="Sampler",t[t.StorageTexture=4]="StorageTexture"}(gn||(gn={}));class Tr{constructor(t,e,n,r,i,o,s){this.name=t,this.type=e,this.group=n,this.binding=r,this.attributes=i,this.resourceType=o,this.access=s}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class Sr{constructor(t,e){this.name=t,this.type=e}}class Er{constructor(t,e){this.align=t,this.size=e}}class Ir{constructor(t,e,n,r){this.name=t,this.type=e,this.locationType=n,this.location=r,this.interpolation=null}}class Pr{constructor(t,e,n,r){this.name=t,this.type=e,this.locationType=n,this.location=r}}class Or{constructor(t,e=null){this.stage=null,this.inputs=[],this.outputs=[],this.resources=[],this.name=t,this.stage=e}}class Ur{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}class zr{constructor(t,e,n,r){this.name=t,this.type=e,this.attributes=n,this.id=r}}class Br{constructor(t){this.resources=null,this.node=t}}class jr{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new Ur,this._types=new Map,this._functions=new Map,t&&this.update(t)}_isStorageTexture(t){return"texture_storage_1d"==t.name||"texture_storage_2d"==t.name||"texture_storage_2d_array"==t.name||"texture_storage_3d"==t.name}update(t){const e=(new wr).parse(t);for(const t of e)t instanceof kn&&this._functions.set(t.name,new Br(t));for(const t of e)if(t instanceof $n){const e=this._getTypeInfo(t,null);e instanceof kr&&this.structs.push(e)}else if(t instanceof Dn)this.aliases.push(this._getAliasInfo(t));else if(t instanceof In){const e=t,n=this._getAttributeNum(e.attributes,"id",0),r=null!=e.type?this._getTypeInfo(e.type,e.attributes):null;this.overrides.push(new zr(e.name,r,e.attributes,n))}else if(this._isUniformVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),o=new Tr(e.name,i,n,r,e.attributes,gn.Uniform,e.access);this.uniforms.push(o)}else if(this._isStorageVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),o=this._isStorageTexture(i),s=new Tr(e.name,i,n,r,e.attributes,o?gn.StorageTexture:gn.Storage,e.access);this.storage.push(s)}else if(this._isTextureVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),o=this._isStorageTexture(i),s=new Tr(e.name,i,n,r,e.attributes,o?gn.StorageTexture:gn.Texture,e.access);o?this.storage.push(s):this.textures.push(s)}else if(this._isSamplerVar(t)){const e=t,n=this._getAttributeNum(e.attributes,"group",0),r=this._getAttributeNum(e.attributes,"binding",0),i=this._getTypeInfo(e.type,e.attributes),o=new Tr(e.name,i,n,r,e.attributes,gn.Sampler,e.access);this.samplers.push(o)}else if(t instanceof kn){const e=this._getAttribute(t,"vertex"),n=this._getAttribute(t,"fragment"),r=this._getAttribute(t,"compute"),i=e||n||r;if(i){const e=new Or(t.name,null==i?void 0:i.name);e.inputs=this._getInputs(t.args),e.outputs=this._getOutputs(t.returnType),e.resources=this._findResources(t),this.entry[i.name].push(e)}}}_findResource(t){for(const e of this.uniforms)if(e.name==t)return e;for(const e of this.storage)if(e.name==t)return e;for(const e of this.textures)if(e.name==t)return e;for(const e of this.samplers)if(e.name==t)return e;return null}_findResources(t){const e=[],n=this,r=[];return t.search((t=>{if(t instanceof wn)r.push({});else if(t instanceof xn)r.pop();else if(t instanceof En){if(r.length>0){const e=t;r[r.length-1][e.name]=e}}else if(t instanceof Pn){if(r.length>0){const e=t;r[r.length-1][e.name]=e}}else if(t instanceof tr){const i=t;if(r.length>0&&r[r.length-1][i.name])return;const o=n._findResource(i.name);o&&e.push(o)}else if(t instanceof Jn){const r=t,i=n._functions.get(r.name);i&&(null===i.resources&&(i.resources=n._findResources(i.node)),e.push(...i.resources))}})),[...new Map(e.map((t=>[t.name,t]))).values()]}getBindGroups(){const t=[];function e(e,n){e>=t.length&&(t.length=e+1),void 0===t[e]&&(t[e]=[]),n>=t[e].length&&(t[e].length=n+1)}for(const n of this.uniforms)e(n.group,n.binding),t[n.group][n.binding]=n;for(const n of this.storage)e(n.group,n.binding),t[n.group][n.binding]=n;for(const n of this.textures)e(n.group,n.binding),t[n.group][n.binding]=n;for(const n of this.samplers)e(n.group,n.binding),t[n.group][n.binding]=n;return t}_getOutputs(t,e=void 0){if(void 0===e&&(e=[]),t instanceof $n)this._getStructOutputs(t,e);else{const n=this._getOutputInfo(t);null!==n&&e.push(n)}return e}_getStructOutputs(t,e){for(const n of t.members)if(n.type instanceof $n)this._getStructOutputs(n.type,e);else{const t=this._getAttribute(n,"location")||this._getAttribute(n,"builtin");if(null!==t){const r=this._getTypeInfo(n.type,n.type.attributes),i=this._parseInt(t.value),o=new Pr(n.name,r,t.name,i);e.push(o)}}}_getOutputInfo(t){const e=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(null!==e){const n=this._getTypeInfo(t,t.attributes),r=this._parseInt(e.value);return new Pr("",n,e.name,r)}return null}_getInputs(t,e=void 0){void 0===e&&(e=[]);for(const n of t)if(n.type instanceof $n)this._getStructInputs(n.type,e);else{const t=this._getInputInfo(n);null!==t&&e.push(t)}return e}_getStructInputs(t,e){for(const n of t.members)if(n.type instanceof $n)this._getStructInputs(n.type,e);else{const t=this._getInputInfo(n);null!==t&&e.push(t)}}_getInputInfo(t){const e=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(null!==e){const n=this._getAttribute(t,"interpolation"),r=this._getTypeInfo(t.type,t.attributes),i=this._parseInt(e.value),o=new Ir(t.name,r,e.name,i);return null!==n&&(o.interpolation=this._parseString(n.value)),o}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);const e=parseInt(t);return isNaN(e)?t:e}_getAlias(t){for(const e of this.aliases)if(e.name==t)return e.type;return null}_getAliasInfo(t){return new Sr(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,e){if(this._types.has(t))return this._types.get(t);if(t instanceof Xn){const n=t,r=this._getTypeInfo(n.format,n.attributes),i=new Ar(n.name,e);return i.format=r,i.count=n.count,this._types.set(t,i),this._updateTypeInfo(i),i}if(t instanceof $n){const n=t,r=new kr(n.name,e);for(const t of n.members){const e=this._getTypeInfo(t.type,t.attributes);r.members.push(new br(t.name,e,t.attributes))}return this._types.set(t,r),this._updateTypeInfo(r),r}if(t instanceof Hn){const n=t,r=n.format instanceof Gn,i=n.format?r?this._getTypeInfo(n.format,null):new xr(n.format,null):null,o=new Mr(n.name,i,e,n.access);return this._types.set(t,o),this._updateTypeInfo(o),o}if(t instanceof Yn){const n=t,r=n.format?this._getTypeInfo(n.format,null):null,i=new Mr(n.name,r,e,n.access);return this._types.set(t,i),this._updateTypeInfo(i),i}const n=new xr(t.name,e);return this._types.set(t,n),this._updateTypeInfo(n),n}_updateTypeInfo(t){var e,n;const r=this._getTypeSize(t);if(t.size=null!==(e=null==r?void 0:r.size)&&void 0!==e?e:0,t instanceof Ar){const e=this._getTypeSize(t.format);t.stride=null!==(n=null==e?void 0:e.size)&&void 0!==n?n:0,this._updateTypeInfo(t.format)}t instanceof kr&&this._updateStructInfo(t)}_updateStructInfo(t){var e;let n=0,r=0,i=0,o=0;for(let s=0,a=t.members.length;s<a;++s){const a=t.members[s],u=this._getTypeSize(a);if(!u)continue;null!==(e=this._getAlias(a.type.name))&&void 0!==e||a.type;const c=u.align,l=u.size;n=this._roundUp(c,n+r),r=l,i=n,o=Math.max(o,c),a.offset=n,a.size=l,this._updateTypeInfo(a.type)}t.size=this._roundUp(o,i+r),t.align=o}_getTypeSize(t){var e;if(null==t)return null;const n=this._getAttributeNum(t.attributes,"size",0),r=this._getAttributeNum(t.attributes,"align",0);if(t instanceof br&&(t=t.type),t instanceof xr){const e=this._getAlias(t.name);null!==e&&(t=e)}{const e=jr._typeInfo[t.name];if(void 0!==e){const i="f16"===t.format?2:1;return new Er(Math.max(r,e.align/i),Math.max(n,e.size/i))}}{const e=jr._typeInfo[t.name.substring(0,t.name.length-1)];if(e){const i="h"===t.name[t.name.length-1]?2:1;return new Er(Math.max(r,e.align/i),Math.max(n,e.size/i))}}if(t instanceof Ar){let i=t,o=8,s=8;const a=this._getTypeSize(i.format);return null!==a&&(s=a.size,o=a.align),s=i.count*this._getAttributeNum(null!==(e=null==t?void 0:t.attributes)&&void 0!==e?e:null,"stride",this._roundUp(o,s)),n&&(s=n),new Er(Math.max(r,o),Math.max(n,s))}if(t instanceof kr){let e=0,i=0,o=0,s=0,a=0;for(const n of t.members){const t=this._getTypeSize(n.type);null!==t&&(e=Math.max(t.align,e),o=this._roundUp(t.align,o+s),s=t.size,a=o)}return i=this._roundUp(e,a+s),new Er(Math.max(r,e),Math.max(n,i))}return null}_isUniformVar(t){return t instanceof En&&"uniform"==t.storage}_isStorageVar(t){return t instanceof En&&"storage"==t.storage}_isTextureVar(t){return t instanceof En&&null!==t.type&&-1!=jr._textureTypes.indexOf(t.type.name)}_isSamplerVar(t){return t instanceof En&&null!==t.type&&-1!=jr._samplerTypes.indexOf(t.type.name)}_getAttribute(t,e){const n=t;if(!n||!n.attributes)return null;const r=n.attributes;for(let t of r)if(t.name==e)return t;return null}_getAttributeNum(t,e,n){if(null===t)return n;for(let r of t)if(r.name==e){let t=null!==r&&null!==r.value?r.value:n;return t instanceof Array&&(t=t[0]),"number"==typeof t?t:"string"==typeof t?parseInt(t):n}return n}_roundUp(t,e){return Math.ceil(e/t)*t}}function Rr(t,e){const n=function(t){return Array.isArray(t)||un(t)?[...t,1,1].slice(0,3):function(t){return[t.width,t.height||1,t.depthOrArrayLayers||1]}(t)}(t),r=Math.max(...n.slice(0,"3d"===e?3:2));return 1+Math.log2(r)|0}jr._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},jr._textureTypes=gr.any_texture_type.map((t=>t.name)),jr._samplerTypes=gr.sampler_type.map((t=>t.name));const Nr=new WeakMap;const Cr=new Map([[Int8Array,{formats:["sint8","snorm8"],defaultForType:1}],[Uint8Array,{formats:["uint8","unorm8"],defaultForType:1}],[Int16Array,{formats:["sint16","snorm16"],defaultForType:1}],[Uint16Array,{formats:["uint16","unorm16"],defaultForType:1}],[Int32Array,{formats:["sint32","snorm32"],defaultForType:0}],[Uint32Array,{formats:["uint32","unorm32"],defaultForType:0}],[Float32Array,{formats:["float32","float32"],defaultForType:0}]]);function qr(t){return un(t)||Array.isArray(t)||function(t){const e=t;return un(e.data)||Array.isArray(e.data)}(t)}function Dr(t){switch(t){case"1d":return"1d";case"3d":return"3d";default:return"2d"}}new Map([...Cr.entries()].map((([t,{formats:[e,n]}])=>[[e,t],[n,t]])).flat());const Vr={"8snorm":Int8Array,"8unorm":Uint8Array,"8sint":Int8Array,"8uint":Uint8Array,"16snorm":Int16Array,"16unorm":Uint16Array,"16sint":Int16Array,"16uint":Uint16Array,"32snorm":Int32Array,"32unorm":Uint32Array,"32sint":Int32Array,"32uint":Uint32Array,"16float":Uint16Array,"32float":Float32Array},Lr=/([a-z]+)(\d+)([a-z]+)/;function Fr(t){const[,e,n,r]=Lr.exec(t),i=e.length,o=parseInt(n)/8;return{channels:e,numChannels:i,bytesPerChannel:o,bytesPerElement:i*o,Type:Vr[`${n}${r}`]}}function Gr(t,e,n,r={}){n.forEach(((n,i)=>{const o=[0,0,i+(r.baseArrayLayer||0)];if(qr(n))!function(t,e,n,r){const i=function(t,e){if(un(t))return t;const{Type:n}=Fr(e);return new n(t)}(n.data||n,e.format),o=function(t,e){return[t.width,t.height,t.depthOrArrayLayers].map((t=>Math.max(1,Math.floor(t/1))))}(e),{bytesPerElement:s}=Fr(e.format),a=r.origin||[0,0,0];t.queue.writeTexture({texture:e,origin:a},i,{bytesPerRow:s*o[0],rowsPerImage:o[1]},o)}(t,e,n,{origin:o});else{const i=n,{flipY:s,premultipliedAlpha:a,colorSpace:u}=r;t.queue.copyExternalImageToTexture({source:i,flipY:s},{texture:e,premultipliedAlpha:a,colorSpace:u,origin:o},$r(i,r))}})),e.mipLevelCount>1&&function(t,e,n){let r=Nr.get(t);r||(r={pipelineByFormatAndView:{},moduleByViewType:{}},Nr.set(t,r));let{sampler:i,uniformBuffer:o,uniformValues:s}=r;const{pipelineByFormatAndView:a,moduleByViewType:u}=r;n=n||function(t){switch(t.dimension){case"1d":return"1d";case"3d":return"3d";default:return t.depthOrArrayLayers>1?"2d-array":"2d"}}(e);let c=u[n];if(!c){const e=function(t){let e,n;switch(t){case"2d":e="texture_2d<f32>",n="textureSample(ourTexture, ourSampler, fsInput.texcoord)";break;case"2d-array":e="texture_2d_array<f32>",n="\n          textureSample(\n              ourTexture,\n              ourSampler,\n              fsInput.texcoord,\n              uni.layer)";break;case"cube":e="texture_cube<f32>",n="\n          textureSample(\n              ourTexture,\n              ourSampler,\n              faceMat[uni.layer] * vec3f(fract(fsInput.texcoord), 1))";break;case"cube-array":e="texture_cube_array<f32>",n="\n          textureSample(\n              ourTexture,\n              ourSampler,\n              faceMat[uni.layer] * vec3f(fract(fsInput.texcoord), 1), uni.layer)";break;default:throw new Error(`unsupported view: ${t}`)}return`\n        const faceMat = array(\n          mat3x3f( 0,  0,  -2,  0, -2,   0,  1,  1,   1),   // pos-x\n          mat3x3f( 0,  0,   2,  0, -2,   0, -1,  1,  -1),   // neg-x\n          mat3x3f( 2,  0,   0,  0,  0,   2, -1,  1,  -1),   // pos-y\n          mat3x3f( 2,  0,   0,  0,  0,  -2, -1, -1,   1),   // neg-y\n          mat3x3f( 2,  0,   0,  0, -2,   0, -1,  1,   1),   // pos-z\n          mat3x3f(-2,  0,   0,  0, -2,   0,  1,  1,  -1));  // neg-z\n\n        struct VSOutput {\n          @builtin(position) position: vec4f,\n          @location(0) texcoord: vec2f,\n        };\n\n        @vertex fn vs(\n          @builtin(vertex_index) vertexIndex : u32\n        ) -> VSOutput {\n          var pos = array<vec2f, 3>(\n            vec2f(-1.0, -1.0),\n            vec2f(-1.0,  3.0),\n            vec2f( 3.0, -1.0),\n          );\n\n          var vsOutput: VSOutput;\n          let xy = pos[vertexIndex];\n          vsOutput.position = vec4f(xy, 0.0, 1.0);\n          vsOutput.texcoord = xy * vec2f(0.5, -0.5) + vec2f(0.5);\n          return vsOutput;\n        }\n\n        struct Uniforms {\n          layer: u32,\n        };\n\n        @group(0) @binding(0) var ourSampler: sampler;\n        @group(0) @binding(1) var ourTexture: ${e};\n        @group(0) @binding(2) var<uniform> uni: Uniforms;\n\n        @fragment fn fs(fsInput: VSOutput) -> @location(0) vec4f {\n          _ = uni.layer; // make sure this is used so all pipelines have the same bindings\n          return ${n};\n        }\n      `}(n);c=t.createShaderModule({label:`mip level generation for ${n}`,code:e}),u[n]=c}i||(i=t.createSampler({minFilter:"linear",magFilter:"linear"}),o=t.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),s=new Uint32Array(1),Object.assign(r,{sampler:i,uniformBuffer:o,uniformValues:s}));const l=`${e.format}.${n}`;a[l]||(a[l]=t.createRenderPipeline({label:`mip level generator pipeline for ${n}`,layout:"auto",vertex:{module:c,entryPoint:"vs"},fragment:{module:c,entryPoint:"fs",targets:[{format:e.format}]}}));const f=a[l];for(let r=1;r<e.mipLevelCount;++r)for(let a=0;a<e.depthOrArrayLayers;++a){s[0]=a,t.queue.writeBuffer(o,0,s);const u=t.createBindGroup({layout:f.getBindGroupLayout(0),entries:[{binding:0,resource:i},{binding:1,resource:e.createView({dimension:n,baseMipLevel:r-1,mipLevelCount:1})},{binding:2,resource:{buffer:o}}]}),c={label:"mip gen renderPass",colorAttachments:[{view:e.createView({dimension:"2d",baseMipLevel:r,mipLevelCount:1,baseArrayLayer:a,arrayLayerCount:1}),loadOp:"clear",storeOp:"store"}]},l=t.createCommandEncoder({label:"mip gen encoder"}),h=l.beginRenderPass(c);h.setPipeline(f),h.setBindGroup(0,u),h.draw(3),h.end();const p=l.finish();t.queue.submit([p])}}(t,e)}function $r(t,e){if(t instanceof HTMLVideoElement)return[t.videoWidth,t.videoHeight,1];{const n=t,{width:r,height:i}=n;if(r>0&&i>0&&!qr(t))return[r,i,1];const o=e.format||"rgba8unorm",{bytesPerElement:s,bytesPerChannel:a}=Fr(o),u=un(t)||Array.isArray(t)?t:t.data;return function(t,e,n,r="2d"){if(n%1!=0)throw new Error("can't guess dimensions");if(t||e){if(e){if(!t&&(t=n/e)%1)throw new Error("can't guess dimensions")}else if((e=n/t)%1)throw new Error("can't guess dimensions")}else{const i=Math.sqrt(n/("cube"===r?6:1));i%1==0?(t=i,e=i):(t=n,e=1)}const i=n/t/e;if(i%1)throw new Error("can't guess dimensions");return[t,e,i]}(r,i,(un(u)?u.byteLength:u.length*a)/s)}}async function Yr(t,e,n={}){const r=await Promise.all(e.map((t=>async function(t,e={}){const n=await fetch(t),r=await n.blob(),i={...e,...void 0!==e.colorSpaceConversion&&{colorSpaceConversion:"none"}};return await createImageBitmap(r,i)}(t))));return function(t,e,n={}){const r=$r(e[0],n);r[2]=r[2]>1?r[2]:e.length;const i=t.createTexture({dimension:Dr(n.dimension),format:n.format||"rgba8unorm",mipLevelCount:n.mipLevelCount?n.mipLevelCount:n.mips?Rr(r):1,size:r,usage:(n.usage??0)|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});return Gr(t,i,e,n),i}(t,r,n)}const Wr=async(t,e)=>{const{width:n,height:r,depthOrArrayLayers:i,label:o,mipLevelCount:s,usage:a,format:u,dimension:c}=e,l=t.createTexture({size:{width:n,height:r,depthOrArrayLayers:i},format:u,usage:a,dimension:c,label:o,mipLevelCount:s}),f=t.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,texture:{viewDimension:"3d"}},{binding:1,visibility:GPUShaderStage.COMPUTE,storageTexture:{access:"write-only",format:u,viewDimension:"3d"}}]}),h=t.createComputePipeline({layout:t.createPipelineLayout({bindGroupLayouts:[f]}),compute:{module:t.createShaderModule({code:"@group(0) @binding(0) var input : texture_3d<f32>;\r\n@group(0) @binding(1) var output : texture_storage_3d<rgba8unorm, write>;\r\n\r\nconst FACES_PER_CUBE = 6;\r\n\r\n// if all face of the voxel are covered, we remove the inner voxel\r\nconst NEIGHBOUR_POSITIONS = array<vec3<i32>, FACES_PER_CUBE>(\r\n    vec3<i32>(-1, 0, 0),\r\n    vec3<i32>(1, 0, 0),\r\n    vec3<i32>(0, -1, 0),\r\n    vec3<i32>(0, 1, 0),\r\n    vec3<i32>(0, 0, -1),\r\n    vec3<i32>(0, 0, 1),\r\n);\r\n\r\n@compute @workgroup_size(4, 4, 4)\r\n fn main(\r\n   @builtin(global_invocation_id) GlobalInvocationID : vec3<u32>\r\n ) {\r\n    var texel = textureLoad(input, GlobalInvocationID, 0);\r\n    if(texel.a == 0) {\r\n        return;\r\n    }\r\n    for(var i = 0; i < FACES_PER_CUBE; i++) {\r\n        let neighbourPosition = vec3<i32>(GlobalInvocationID.xyz) + NEIGHBOUR_POSITIONS[i];\r\n        let neighbourTexel = textureLoad(input, vec3(u32(neighbourPosition.x), u32(neighbourPosition.y), u32(neighbourPosition.z)), 0);\r\n        if(neighbourTexel.a == 0) {\r\n            textureStore(output, GlobalInvocationID.xyz, texel);\r\n            return;\r\n        }\r\n    }\r\n    textureStore(output, GlobalInvocationID.xyz, vec4(0, 0, 0, 0));\r\n }"}),entryPoint:"main"}}),p=t.createBindGroup({layout:f,entries:[{binding:0,resource:e.createView({baseMipLevel:0,mipLevelCount:1})},{binding:1,resource:l.createView({baseMipLevel:0,mipLevelCount:1})}]}),d=t.createCommandEncoder(),_=d.beginComputePass();_.setPipeline(h),_.setBindGroup(0,p);const m=Math.ceil(n/4),g=Math.ceil(r/4),v=Math.ceil(i/4);return _.dispatchWorkgroups(m,g,v),_.end(),t.queue.submit([d.finish()]),await t.queue.onSubmittedWorkDone(),e.destroy(),l},Xr={format:"rgba8unorm",usage:GPUTextureUsage.COPY_SRC|GPUTextureUsage.COPY_DST|GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING,dimension:"3d"};var Hr=n(543);class Zr{name;transform;inverseTransform;previousTransform;previousInverseTransform;size;atlasLocation;worldSpaceCenter;constructor(t,e,n,r="unnamed"){this.name=r,this.transform=t,this.size=e,this.inverseTransform=wt.invert(this.transform),this.previousTransform=wt.clone(this.transform),this.previousInverseTransform=wt.clone(this.inverseTransform),this.atlasLocation=n;const i=it.transformMat4(it.create(),this.transform),o=it.transformMat4(this.size,this.transform);this.worldSpaceCenter=it.lerp(i,o,.5)}get worldSpaceCorners(){return[[0,0,0],[0,0,this.size[2]],[0,this.size[1],0],[0,this.size[1],this.size[2]],[this.size[0],0,0],[this.size[0],0,this.size[2]],[this.size[0],this.size[1],0],[this.size[0],this.size[1],this.size[2]]].map((t=>it.transformMat4(t,this.transform)))}toArray(){return[...this.transform,...this.inverseTransform,...this.previousTransform,...this.previousInverseTransform,...this.size,0,...this.atlasLocation,0]}}const Kr=t=>0===t,Qr=t=>{const e=new DataView(t);let n,r=[],i=[],o=[],s=0;if(i[s]=String.fromCodePoint(e.getUint8(s)),s++,i[s]=String.fromCodePoint(e.getUint8(s)),s++,i[s]=String.fromCodePoint(e.getUint8(s)),s++,i[s]=String.fromCodePoint(e.getUint8(s)),s++,"VXMC"!==i.join("")&&"VXMA"!==i.join(""))throw new Error(`Incorrect magic: ${i.join("")}`);if(i[3].charCodeAt(0)>="0".charCodeAt(0)&&i[3].charCodeAt(0)<="9".charCodeAt(0))n=i[3].charCodeAt(0)-"0".charCodeAt(0);else{if(!(i[3].charCodeAt(0)>="A".charCodeAt(0)&&i[3].charCodeAt(0)<="C".charCodeAt(0)))throw new Error("Unsupported version found");n=10+i[3].charCodeAt(0)-"A".charCodeAt(0)}if(n<11||n>12)throw new Error(`Could not load vxm file: Unsupported version found (${n})`);let a=[0,0,0];a[0]=e.getUint32(s,!0),s+=4,a[1]=e.getUint32(s,!0),s+=4,a[2]=e.getUint32(s,!0),s+=4;let u=[.5,0,.5];u[0]=e.getFloat32(s,!0),s+=4,u[1]=e.getFloat32(s,!0),s+=4,u[2]=e.getFloat32(s,!0),s+=4;let c=e.getUint8(s);if(s++,c>0){let t=0,n=0;e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,e.getUint32(s,!0),s+=4,t=e.getUint32(s,!0),s+=4,n=e.getUint32(s,!0),s+=4,s+=t*n*4}n>=8&&(s+=16);let l=e.getUint32(s,!0);s+=4;for(let t=0;t<l;++t){let t=e.getUint32(s,!0);s+=4;let n=e.getUint32(s,!0);if(s+=4,t>2048||n>2048)throw new Error("Size of texture exceeds the max allowed value");let r=e.getUint32(s,!0);s+=4,s+=r;for(let t=0;t<6;++t){let t=e.getUint32(s,!0);s+=4,t>262144&&console.warn(`Size of quads exceeds the max allowed value: ${t}`),s+=4*t*20}}s+=1024,s+=1024;let f=e.getUint8(s);s++;for(let t=0;t<f;++t)s+=1024,e.getUint8(s),s++,e.getUint8(s),s++;let h=e.getUint8(s);s++;for(let t=0;t<h;++t){let n=e.getUint8(s);s++;let i=e.getUint8(s);s++;let o=e.getUint8(s);s++;let a=e.getUint8(s);s++;let u=e.getUint8(s);s++,a=1===u?2:255,r[t]={r:o,g:i,b:n,a}}let p=1;n>=12&&(p=e.getUint8(s),s++);let d={min:[9999,9999,9999],max:[0,0,0]};for(let t=0;t<p;++t){let r=0,i=!0,u="";if(n>=12){for(;;){const t=e.getUint8(s);if(s++,Kr(t))break;u=`${u}${String.fromCharCode(t)}`}i=e.getUint8(s)>0,s++}else u=`Layer ${t}`;for(;;){let t=e.getUint8(s);if(s++,0===t)break;let n=e.getUint8(s);if(s++,255!==n)if(n>=h)r+=t;else{for(let e=r;e<r+t;e++){let t=Math.floor(e/(a[1]*a[2])),r=Math.floor(e/a[2]%a[1]),i=Math.floor(e%a[2]);t<d.min[0]&&(d.min=[t,d.min[1],d.min[2]]),r<d.min[1]&&(d.min=[d.min[0],r,d.min[2]]),i<d.min[2]&&(d.min=[d.min[0],d.min[1],i]),t>d.max[0]&&(d.max=[t,d.max[1],d.max[2]]),r>d.max[1]&&(d.max=[d.max[0],r,d.max[2]]),i>d.max[2]&&(d.max=[d.max[0],d.max[1],i]),o.push({x:t,y:r,z:i,c:n})}r+=t}else r+=t}}return{VOX:o.length,SIZE:a,XYZI:o,RGBA:r}},Jr=async(e,n)=>{const r=e.createTexture({size:{width:n.SIZE[0],height:n.SIZE[1],depthOrArrayLayers:n.SIZE[2]},format:"rgba8unorm",usage:GPUTextureUsage.COPY_SRC|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.TEXTURE_BINDING,dimension:"3d"}),o=e.createBuffer({size:4*n.XYZI.length*4,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC|GPUBufferUsage.STORAGE}),s=e.createBuffer({size:4*n.RGBA.length*4,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.COPY_SRC|GPUBufferUsage.STORAGE});i(s,n.RGBA.map((t=>[t.r/255,t.g/255,t.b/255,t.a/255])).flat()),t(o,n.XYZI.map((t=>[t.x,t.y,t.z,t.c])).flat());const a=e.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.COMPUTE,storageTexture:{access:"write-only",format:r.format,viewDimension:"3d"}},{binding:1,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}},{binding:2,visibility:GPUShaderStage.COMPUTE,buffer:{type:"storage"}}]}),u=e.createComputePipeline({layout:e.createPipelineLayout({bindGroupLayouts:[a]}),compute:{module:e.createShaderModule({code:"@group(0) @binding(0) var output : texture_storage_3d<rgba8unorm, write>;\r\n@group(0) @binding(1) var<storage, read_write> voxelBuffer: array<vec4<u32>>;\r\n@group(0) @binding(2) var<storage, read_write> paletteBuffer: array<vec4<f32>>;\r\n\r\n@compute @workgroup_size(64, 1, 1)\r\n fn main(\r\n   @builtin(global_invocation_id) GlobalInvocationID : vec3<u32>\r\n ) {\r\n    let index = GlobalInvocationID.x;\r\n    let voxel = voxelBuffer[index];\r\n    let paletteIndex = voxel.w;\r\n    let position = voxel.xyz;\r\n    let color = paletteBuffer[paletteIndex];\r\n    textureStore(output, position, vec4(1,0,0,1));\r\n }"}),entryPoint:"main"}}),c=e.createBindGroup({layout:a,entries:[{binding:0,resource:r.createView()},{binding:1,resource:{buffer:o}},{binding:2,resource:{buffer:s}}]}),l=e.createCommandEncoder(),f=l.beginComputePass();return f.setPipeline(u),f.setBindGroup(0,c),f.dispatchWorkgroups(n.XYZI.length/64,1,1),f.end(),e.queue.submit([l.finish()]),await e.queue.onSubmittedWorkDone(),r};let ti=[];const ei=["Dragon"],ni=t=>{let e=[1/0,1/0,1/0],n=[-1/0,-1/0,-1/0];for(const r of t)for(const t of r.worldSpaceCorners)for(let r=0;r<3;r++)e[r]=Math.min(e[r],t[r]),n[r]=Math.max(n[r],t[r]);return{min:e,max:n}},ri=t=>{const e=t.worldSpaceCenter;return 511&e[0]|(511&e[1])<<10|(511&e[2])<<20};class ii{nodes;allVoxelObjects;constructor(t){const e=performance.now();this.allVoxelObjects=t,this.nodes=[],this.buildBVH(t,0);const n=performance.now();wi.addSample("create bvh",n-e)}buildBVH(t,e){const{left:n,right:r}=(t=>{t.sort(((t,e)=>ri(t)-ri(e)));const e=Math.floor(t.length/2);return{left:t.slice(0,e),right:t.slice(e)}})(t),i=ni(n),o=ni(r);let s=2*e+1,a=2*e+2;1===n.length&&(s=this.allVoxelObjects.indexOf(n[0])),1===r.length&&(a=this.allVoxelObjects.indexOf(r[0])),this.nodes[e]={leftAABBMin:n.length>0?i.min:[0,0,0],leftAABBMax:n.length>0?i.max:[0,0,0],leftObjectCount:n.length,rightAABBMin:r.length>0?o.min:[0,0,0],rightAABBMax:r.length>0?o.max:[0,0,0],rightObjectCount:r.length,leftChildIndex:s,rightChildIndex:a},n.length>1&&this.buildBVH(n,s),r.length>1&&this.buildBVH(r,a)}toGPUBuffer(t,e){let n=2*Int32Array.BYTES_PER_ELEMENT+8*Float32Array.BYTES_PER_ELEMENT*2+2*Uint32Array.BYTES_PER_ELEMENT;var r;r=n,n=16*Math.ceil(r/16);const i=t.createBuffer({size:e*n,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!1});return this.nodes.forEach(((e,r)=>{const o=r*n,s=new ArrayBuffer(n),a=new DataView(s);a.setInt32(0,e.leftChildIndex,!0),a.setInt32(4,e.rightChildIndex,!0),a.setUint32(8,e.leftObjectCount,!0),a.setUint32(12,e.rightObjectCount,!0),a.setFloat32(16,e.leftAABBMin[0],!0),a.setFloat32(20,e.leftAABBMin[1],!0),a.setFloat32(24,e.leftAABBMin[2],!0),a.setFloat32(32,e.leftAABBMax[0],!0),a.setFloat32(36,e.leftAABBMax[1],!0),a.setFloat32(40,e.leftAABBMax[2],!0),a.setFloat32(48,e.rightAABBMin[0],!0),a.setFloat32(52,e.rightAABBMin[1],!0),a.setFloat32(56,e.rightAABBMin[2],!0),a.setFloat32(64,e.rightAABBMax[0],!0),a.setFloat32(68,e.rightAABBMax[1],!0),a.setFloat32(72,e.rightAABBMax[2],!0),t.queue.writeBuffer(i,o,s,0,n)})),i}}const oi="fn calculateRayDirection(uv: vec2<f32>, inverseProjection: mat4x4<f32>) -> vec3<f32> {\r\n  let clipSpace = vec2(1.0 - uv.x, 1.0 - uv.y) * 2.0 - 1.0;\r\n  let viewRay = vec3<f32>(clipSpace, 1.0);\r\n  let viewRayView = inverseProjection * vec4(viewRay, 1.0);\r\n  return normalize(viewRayView.xyz);\r\n}\r\n",si=async()=>{const t=ui.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX|GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float",viewDimension:"3d"}},{binding:4,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]}),e=ui.createPipelineLayout({bindGroupLayouts:[t]}),n=(t=>{const[e,n,r]=t,i=[0,0,0,1],o=[e,0,0,1],s=[0,n,0,1],a=[e,n,0,1],u=[0,0,r,1],c=[e,0,r,1],l=[0,n,r,1],f=[e,n,r,1];return new Float32Array([...i,...s,...o,...o,...s,...a,...u,...c,...l,...l,...c,...f,...s,...l,...a,...a,...l,...f,...i,...o,...u,...u,...o,...c,...o,...a,...c,...c,...a,...f,...i,...u,...s,...s,...u,...l])})(ti[0].size),r=ui.createBuffer({size:n.byteLength,usage:GPUBufferUsage.VERTEX,mappedAtCreation:!0});new Float32Array(r.getMappedRange()).set(n),r.unmap();const i=ui.createRenderPipeline({layout:e,vertex:{module:ui.createShaderModule({code:`\n        ${oi}\n        @binding(0) @group(0) var<uniform> modelViewProjectionMatrix : mat4x4f;\r\n@binding(1) @group(0) var<uniform> modelMatrix : mat4x4f;\r\n\r\nstruct VertexOutput {\r\n  @builtin(position) position : vec4f,\r\n  @location(0) worldPos : vec3f,\r\n  @location(1) @interpolate(linear) ndc : vec3f,\r\n}\r\n\r\n@vertex\r\nfn main(\r\n  @location(0) objectPos : vec4f,\r\n) -> VertexOutput {\r\n  var output : VertexOutput;\r\n  var clipPosition = modelViewProjectionMatrix * objectPos;\r\n  output.position = clipPosition;\r\n//  output.worldPos = (modelMatrix * objectPos).xyz;\r\n  output.worldPos = objectPos.xyz;\r\n  output.ndc = clipPosition.xyz / clipPosition.w;\r\n  return output;\r\n}\r\n`}),entryPoint:"main",buffers:[{arrayStride:16,attributes:[{shaderLocation:0,offset:0,format:"float32x4"}]}]},fragment:{module:ui.createShaderModule({code:`\n        ${oi}\n        struct BoxIntersectionResult {\r\n    tNear: f32,\r\n    tFar: f32,\r\n    normal: vec3<f32>,\r\n    isHit: bool,\r\n}\r\n\r\nfn simpleBoxIntersection(\r\n    ro: vec3<f32>,\r\n    rd: vec3<f32>,\r\n    boxSize: vec3<f32>,\r\n) -> f32 {\r\n  let m = 1.0/rd; // can precompute if traversing a set of aligned boxes\r\n  let n = m*ro;   // can precompute if traversing a set of aligned boxes\r\n  let k = abs(m)*boxSize;\r\n  let t1 = -n - k;\r\n  let t2 = -n + k;\r\n  let tN = max( max( t1.x, t1.y ), t1.z );\r\n  let tF = min( min( t2.x, t2.y ), t2.z );\r\n  if( tN>tF || tF<0.0) {\r\n    return -1.0; // no intersection\r\n  }\r\n  return tN;\r\n}\r\n\r\nfn boxIntersection(\r\n    ro: vec3<f32>,\r\n    rd: vec3<f32>,\r\n    boxSize: vec3<f32>,\r\n) -> BoxIntersectionResult {\r\n    var result = BoxIntersectionResult();\r\n    result.isHit = false;\r\n    result.tNear = -1.0;\r\n    result.tFar = -1.0;\r\n\r\n    let offsetRayOrigin = ro - boxSize;\r\n    let m: vec3<f32> = 1.0 / rd;\r\n    let n: vec3<f32> = m * offsetRayOrigin;\r\n    let k: vec3<f32> = abs(m) * boxSize;\r\n    let t1: vec3<f32> = -n - k;\r\n    let t2: vec3<f32> = -n + k;\r\n    let tN: f32 = max(max(t1.x, t1.y), t1.z);\r\n    let tF: f32 = min(min(t2.x, t2.y), t2.z);\r\n    if (tN > tF || tF < 0.0) {\r\n        return result;\r\n    }\r\n    // Check if the ray starts inside the volume\r\n    let insideVolume = tN < 0.0;\r\n    var normal = select(\r\n        step(vec3<f32>(tN), t1),\r\n        step(t2, vec3<f32>(tF)),\r\n        tN < 0.0,\r\n    );\r\n    normal *= -sign(rd);\r\n    // Check if the intersection is in the correct direction, only if inside the volume\r\n    if (insideVolume && dot(normal, rd) < 0.0) {\r\n        return result;\r\n    }\r\n    result.tNear = tN;\r\n    result.tFar = tF;\r\n    result.normal = normal;\r\n    result.isHit = true;\r\n    return result;\r\n}\r\n\r\nfn planeIntersection(\r\n    ro: vec3<f32>,\r\n    rd: vec3<f32>,\r\n    planeNormal: vec3<f32>,\r\n    planeDistance: f32,\r\n) -> BoxIntersectionResult {\r\n    var result = BoxIntersectionResult();\r\n    let denom = dot(planeNormal, rd);\r\n    if (abs(denom) > 0.0001) {\r\n        let t = -(dot(planeNormal, ro) + planeDistance) / denom;\r\n        if (t > 0.0) {\r\n            result.isHit = true;\r\n            result.tNear = t;\r\n            result.tFar = t;\r\n            result.normal = planeNormal;\r\n        }\r\n    }\r\n    return result;\r\n}\n        const EPSILON = 0.0001;\r\nconst MAX_RAY_STEPS = 256;\r\nconst FAR_PLANE = 10000.0;\r\n\r\n\r\n// Function to transform a normal vector from object to world space\r\nfn transformNormal(inverseTransform: mat4x4<f32>, normal: vec3<f32>) -> vec3<f32> {\r\n    let worldNormal = normalize((vec4<f32>(normal, 0.0) * inverseTransform).xyz);\r\n    return worldNormal;\r\n}\r\n\r\n// Function to transform an object space position to world space\r\nfn transformPosition(transform: mat4x4<f32>, position: vec3<f32>) -> vec3<f32> {\r\n    let worldPosition = (transform * vec4<f32>(position, 1.0)).xyz;\r\n    return worldPosition;\r\n}\r\n\r\nfn getMaxMipLevel(size: vec3<f32>) -> u32 {\r\n  return u32(log2(max(size.x, max(size.y, size.z))));\r\n}\r\n\r\n\r\nstruct VoxelObject {\r\n  transform: mat4x4<f32>,\r\n  inverseTransform: mat4x4<f32>,\r\n  previousTransform: mat4x4<f32>,\r\n  previousInverseTransform: mat4x4<f32>,\r\n  size : vec3<f32>,\r\n  atlasLocation : vec3<f32>,\r\n}\r\n\r\nstruct BVHNode {\r\n  leftIndex: i32,\r\n  rightIndex: i32,\r\n\r\n  leftObjectCount: u32,\r\n  rightObjectCount: u32,\r\n\r\n  leftMin: vec3<f32>,\r\n  leftMax: vec3<f32>,\r\n\r\n  rightMin: vec3<f32>,\r\n  rightMax: vec3<f32>,\r\n}\r\n\r\nstruct RayMarchResult {\r\n  colour: vec3<f32>,\r\n  normal: vec3<f32>,\r\n  objectPos: vec3<f32>,\r\n  worldPos: vec3<f32>,\r\n  hit: bool,\r\n  modelMatrix: mat4x4<f32>,\r\n  previousModelMatrix: mat4x4<f32>,\r\n  inverseModelMatrix: mat4x4<f32>,\r\n  previousInverseModelMatrix: mat4x4<f32>,\r\n  stepsTaken: i32,\r\n  isWater: bool\r\n}\r\n\r\nfn isInBounds(position: vec3<i32>, size: vec3<i32>) -> bool {\r\n  return all(position >= vec3(0)) && all(position <= size - vec3(1));\r\n}\r\n\r\nfn getMipLevelFromVoxelSize(voxelSize: vec3<f32>) -> u32 {\r\n  return u32(log2(max(voxelSize.x, max(voxelSize.y, voxelSize.z))));\r\n}\r\n\r\nfn rayMarchAtMip(voxelObject: VoxelObject, objectRayDirection: vec3<f32>, objectRayOrigin: vec3<f32>, mipLevel: u32) -> RayMarchResult {\r\n  var output = RayMarchResult();\r\n  let rayDirSign = sign(objectRayDirection);\r\n\r\n  var voxelSize = vec3<f32>(2.0);\r\n  var shiftedRayOrigin = objectRayOrigin - objectRayDirection * EPSILON;\r\n  var objectPos = shiftedRayOrigin;\r\n  var currentIndex = vec3<i32>(floor(objectPos));\r\n  var scaledRayOrigin =  objectRayOrigin/ voxelSize;\r\n  var scaledObjectPos = floor(objectPos / voxelSize);\r\n  var scaledOriginDifference = scaledObjectPos - scaledRayOrigin;\r\n  var tMax = voxelSize * (rayDirSign * scaledOriginDifference + (rayDirSign * 0.5) + 0.5) / abs(objectRayDirection);\r\n  let mask = vec3<f32>(tMax.xyz <= min(tMax.yzx, tMax.zxy));\r\n  var objectNormal = mask * -rayDirSign;\r\n  var tCurrent = min(tMax.x, min(tMax.y, tMax.z));\r\n\r\n  // RAYMARCH\r\n  for(var i = 0; i < MAX_RAY_STEPS; i++)\r\n  {\r\n    output.stepsTaken = i;\r\n\r\n    let atlasLocation = vec3<u32>(voxelObject.atlasLocation);\r\n    let samplePosition = vec3<u32>(currentIndex) + atlasLocation;\r\n\r\n    let mip0Index = currentIndex;\r\n    let mip1Index = currentIndex / 2;\r\n    let mip2Index = currentIndex / 4;\r\n    let mip3Index = currentIndex / 8;\r\n    let mip4Index = currentIndex / 16;\r\n\r\n    let mip0SamplePosition = vec3<u32>(mip0Index) + atlasLocation;\r\n    let mip1SamplePosition = vec3<u32>(mip1Index) + atlasLocation;\r\n    let mip2SamplePosition = vec3<u32>(mip2Index) + atlasLocation;\r\n    let mip3SamplePosition = vec3<u32>(mip3Index) + atlasLocation;\r\n    let mip4SamplePosition = vec3<u32>(mip4Index) + atlasLocation;\r\n\r\n    let mipSample0 = textureLoad(voxels, mip0SamplePosition, 0);\r\n    let mipSample1 = textureLoad(voxels, mip1SamplePosition, 1);\r\n    let mipSample2 = textureLoad(voxels, mip2SamplePosition, 2);\r\n    let mipSample3 = textureLoad(voxels, mip3SamplePosition, 3);\r\n    let mipSample4 = textureLoad(voxels, mip3SamplePosition, 4);\r\n\r\n    if(mipSample0.a > 0.0 && isInBounds(currentIndex, vec3<i32>(voxelObject.size))){\r\n//    if(true){\r\n        output.objectPos = objectPos;\r\n        output.worldPos = (voxelObject.transform *  vec4(output.objectPos, 1.0)).xyz;\r\n        output.normal = transformNormal(voxelObject.inverseTransform,vec3<f32>(objectNormal));\r\n        output.colour = mipSample0.rgb;\r\n        output.hit = true;\r\n        output.modelMatrix = voxelObject.transform;\r\n        output.previousModelMatrix = voxelObject.previousTransform;\r\n        output.inverseModelMatrix = voxelObject.inverseTransform;\r\n        output.previousInverseModelMatrix = voxelObject.previousInverseTransform;\r\n        return output;\r\n    }\r\n    voxelSize = vec3<f32>(1.0);\r\n//    if (mipSample1.a == 0.0){\r\n//      voxelSize = vec3<f32>(2.0);\r\n//    }\r\n//    if (mipSample2.a == 0.0){\r\n//      voxelSize = vec3<f32>(4.0);\r\n//    }\r\n//    if (mipSample3.a == 0.0){\r\n//      voxelSize = vec3<f32>(8.0);\r\n//    }\r\n//    if (mipSample4.a == 0.0){\r\n//      voxelSize = vec3<f32>(16.0);\r\n//    }\r\n\r\n    var scaledRayOrigin = shiftedRayOrigin / voxelSize;\r\n    var scaledObjectPos = floor(objectPos / voxelSize);\r\n    var scaledOriginDifference = scaledObjectPos - scaledRayOrigin;\r\n    var tMax = voxelSize * (rayDirSign * scaledOriginDifference + (rayDirSign * 0.5) + 0.5) / abs(objectRayDirection);\r\n    let mask = vec3<f32>(tMax.xyz <= min(tMax.yzx, tMax.zxy));\r\n\r\n    tCurrent = min(tMax.x, min(tMax.y, tMax.z));\r\n    objectPos = objectRayOrigin + objectRayDirection * tCurrent;\r\n    currentIndex = vec3<i32>(floor(objectPos / voxelSize) * voxelSize);\r\n    objectNormal = mask * -rayDirSign;\r\n\r\n    if(!isInBounds(currentIndex, vec3<i32>(voxelObject.size))){\r\n        break;\r\n    }\r\n  }\r\n  return output;\r\n}\r\n\r\nfn rayMarchTransformed(voxelObject: VoxelObject, rayDirection: vec3<f32>, rayOrigin: vec3<f32>, mipLevel: u32) -> RayMarchResult {\r\n      var objectRayOrigin = (voxelObject.inverseTransform * vec4<f32>(rayOrigin, 1.0)).xyz;\r\n      let objectRayDirection = (voxelObject.inverseTransform * vec4<f32>(rayDirection, 0.0)).xyz;\r\n      return  rayMarchAtMip(voxelObject, objectRayDirection, objectRayOrigin, 0);\r\n}\r\n\r\nconst STACK_LEN: u32 = 64u;\r\nstruct Stack {\r\n  arr: array<i32, STACK_LEN>,\r\n\thead: u32,\r\n}\r\n\r\nfn stack_new() -> Stack {\r\n    var arr: array<i32, STACK_LEN>;\r\n    return Stack(arr, 0u);\r\n}\r\n\r\nfn stack_push(stack: ptr<function, Stack>, val: i32) {\r\n    (*stack).arr[(*stack).head] = val;\r\n    (*stack).head += 1u;\r\n}\r\n\r\nfn stack_pop(stack: ptr<function, Stack>) -> i32 {\r\n    (*stack).head -= 1u;\r\n    return (*stack).arr[(*stack).head];\r\n}\r\n\r\nconst colours = array<vec3<f32>, 6>(\r\n  vec3<f32>(1.0, 0.0, 0.0),\r\n  vec3<f32>(0.0, 1.0, 0.0),\r\n  vec3<f32>(0.0, 0.0, 1.0),\r\n  vec3<f32>(1.0, 1.0, 0.0),\r\n  vec3<f32>(1.0, 0.0, 1.0),\r\n  vec3<f32>(0.0, 1.0, 1.0)\r\n);\r\n\r\nfn debugColourFromIndex(index: i32) -> vec3<f32> {\r\n  return colours[index % 6];\r\n}\r\n\r\nfn getDistanceToLeftNode(rayOrigin: vec3<f32>, rayDirection: vec3<f32>, node: BVHNode) -> f32 {\r\n  var leftDist = -1.0;\r\n  if(all(rayOrigin >= node.leftMin) && all(rayOrigin <= node.leftMax)){\r\n    leftDist = 0.0;\r\n  } else {\r\n    let leftBoxSize = (node.leftMax - node.leftMin) / 2;\r\n    leftDist = boxIntersection(rayOrigin - node.leftMin, rayDirection, leftBoxSize).tNear - EPSILON;\r\n  }\r\n  return leftDist;\r\n}\r\n\r\nfn getDistanceToRightNode(rayOrigin: vec3<f32>, rayDirection: vec3<f32>, node: BVHNode) -> f32 {\r\n  var rightDist = -1.0;\r\n  if(all(rayOrigin >= node.rightMin) && all(rayOrigin <= node.rightMax)){\r\n    rightDist = 0.0;\r\n  } else {\r\n    var rightBoxSize = (node.rightMax - node.rightMin) / 2;\r\n    rightDist = boxIntersection(rayOrigin - node.rightMin, rayDirection, rightBoxSize).tNear;\r\n  }\r\n  return rightDist;\r\n}\r\n\r\nfn getVoxelObjectIndexFromFromRightNode(node: BVHNode) -> i32 {\r\n  if(node.rightObjectCount == 1){\r\n    return node.rightIndex;\r\n  }\r\n  return -1;\r\n}\r\n\r\nfn getVoxelObjectIndexFromFromLeftNode(node: BVHNode) -> i32 {\r\n  if(node.leftObjectCount == 1){\r\n    return node.leftIndex;\r\n  }\r\n  return -1;\r\n}\r\n\n        struct ViewProjectionMatrices {\r\n  viewProjection : mat4x4<f32>,\r\n  previousViewProjection : mat4x4<f32>,\r\n  inverseViewProjection : mat4x4<f32>,\r\n  projection : mat4x4<f32>,\r\n  inverseProjection: mat4x4<f32>\r\n};\r\n\r\n@group(0) @binding(2) var<uniform> viewProjections : ViewProjectionMatrices;\r\n@group(0) @binding(3) var voxels : texture_3d<f32>;\r\n@group(0) @binding(4) var<uniform> voxelObject : VoxelObject;\r\n\r\nconst IDENTITY_MATRIX = mat4x4<f32>(\r\n  vec4<f32>(1.0, 0.0, 0.0, 0.0),\r\n  vec4<f32>(0.0, 1.0, 0.0, 0.0),\r\n  vec4<f32>(0.0, 0.0, 1.0, 0.0),\r\n  vec4<f32>(0.0, 0.0, 0.0, 1.0)\r\n);\r\n\r\n@fragment\r\nfn main(\r\n   @location(0) worldPos : vec3f,\r\n    @location(1) @interpolate(linear) ndc : vec3f\r\n) -> @location(0) vec4f {\r\n    var screenUV = ndc.xy * 0.5 + 0.5;\r\n    var inverseViewProjection = viewProjections.inverseViewProjection;\r\n    let rayDirection = calculateRayDirection(screenUV,inverseViewProjection);\r\n//    var voxelObject: VoxelObject;\r\n//\r\n//    voxelObject.transform = IDENTITY_MATRIX;\r\n//    voxelObject.inverseTransform = IDENTITY_MATRIX;\r\n//    voxelObject.previousTransform = IDENTITY_MATRIX;\r\n//    voxelObject.previousInverseTransform = IDENTITY_MATRIX;\r\n//    voxelObject.size = vec3<f32>(128,128,64);\r\n//    voxelObject.atlasLocation = vec3<f32>(1,0,0);\r\n\r\n    let result = rayMarchAtMip(voxelObject, rayDirection, worldPos, 0);\r\n\r\n//  return clipPos / 1280.0;\r\n//      return vec4(worldPos / voxelObject.size, 1);\r\n//  return vec4(abs(result.normal), 1.0);\r\n  return vec4(f32(result.stepsTaken) * 0.01);\r\n}\n        `}),entryPoint:"main",targets:[{format:"rgba8unorm"}]},primitive:{topology:"triangle-list",cullMode:"back"}});let o,s,a;return{render:({commandEncoder:e,outputTextures:u,transformationMatrixBuffer:c,voxelTextureView:l,viewProjectionMatricesBuffer:f,timestampWrites:h,cameraPositionBuffer:p})=>{const d={colorAttachments:[{view:u.finalTexture.createView(),clearValue:{r:0,g:0,b:0,a:1},loadOp:"clear",storeOp:"store"}],timestampWrites:h},_=[vi.position[0],vi.position[1],vi.position[2]],m=wt.lookAt(_,it.add(_,[vi.direction[0],vi.direction[1],vi.direction[2]]),vi.down);let g=vi.projectionMatrix;const v=wt.mul(g,m),y=wt.identity(),w=wt.mul(v,y);o||(o=ui.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),ui.queue.writeBuffer(o,0,new Float32Array(w)),s||(s=ui.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),ui.queue.writeBuffer(s,0,new Float32Array(y)),a||(a=ui.createBuffer({size:288,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})),ui.queue.writeBuffer(a,0,new Float32Array(ti[0].toArray()));const x=ui.createBindGroup({layout:t,entries:[{binding:0,resource:{buffer:o}},{binding:1,resource:{buffer:s}},{binding:2,resource:{buffer:f}},{binding:3,resource:l},{binding:4,resource:{buffer:a}}]}),b=e.beginRenderPass(d);return b.setVertexBuffer(0,r),b.setBindGroup(0,x),b.setPipeline(i),b.draw(n.length/4),b.end(),[e.finish()]},label:"hello triangle"}},ai=new class{maxObjectCount;objectCount;scale;targetScale;translateX;targetTranslateX;rotateY;targetRotateY;sunRotateY;targetSunRotateY;constructor(){this.maxObjectCount=222,this.objectCount=222,this.scale=1,this.translateX=0,this.targetScale=1,this.targetTranslateX=0,this.rotateY=0,this.targetRotateY=0,this.sunRotateY=2.6,this.targetSunRotateY=2.6}update(){Je((t=>{const e=this.targetScale-this.scale;this.scale=this.scale+e*t}),{easing:rn({velocity:2e-4*_i})}),Je((t=>{const e=this.targetTranslateX-this.translateX;this.translateX=this.translateX+e*t}),{easing:rn({velocity:2e-4*_i})}),Je((t=>{const e=this.targetRotateY-this.rotateY;this.rotateY=this.rotateY+e*t}),{easing:rn({velocity:2e-4*_i})}),Je((t=>{const e=this.targetSunRotateY-this.sunRotateY;this.sunRotateY=this.sunRotateY+e*t}),{easing:rn({velocity:2e-4*_i})})}};let ui,ci,li,fi,hi=z.create(4,4),pi=0,di=pi,_i=0,mi=0;const gi=Math.PI/180*90;let vi=new class extends on{fieldOfView;near=.5;far=1e4;constructor(t){super({position:t.position,rotation:$t.identity()}),this.fieldOfView=t.fieldOfView}get direction(){return it.transformQuat(it.create(0,0,1),this.rotation)}get right(){return it.transformQuat(it.create(1,0,0),this.rotation)}get left(){return it.transformQuat(it.create(-1,0,0),this.rotation)}get up(){return it.transformQuat(it.create(0,1,0),this.rotation)}get down(){return it.transformQuat(it.create(0,-1,0),this.rotation)}get viewMatrix(){const t=this.position;return wt.lookAt(t,it.add(t,this.direction),this.up)}get inverseViewMatrix(){return wt.invert(this.viewMatrix)}get projectionMatrix(){return wt.perspective(this.fieldOfView,hi[0]/hi[1],this.near,this.far)}get inverseProjectionMatrix(){return wt.invert(this.projectionMatrix)}get viewProjectionMatrix(){return wt.mul(this.projectionMatrix,this.viewMatrix)}get inverseViewProjectionMatrix(){return wt.invert(this.viewProjectionMatrix)}}({fieldOfView:gi,position:it.create(-30,30,-70),direction:it.create()});const yi=new class{logElement;isMouseDown=!1;constructor(){document.getElementById("reset").addEventListener("click",(t=>{window.dispatchEvent(new CustomEvent("resetcamera")),document.getElementById("captures").innerHTML=""})),document.getElementById("capture").addEventListener("click",(t=>{const e=new Image;e.id=performance.now().toString(),e.src=li.toDataURL(),document.getElementById("captures").appendChild(e).addEventListener("click",(t=>{t.target,console.log(t.target)}))})),document.addEventListener("wheel",(t=>{vi.fieldOfView+=.001*t.deltaY,vi.fieldOfView=Math.max(Math.min(vi.fieldOfView,2),.1)})),["fov","scale","translate","sun"].forEach((t=>{document.getElementById(t).addEventListener("input",(e=>{const n=e.target;window.dispatchEvent(new CustomEvent(`change${t}`,{detail:n.value}))}))})),this.logElement=document.getElementById("log"),window.addEventListener("changefov",(t=>{vi.fieldOfView=parseFloat(t.detail)})),window.addEventListener("changetranslate",(t=>{ai.targetTranslateX=.01*parseFloat(t.detail)})),window.addEventListener("changesun",(t=>{ai.targetSunRotateY=parseFloat(t.detail)})),window.addEventListener("changescale",(t=>{ai.targetScale=parseFloat(t.detail)})),window.addEventListener("resetcamera",(()=>{ai.targetTranslateX=0,ai.targetScale=1,ai.targetRotateY=0})),document.getElementById("webgpu-canvas").addEventListener("mousedown",(()=>{this.isMouseDown=!0})),document.getElementById("webgpu-canvas").addEventListener("mouseup",(()=>{this.isMouseDown=!1})),document.getElementById("webgpu-canvas").addEventListener("mouseleave",(()=>{this.isMouseDown=!1})),window.addEventListener("mousemove",(t=>{this.isMouseDown&&(ai.targetRotateY-=.005*t.movementX)}))}log(t){this.logElement.innerHTML=t}},wi=(()=>{let t={};const e=e=>{const n=t[e];return n?n.reduce(((t,e)=>t+e))/n.length:0};return{addSample:(e,n)=>{t[e]||(t[e]=[]),t[e].push(n)>100&&t[e].shift()},clearEntry:e=>{t[e]&&(t[e]=[0])},toString:()=>Object.keys(t).map((t=>`${t}: ${e(t).toFixed(2)}ms`)).join("\n"),toHTML:()=>Object.keys(t).map((t=>`<div class="debug-row">\n                    <div>\n                        ${t}\n                    </div>\n                   <div>${e(t).toFixed(2)}ms</div>\n                </div>`)).join("\n")}})();let xi,bi;wi.addSample("frame time",0);(async()=>{if(!navigator.gpu)return void console.error("WebGPU not supported");const n=await navigator.gpu.requestAdapter();if(!ui)try{ui=await n.requestDevice({requiredFeatures:["timestamp-query"]})}catch(t){ui=await n.requestDevice()}console.debug(ui.limits),fi=await(async t=>{let e=null,n={};const r=t.createCommandEncoder();return e=t.createTexture({size:{width:1,height:1,depthOrArrayLayers:1},...Xr,label:"Volume atlas containing ",mipLevelCount:1}),t.queue.submit([r.finish()]),await t.queue.onSubmittedWorkDone(),{getVolumes:()=>n,addVolume:async(r,i)=>{if(n[i])throw new Error(`Error adding volume to atlas: volume with label ${i} already exists`);const{width:o,height:s,depthOrArrayLayers:a}=r;console.debug(`Adding ${i} to atlas`,{width:o,height:s,depthOrArrayLayers:a});const u=e.width+o;if(u>t.limits.maxTextureDimension3D)throw new Error(`Error adding volume to atlas: adding volume would exceed device max texture dimension of ${t.limits.maxTextureDimension3D}`);const c=e,l=Math.max(e.height,s),f=Math.max(e.depthOrArrayLayers,a),h=Math.max(r.mipLevelCount,e.mipLevelCount);console.debug(`Expanding atlas texture to [${u}, ${l}, ${f}], mip levels: ${h}`);const p=t.createTexture({size:{width:u,height:l,depthOrArrayLayers:f},mipLevelCount:h,...Xr,label:`${e.label}, ${r.label||"unnamed volume"}`}),d=t.createCommandEncoder();d.copyTextureToTexture({texture:e},{texture:p},{width:e.width,height:e.height,depthOrArrayLayers:e.depthOrArrayLayers}),d.copyTextureToTexture({texture:r},{texture:p,origin:{x:p.width-o,y:0,z:0}},{width:o,height:s,depthOrArrayLayers:a}),t.queue.submit([d.finish()]),await t.queue.onSubmittedWorkDone(),e=p,c.destroy(),e=await Wr(t,e),n[i]={location:[p.width-o,0,0],size:[o,s,a]}},getVolume:t=>n[t],removeVolume:async r=>{if(!n[r])throw new Error(`Error removing volume from atlas: volume with label ${r} does not exist`);if(!e)throw new Error("Error removing from atlas: No atlas texture to remove volume from");const{location:i,size:o}=n[r],s=it.add(i,o),a=it.subtract(s,i);if(a[0]>e.width||a[1]>e.height||a[2]>e.depthOrArrayLayers)throw new Error(`Error removing from atlas: volume to remove (${a}) is larger than atlas texture (${e.width}, ${e.height}, ${e.depthOrArrayLayers})`);const u=t.createCommandEncoder(),c=u.beginComputePass(),l=t.createComputePipeline({layout:"auto",compute:{module:t.createShaderModule({code:"\n                @group(0) @binding(0) var texture : texture_storage_3d<rgba8unorm, write>;\n                override startX: u32 = 0;\n                override startY: u32 = 0;\n                override startZ: u32 = 0;\n                @compute @workgroup_size(1, 1, 1)\n                fn main(\n                  @builtin(global_invocation_id) GlobalInvocationID : vec3<u32>\n                ) {\n                  textureStore(texture, GlobalInvocationID + vec3(startX, startY, startZ), vec4(0.0));\n                }\n            "}),entryPoint:"main",constants:{startX:i[0],startY:i[1],startZ:i[2]}}});c.setPipeline(l),c.setBindGroup(0,t.createBindGroup({layout:l.getBindGroupLayout(0),entries:[{binding:0,resource:e.createView()}]})),c.dispatchWorkgroups(a[0],a[1],a[2]),c.end(),t.queue.submit([u.finish()]),await t.queue.onSubmittedWorkDone()},getAtlasTextureView:()=>{if(!e)return null;const t=e.createView();return t.label=e.label,t}}})(ui),await(async(t,e)=>{const n=await fetch("./Tavern.json"),r=(await n.json()).children.filter((t=>ei.includes(t.name))),i=new Set(r.map((t=>t.name))),o=Array.from(i);for(const n of o){console.time(`Loaded ${n} in`);const r=await fetch(`./${n}.vxm`),i=await r.arrayBuffer(),o=Qr(i);console.log({voxels:o,kb:i.byteLength/1e3});let s=await Jr(t,o);s=await Wr(t,s),await e.addVolume(s,n),s.destroy(),console.timeEnd(`Loaded ${n} in`)}const s=e.getVolumes();console.log({volumes:s});for(const t of r){const e=s[t.name];if(console.log({volumes:s,volume:e,child:t}),!e)return void console.warn(`Volume not found for child ${t.name}, skipping...`);const n=wt.identity();wt.translate(n,t.position,n),wt.scale(n,t.scale,n),wt.multiply(n,wt.fromQuat(t.rotation),n),ti.push(new Zr(n,e.size,e.location,t.name))}console.debug(`Tavern created with ${ti.length} items`)})(ui,fi);const r=[si(),an(ui)],s=await Promise.all(r);((n,r)=>{let s,a,u,c,l,f,h,p,d,_,m,g,v,y=wt.create(),w=wt.create();li=document.getElementById("webgpu-canvas"),li.style.imageRendering="pixelated",ci=li.getContext("webgpu"),ci.configure({device:n,format:navigator.gpu.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT}),n.features.has("timestamp-query")&&(g=n.createQuerySet({type:"timestamp",count:2*r.length}),v=n.createBuffer({size:8*g.count,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST}));const x=new ii(ti);console.log(x);const b=x.nodes.length;let k=x.toGPUBuffer(n,b);const A=()=>{c&&(c=null),s&&(s=null),a&&(a=null),l&&(l=null),u&&(u=null);const{clientWidth:t,clientHeight:e}=li.parentElement,n=z.create(1*t,1*e);hi=z.mulScalar(n,1),li.width=n[0],li.height=n[1],li.style.transform="scale(1)"};(async()=>{f||(f=await async function(t,e,n={}){return Yr(t,[e],n)}(n,"blue-noise-rg.png",{usage:GPUTextureUsage.COPY_SRC}))})(),setInterval((()=>{yi.log(wi.toHTML())}),500);const M=x=>{0===pi&&(pi=x);const b=x-pi;if(_i=b-di,wi.addSample("frame time",_i),di=b,mi++,(()=>{const t=[...vi.viewProjectionMatrix,...w,...vi.inverseViewProjectionMatrix,...y,...vi.projectionMatrix,...vi.inverseProjectionMatrix];_?i(_,t):_=o(n,t)})(),(()=>{const t=ti;document.getElementById("objectcount").innerHTML=`Objects: ${t.length} / ${ti.length} in view`;const e=t.flatMap((t=>t.toArray()));d?i(d,e):(d=o(n,e,"voxel object"),d=n.createBuffer({size:new Float32Array(e).byteLength,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!1}))})(),!d||!f)return void(bi=requestAnimationFrame(M));(()=>{const t=.2*_i;let e=it.zero();sn.pressed.a&&(e=it.add(e,vi.left)),sn.pressed.d&&(e=it.add(e,vi.right)),sn.pressed.w&&(e=it.add(e,vi.direction)),sn.pressed.s&&(e=it.subtract(e,vi.direction)),sn.pressed.e&&(vi.targetRotation=$t.rotateY(vi.targetRotation,.05)),sn.pressed.q&&(vi.targetRotation=$t.rotateY(vi.targetRotation,-.05)),sn.pressed[" "]&&(e=it.add(e,vi.up)),sn.pressed.shift&&(e=it.add(e,vi.down)),e=it.normalize(e),vi.targetPosition=it.add(vi.targetPosition,it.mulScalar(e,t))})(),vi.update(),ai.update();const A=wt.getTranslation(vi.inverseViewMatrix);document.getElementById("resolution").innerHTML=hi.join(" x "),h?t(h,[mi,0]):h=e([mi,0]),n.queue.writeBuffer(h,4,new Float32Array([_i])),p?t(p,[hi[0],hi[1]]):p=e([hi[0],hi[1]]),(()=>{const t=wt.identity();wt.rotateY(t,ai.sunRotateY,t);const n=it.transformMat4(it.create(0,-1,-1),t);m?i(m,[n[0],n[1],n[2]]):m=e([n[0],n[1],n[2]])})();const T=o(n,A,"camera position");a||(a=n.createTexture({size:[hi[0],hi[1],1],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.COPY_SRC})),s||(s=n.createTexture({size:[hi[0],hi[1],1],format:"rgba8snorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING})),c||(c=n.createTexture({size:[hi[0],hi[1],1],format:"rgba32float",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.STORAGE_BINDING})),l||(l=n.createTexture({size:[hi[0],hi[1],1],format:"rgba32float",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.STORAGE_BINDING})),u||(u=n.createTexture({size:[hi[0],hi[1],1],format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_SRC|GPUTextureUsage.COPY_DST|GPUTextureUsage.STORAGE_BINDING|GPUTextureUsage.RENDER_ATTACHMENT}));let S=[];xi=fi.getAtlasTextureView(),xi?(r.forEach(((t,e)=>{const{render:r,label:i}=t;if(!1===document.getElementById(`flag-${i}`)?.checked)return;const o=n.createCommandEncoder();let y;n.features.has("timestamp-query")&&o.clearBuffer(v),n.features.has("timestamp-query")&&(y={querySet:g,beginningOfPassWriteIndex:2*e,endOfPassWriteIndex:2*e+1}),r({commandEncoder:o,resolutionBuffer:p,timeBuffer:h,outputTextures:{finalTexture:u,albedoTexture:a,normalTexture:s,depthAndClusterTexture:c,skyTexture:void 0,velocityTexture:l},cameraPositionBuffer:T,voxelTextureView:xi,transformationMatrixBuffer:d,viewProjectionMatricesBuffer:_,timestampWrites:y,sunDirectionBuffer:m,blueNoiseTexture:f,bvhBuffer:k}).forEach((t=>{S.push(t)}))})),n.features.has("timestamp-query")&&(t=>{const e=n.createCommandEncoder();e.resolveQuerySet(g,0,g.count,v,0),t.push(e.finish());const i=v.size,o=n.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),s=n.createCommandEncoder();s.copyBufferToBuffer(v,0,o,0,i);const a=s.finish();n.queue.submit([a]),o.mapAsync(GPUMapMode.READ).then((()=>o.getMappedRange())).then((t=>{const e=new BigInt64Array(t),n=[];e.forEach((t=>{n.push(Number(t)/1e6)}));const i=n.reduce(((t,e,r)=>(r%2==0&&t.push(n[r+1]-e),t)),[]);(0,Hr.forEach)(i,((t,e)=>{const n=r[e].label,i=`flag-${n}`,o=document.getElementById(i)?.checked;n&&o?wi.addSample(n,t):wi.clearEntry(n)}))}))})(S),n.queue.submit(S),bi=requestAnimationFrame(M),y=vi.inverseViewProjectionMatrix,w=vi.viewProjectionMatrix):bi=requestAnimationFrame(M)};A(),window.onresize=A,bi=requestAnimationFrame(M)})(ui,await Promise.all(s)),document.getElementById("flags").innerHTML=s.reduce(((t,e)=>{if(!e.label)return t;const n=`flag-${e.label}`;return`${t}<div class="debug-row">\n                    <label for="${n}">\n                        ${e.label}\n                    </label>\n                    <div>\n                        <input id="${n}" type="checkbox" checked>\n                   </div>\n                </div>`}),"")})()})()})();