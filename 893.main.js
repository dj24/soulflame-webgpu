(()=>{var e,t,r={668:(e,t,r)=>{"use strict";const o=e=>[1&e?1:0,2&e?1:0,4&e?1:0];class i{nodes;#e;#t;#r;constructor(e,t,r){this.nodes=[],this.#e=0,this.#t=e,this.#r=t,this.#o(r,0,[0,0,0])}#i(e=8){return this.#e+=e,this.#e-(e-1)}#o(e,t,r){if(e<=this.#r(r[0],r[1],r[2])){const o=r.map((t=>Math.floor(t+e/2))),i=this.#t(o[0],o[1],o[2]);if(!i){for(let o=r[0];o<r[0]+e;o++)for(let i=r[1];i<r[1]+e;i++)for(let n=r[2];n<r[2]+e;n++){const s=this.#t(o,i,n);if(s)return void(this.nodes[t]={red:s.red,green:s.green,blue:s.blue,x:r[0],y:r[1],z:r[2],size:e})}return}const{red:n,green:s,blue:l}=i;return void(this.nodes[t]={red:n,green:s,blue:l,x:r[0],y:r[1],z:r[2],size:e})}const i=Array.from({length:8},(()=>0)),n=(s=e,Math.pow(2,Math.ceil(Math.log2(s))));var s;const l=n/2;for(let e=0;e<8;e++){const t=o(e),n=r[0]+t[0]*l,s=r[1]+t[1]*l,c=r[2]+t[2]*l;for(let t=n;t<n+l;t++)for(let r=s;r<s+l;r++)for(let o=c;o<c+l;o++)this.#t(t,r,o)&&i[e]++}let c=0;const a=i.reduce(((e,t,r)=>t>0?(c=r+1,e|1<<r):e),0);if(i.reduce(((e,t)=>e+t),0)===n**3){const o=r.map((e=>e+n/2)),{red:i,green:s,blue:l}=this.#t(o[0],o[1],o[2]);return void(this.nodes[t]={red:i,green:s,blue:l,x:r[0],y:r[1],z:r[2],size:e})}const h=this.#i(c),d=h-t;i.forEach(((e,t)=>{if(e){const e=h+t,i=o(t),n=r[0]+i[0]*l,s=r[1]+i[1]*l,c=r[2]+i[2]*l;this.#o(l,e,[n,s,c])}})),this.nodes[t]={firstChildIndex:d,childMask:a,x:r[0],y:r[1],z:r[2],size:n,leafMask:0}}refineNode(e){const t=this.nodes[e];"red"in t||this.#o(t.size,e,[t.x,t.y,t.z])}get totalSize(){return 8*this.nodes.length}}var n=r(590),s=r(391),l=r.n(s),c=r(627);const a=l()("crystals"),h=(0,c.Cf)(a),d=(e,t)=>t[0]+t[1]*e[0]+t[2]*(e[0]*e[1]);class f{cache;size;constructor(e,t){const r=performance.now();this.size=t,this.cache=new Int16Array(t[0]*t[1]*t[2]);for(let r=0;r<t[0];r++)for(let i=0;i<t[1];i++)for(let n=0;n<t[2];n++){const s=d(t,[r,i,n]);this.cache[s]=(o=e(r,i,n),Math.floor(32767*o))}var o;console.debug("Noise cache",t,"created in",(performance.now()-r).toFixed(0),"ms","size",this.totalSizeBytes/1048576,"MB")}get totalSizeBytes(){return this.cache.byteLength}get([e,t,r]){const o=d(this.size,[e,t,r]);return this.cache[o]/32767}}let u,p;const g={createOctreeAndReturnBytes:(e,t)=>(p=new f(((t,r,o)=>((e,t,r,o=1,i=3,n=.5)=>{let s=0,l=0,c=1;for(let a=0;a<i;a++){const i=1<<a;l+=h(e*i*o,t*i*o,r*i*o)*c,s+=c,c*=n}return l/s})(t+e[0],r+e[1],o+e[2],.001,5)),t),u=new i(((e,t,r)=>((e,t,r)=>{const o=t/128,i=function(e){return e<.5?4*e*e*e:1-Math.pow(-2*e+2,3)/2}((p.get([e,t,r])+1)/2),n=a();return i>o?t>96?{red:255-128*n,green:0,blue:0}:t>70.4?{red:255-128*n,green:255-128*n,blue:0}:t>32?{red:0,green:255-128*n,blue:0}:{red:0,green:0,blue:255-128*n}:null})(e,t,r)),((e,t,r)=>1),Math.max(...t)),p=void 0,u.totalSize+8),populateOctreeBuffer:e=>{const t=new DataView(e);u.nodes.forEach(((e,r)=>{"red"in e?((e,t,r)=>{e.setUint8(8*t,0),e.setUint8(8*t+1,r.x),e.setUint8(8*t+2,r.y),e.setUint8(8*t+3,r.z),e.setUint8(8*t+4,r.red),e.setUint8(8*t+5,r.green),e.setUint8(8*t+6,r.blue),e.setUint8(8*t+7,Math.log2(r.size))})(t,r,e):((e,t,r)=>{console.assert(r.firstChildIndex<2**24-1,`First child index of ${r.firstChildIndex} is too large to fit in 3 bytes`),console.assert(r.x<256,`X position of ${r.x} is too large to fit in 1 byte`),console.assert(r.y<256,`Y position of ${r.y} is too large to fit in 1 byte`),console.assert(r.z<256,`Z position of ${r.z} is too large to fit in 1 byte`),e.setUint8(8*t,r.childMask),e.setUint8(8*t+1,r.x),e.setUint8(8*t+2,r.y),e.setUint8(8*t+3,r.z),e.setUint32(8*t+4,r.firstChildIndex,!0),e.setUint8(8*t+7,Math.log2(r.size))})(t,r,e)})),u=void 0}};(0,n.p)(g)},234:()=>{}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,i),n.loaded=!0,n.exports}i.m=r,i.x=()=>{var e=i.O(void 0,[974],(()=>i(668)));return i.O(e)},i.amdD=function(){throw new Error("define cannot be used indirect")},i.amdO={},e=[],i.O=(t,r,o,n)=>{if(!r){var s=1/0;for(h=0;h<e.length;h++){for(var[r,o,n]=e[h],l=!0,c=0;c<r.length;c++)(!1&n||s>=n)&&Object.keys(i.O).every((e=>i.O[e](r[c])))?r.splice(c--,1):(l=!1,n<s&&(s=n));if(l){e.splice(h--,1);var a=o();void 0!==a&&(t=a)}}return t}n=n||0;for(var h=e.length;h>0&&e[h-1][2]>n;h--)e[h]=e[h-1];e[h]=[r,o,n]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>e+".main.js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={893:1};i.f.i=(t,r)=>{e[t]||importScripts(i.p+i.u(t))};var t=self.webpackChunksoulflame_webgpu=self.webpackChunksoulflame_webgpu||[],r=t.push.bind(t);t.push=t=>{var[o,n,s]=t;for(var l in n)i.o(n,l)&&(i.m[l]=n[l]);for(s&&s(i);o.length;)e[o.pop()]=1;r(t)}})(),t=i.x,i.x=()=>i.e(974).then(t),i.x()})();